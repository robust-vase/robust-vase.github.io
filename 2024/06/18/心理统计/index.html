<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>心理统计 | 花瓶的博客</title><meta name="author" content="花瓶"><meta name="copyright" content="花瓶"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言 虽然这门课叫做心理统计，但是统计的内容几乎不涵盖任何数学公式以及相应的公式推导证明，即使刘红云老师是数学科班出身…据她说，她也是在心理学部摸爬滚打摸索出一条不讲任何数学公式的统计课，适合心理学部宝宝的体质。 多元回归分析 导入包与数据 1234567891011121314151617# 导入包library(haven)library(car)library(olsrr)library(p">
<meta property="og:type" content="article">
<meta property="og:title" content="心理统计">
<meta property="og:url" content="http://example.com/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/index.html">
<meta property="og:site_name" content="花瓶的博客">
<meta property="og:description" content="前言 虽然这门课叫做心理统计，但是统计的内容几乎不涵盖任何数学公式以及相应的公式推导证明，即使刘红云老师是数学科班出身…据她说，她也是在心理学部摸爬滚打摸索出一条不讲任何数学公式的统计课，适合心理学部宝宝的体质。 多元回归分析 导入包与数据 1234567891011121314151617# 导入包library(haven)library(car)library(olsrr)library(p">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/Starry_Night.jpg">
<meta property="article:published_time" content="2024-06-18T01:05:58.000Z">
<meta property="article:modified_time" content="2024-06-18T01:47:43.379Z">
<meta property="article:author" content="花瓶">
<meta property="article:tag" content="R">
<meta property="article:tag" content="心理学">
<meta property="article:tag" content="多元统计分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/Starry_Night.jpg"><link rel="shortcut icon" href="/img/kele.png"><link rel="canonical" href="http://example.com/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":1500,"position":"top","messagePrev":"这篇文章已经有","messageNext":"未更新，花瓶里没有保鲜剂"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":250},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '心理统计',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-18 09:47:43'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/icon.css"><link rel="stylesheet" href="/css/custom.css"><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async data-pjax src="/js/map.js"></script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

document.addEventListener('pjax:send', () => {
  Pace.restart()
})
</script><link rel="stylesheet" href="/css/pace.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/img/John_King.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouye"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-wenzhang"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijian"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei"></i><span> 分类</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw iconfont icon-tongji"></i><span> 统计</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-shejiao"></i><span> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/daily/"><i class="fa-fw iconfont icon-xiaoxi"></i><span> 日常说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/knowme/"><i class="fa-fw iconfont icon-mingpian"></i><span> 认识花瓶</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyanban"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/Starry_Night.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="花瓶的博客"><span class="site-name">花瓶的博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouye"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-wenzhang"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijian"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei"></i><span> 分类</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw iconfont icon-tongji"></i><span> 统计</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-shejiao"></i><span> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/daily/"><i class="fa-fw iconfont icon-xiaoxi"></i><span> 日常说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/knowme/"><i class="fa-fw iconfont icon-mingpian"></i><span> 认识花瓶</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyanban"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">心理统计</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-06-18T01:05:58.000Z" title="发表于 2024-06-18 09:05:58">2024-06-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-06-18T01:47:43.379Z" title="更新于 2024-06-18 09:47:43">2024-06-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BB%9F%E8%AE%A1/">统计</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">29.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>155分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="心理统计"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>前言</h1>
<p>虽然这门课叫做心理统计，但是统计的内容几乎不涵盖任何数学公式以及相应的公式推导证明，即使刘红云老师是数学科班出身…据她说，她也是在心理学部摸爬滚打摸索出一条不讲任何数学公式的统计课，适合心理学部宝宝的体质。</p>
<h1>多元回归分析</h1>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>car<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>olsrr<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>broom<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ppcor<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lm.beta<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/多元回归个人作业数据文件/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./3_1.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="标准多元回归">标准多元回归</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进行多元回归分析</span></span><br><span class="line">model <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>timedrs <span class="operator">~</span> phyheal <span class="operator">+</span> menheal <span class="operator">+</span> stress<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型摘要</span></span><br><span class="line">summary<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>模型拟合情况</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Residual standard error<span class="operator">:</span> <span class="number">10.13</span> on <span class="number">356</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.211</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.2044</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">31.74</span> on <span class="number">3</span> and <span class="number">356</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br></pre></td></tr></table></figure>
<p>三个自变量总共可以解释因变量变异的21.1%</p>
<p>标准化回归系数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标准化回归系数</span></span><br><span class="line">lm.beta<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Standardized Coefficients<span class="operator">::</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>     phyheal     menheal      stress </span><br><span class="line">         <span class="literal">NA</span> <span class="number">0.359931424</span> <span class="number">0.008328805</span> <span class="number">0.193065466</span> </span><br></pre></td></tr></table></figure>
<p><strong>方差分析</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方差分析</span></span><br><span class="line">anova<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Response<span class="operator">:</span> timedrs</span><br><span class="line">           Df Sum Sq Mean Sq <span class="built_in">F</span> value    Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">phyheal     <span class="number">1</span>   <span class="number">8154</span>  <span class="number">8154.1</span> <span class="number">79.4912</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">menheal     <span class="number">1</span>    <span class="number">110</span>   <span class="number">110.5</span>  <span class="number">1.0769</span> <span class="number">0.3000946</span>    </span><br><span class="line">stress      <span class="number">1</span>   <span class="number">1502</span>  <span class="number">1501.7</span> <span class="number">14.6391</span> <span class="number">0.0001537</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals <span class="number">356</span>  <span class="number">36518</span>   <span class="number">102.6</span>   </span><br></pre></td></tr></table></figure>
<h3 id="多重共线性">多重共线性</h3>
<p><strong>多重共线性指标</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 多重共线性指标</span></span><br><span class="line"><span class="comment"># 计算 VIF</span></span><br><span class="line">vif<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算 TOL（容忍度）</span></span><br><span class="line"><span class="number">1</span><span class="operator">/</span>vif<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算条件指数</span></span><br><span class="line"><span class="comment"># ols_eigen_cindex(model)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行标准化自变量的多元回归分析</span></span><br><span class="line">model_std <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>timedrs <span class="operator">~</span> scale<span class="punctuation">(</span>phyheal<span class="punctuation">)</span> <span class="operator">+</span> scale<span class="punctuation">(</span>menheal<span class="punctuation">)</span> <span class="operator">+</span> scale<span class="punctuation">(</span>stress<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">ols_eigen_cindex<span class="punctuation">(</span>model_std<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> vif<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br><span class="line"> phyheal  menheal   stress </span><br><span class="line"><span class="number">1.361953</span> <span class="number">1.402107</span> <span class="number">1.148871</span> </span><br><span class="line"><span class="operator">&gt;</span> <span class="number">1</span><span class="operator">/</span>vif<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br><span class="line">  phyheal   menheal    stress </span><br><span class="line"><span class="number">0.7342395</span> <span class="number">0.7132121</span> <span class="number">0.8704199</span> </span><br><span class="line"><span class="operator">&gt;</span> ols_eigen_cindex<span class="punctuation">(</span>model_std<span class="punctuation">)</span></span><br><span class="line">  Eigenvalue Condition Index intercept scale<span class="punctuation">(</span>phyheal<span class="punctuation">)</span> scale<span class="punctuation">(</span>menheal<span class="punctuation">)</span> scale<span class="punctuation">(</span>stress<span class="punctuation">)</span></span><br><span class="line"><span class="number">1</span>  <span class="number">1.7531868</span>        <span class="number">1.000000</span>         <span class="number">0</span>      <span class="number">0.1521228</span>     <span class="number">0.15623913</span>    <span class="number">0.12546381</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1.0000000</span>        <span class="number">1.324080</span>         <span class="number">1</span>      <span class="number">0.0000000</span>     <span class="number">0.00000000</span>    <span class="number">0.00000000</span></span><br><span class="line"><span class="number">3</span>  <span class="number">0.7483957</span>        <span class="number">1.530553</span>         <span class="number">0</span>      <span class="number">0.1797878</span>     <span class="number">0.07500899</span>    <span class="number">0.85837173</span></span><br><span class="line"><span class="number">4</span>  <span class="number">0.4984175</span>        <span class="number">1.875502</span>         <span class="number">0</span>      <span class="number">0.6680894</span>     <span class="number">0.76875189</span>    <span class="number">0.01616446</span></span><br></pre></td></tr></table></figure>
<p>容忍度<code>TOL</code>大于0.1，且方差膨胀因子<code>VIF</code>小于10，并且条件指数<code>CI</code>为1.875502，三个变量不存在明显的多重共线性问题</p>
<h3 id="残差分析">残差分析</h3>
<p><strong>残差统计量</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 残差统计量</span></span><br><span class="line">describe<span class="punctuation">(</span>fitted<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">describe<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">describe<span class="punctuation">(</span>scale<span class="punctuation">(</span>fitted<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">describe<span class="punctuation">(</span>scale<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>根据<code>3SD原则</code>，标准化残差的绝对值大雨3对应的观测值为异常值。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> describe<span class="punctuation">(</span>fitted<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">   vars   n mean   sd median trimmed  mad   <span class="built_in">min</span>   <span class="built_in">max</span> <span class="built_in">range</span> skew kurtosis   se</span><br><span class="line">X1    <span class="number">1</span> <span class="number">360</span> <span class="number">8.04</span> <span class="number">5.22</span>   <span class="number">7.37</span>    <span class="number">7.58</span> <span class="number">4.69</span> <span class="operator">-</span><span class="number">0.65</span> <span class="number">26.98</span> <span class="number">27.63</span> <span class="number">0.94</span>     <span class="number">1.03</span> <span class="number">0.27</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 残差统计量</span></span><br><span class="line"><span class="operator">&gt;</span> describe<span class="punctuation">(</span>fitted<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">   vars   n mean   sd median trimmed  mad   <span class="built_in">min</span>   <span class="built_in">max</span> <span class="built_in">range</span> skew kurtosis   se</span><br><span class="line">X1    <span class="number">1</span> <span class="number">360</span> <span class="number">8.04</span> <span class="number">5.22</span>   <span class="number">7.37</span>    <span class="number">7.58</span> <span class="number">4.69</span> <span class="operator">-</span><span class="number">0.65</span> <span class="number">26.98</span> <span class="number">27.63</span> <span class="number">0.94</span>     <span class="number">1.03</span> <span class="number">0.27</span></span><br><span class="line"><span class="operator">&gt;</span> describe<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">   vars   n mean    sd median trimmed  mad    <span class="built_in">min</span>   <span class="built_in">max</span> <span class="built_in">range</span> skew kurtosis   se</span><br><span class="line">X1    <span class="number">1</span> <span class="number">360</span>    <span class="number">0</span> <span class="number">10.09</span>  <span class="operator">-</span><span class="number">2.02</span>   <span class="operator">-</span><span class="number">1.72</span> <span class="number">4.03</span> <span class="operator">-</span><span class="number">15.87</span> <span class="number">64.22</span> <span class="number">80.09</span> <span class="number">3.27</span>    <span class="number">13.56</span> <span class="number">0.53</span></span><br><span class="line"><span class="operator">&gt;</span> describe<span class="punctuation">(</span>scale<span class="punctuation">(</span>fitted<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">   vars   n mean sd median trimmed mad   <span class="built_in">min</span>  <span class="built_in">max</span> <span class="built_in">range</span> skew kurtosis   se</span><br><span class="line">X1    <span class="number">1</span> <span class="number">360</span>    <span class="number">0</span>  <span class="number">1</span>  <span class="operator">-</span><span class="number">0.13</span>   <span class="operator">-</span><span class="number">0.09</span> <span class="number">0.9</span> <span class="operator">-</span><span class="number">1.67</span> <span class="number">3.63</span>   <span class="number">5.3</span> <span class="number">0.94</span>     <span class="number">1.03</span> <span class="number">0.05</span></span><br><span class="line"><span class="operator">&gt;</span> describe<span class="punctuation">(</span>scale<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">   vars   n mean sd median trimmed mad   <span class="built_in">min</span>  <span class="built_in">max</span> <span class="built_in">range</span> skew kurtosis   se</span><br><span class="line">X1    <span class="number">1</span> <span class="number">360</span>    <span class="number">0</span>  <span class="number">1</span>   <span class="operator">-</span><span class="number">0.2</span>   <span class="operator">-</span><span class="number">0.17</span> <span class="number">0.4</span> <span class="operator">-</span><span class="number">1.57</span> <span class="number">6.37</span>  <span class="number">7.94</span> <span class="number">3.27</span>    <span class="number">13.56</span> <span class="number">0.05</span></span><br></pre></td></tr></table></figure>
<p>本数据集中存在异常值</p>
<p><strong>Durbin-Watson 检验</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进行 Durbin-Watson 检验</span></span><br><span class="line">durbinWatsonTest<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> durbinWatsonTest<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br><span class="line"> lag Autocorrelation D<span class="operator">-</span>W Statistic p<span class="operator">-</span>value</span><br><span class="line">   <span class="number">1</span>       <span class="number">0.7842281</span>     <span class="number">0.3184074</span>       <span class="number">0</span></span><br><span class="line"> Alternative hypothesis<span class="operator">:</span> rho <span class="operator">!=</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>Durbin-Watson 检验结果为0.3184074，认为残差可能存在正相关</p>
<p><strong>P-P 图  残差累计概率图的散点图</strong></p>
<p>残差的正态性假设指的是每个因变量的预测分数下的残差都呈正态分布。若在P-P图三所有标准化残差都分布在对角线上，则可认为没有违背正态性假设。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># P-P 图  残差累计概率图的散点图</span></span><br><span class="line">pp_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  <span class="comment"># 计算正态分布的累计概率</span></span><br><span class="line">  Observed <span class="operator">=</span> sort<span class="punctuation">(</span>pnorm<span class="punctuation">(</span>scale<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment"># 生成理论上的正态分布的累计概率</span></span><br><span class="line">  Theoretical <span class="operator">=</span> sort<span class="punctuation">(</span>ppoints<span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>scale<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制 P-P 图</span></span><br><span class="line">pp_plot <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>pp_data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Theoretical<span class="punctuation">,</span> y <span class="operator">=</span> Observed<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_abline<span class="punctuation">(</span>intercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> slope <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span></span><br><span class="line">    title <span class="operator">=</span> <span class="string">&quot;P-P Plot of Residuals&quot;</span><span class="punctuation">,</span></span><br><span class="line">    x <span class="operator">=</span> <span class="string">&quot;Theoretical Quantiles&quot;</span><span class="punctuation">,</span></span><br><span class="line">    y <span class="operator">=</span> <span class="string">&quot;Observed Quantiles&quot;</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    panel.border <span class="operator">=</span> element_rect<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>pp_plot<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611182936335.png" alt="残差累计概率图的散点图"></p>
<p>残差值的点基本上没有分布中对角线上，判定残差不服从正态分布</p>
<p><strong>标准化因变量预测值与标准化残差的散点图</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标准化因变量预测值与标准化残差的散点图</span></span><br><span class="line">scatter_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  Fitted <span class="operator">=</span> scale<span class="punctuation">(</span>fitted<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  Std_Residuals <span class="operator">=</span> scale<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制散点图</span></span><br><span class="line">scatter_plot <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>scatter_data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Fitted<span class="punctuation">,</span> y <span class="operator">=</span> Std_Residuals<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span></span><br><span class="line">    title <span class="operator">=</span> <span class="string">&quot;Scatter Plot of Fitted Values and Standardized Residuals&quot;</span><span class="punctuation">,</span></span><br><span class="line">    x <span class="operator">=</span> <span class="string">&quot;Standardized Fitted Values&quot;</span><span class="punctuation">,</span></span><br><span class="line">    y <span class="operator">=</span> <span class="string">&quot;Standardized Residuals&quot;</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    panel.border <span class="operator">=</span> element_rect<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出散点图</span></span><br><span class="line">print<span class="punctuation">(</span>scatter_plot<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611193144416.png" alt="因变量预测值与标准化残差的散点图"></p>
<p>图中各点没有随机分布在一条穿过零点的水平直线的两侧，表明残差的分布不满足正态及残差方差齐次性假设</p>
<h2 id="因变量对数转换的多元回归分析">因变量对数转换的多元回归分析</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进行因变量对数转换的多元回归分析</span></span><br><span class="line">model_log <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>logtimedrs <span class="operator">~</span> phyheal <span class="operator">+</span> menheal <span class="operator">+</span> stress<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">summary<span class="punctuation">(</span>model_log<span class="punctuation">)</span></span><br><span class="line">lm.beta<span class="punctuation">(</span>model_log<span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>model_log<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.7752</span> on <span class="number">356</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.3471</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.3416</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">63.08</span> on <span class="number">3</span> and <span class="number">356</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line">Standardized Coefficients<span class="operator">::</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>     phyheal     menheal      stress </span><br><span class="line">         <span class="literal">NA</span>  <span class="number">0.49088568</span>  <span class="number">0.03005799</span>  <span class="number">0.18537313</span> </span><br><span class="line"></span><br><span class="line">Response<span class="operator">:</span> logtimedrs</span><br><span class="line">           Df  Sum Sq Mean Sq  <span class="built_in">F</span> value    Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">phyheal     <span class="number">1</span> <span class="number">102.505</span> <span class="number">102.505</span> <span class="number">170.5668</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">menheal     <span class="number">1</span>   <span class="number">1.429</span>   <span class="number">1.429</span>   <span class="number">2.3773</span>     <span class="number">0.124</span>    </span><br><span class="line">stress      <span class="number">1</span>   <span class="number">9.801</span>   <span class="number">9.801</span>  <span class="number">16.3087</span> <span class="number">6.594e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals <span class="number">356</span> <span class="number">213.945</span>   <span class="number">0.601</span>   </span><br></pre></td></tr></table></figure>
<p>可见因变量对数转换后的回归方程R<sup>2</sup>有所升高，回归方程更加显著</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制 P-P 图</span></span><br><span class="line">pp_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  <span class="comment"># 计算正态分布的累计概率</span></span><br><span class="line">  Observed <span class="operator">=</span> sort<span class="punctuation">(</span>pnorm<span class="punctuation">(</span>scale<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model_log<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment"># 生成理论上的正态分布的累计概率</span></span><br><span class="line">  Theoretical <span class="operator">=</span> sort<span class="punctuation">(</span>ppoints<span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>scale<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model_log<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">pp_plot <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>pp_data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Theoretical<span class="punctuation">,</span> y <span class="operator">=</span> Observed<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_abline<span class="punctuation">(</span>intercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> slope <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span></span><br><span class="line">    title <span class="operator">=</span> <span class="string">&quot;P-P Plot of Residuals&quot;</span><span class="punctuation">,</span></span><br><span class="line">    x <span class="operator">=</span> <span class="string">&quot;Theoretical Quantiles&quot;</span><span class="punctuation">,</span></span><br><span class="line">    y <span class="operator">=</span> <span class="string">&quot;Observed Quantiles&quot;</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    panel.border <span class="operator">=</span> element_rect<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>pp_plot<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 因变量预测值与标准化残差的散点图</span></span><br><span class="line">scatter_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  Fitted <span class="operator">=</span> scale<span class="punctuation">(</span>fitted<span class="punctuation">(</span>model_log<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  Std_Residuals <span class="operator">=</span> scale<span class="punctuation">(</span>residuals<span class="punctuation">(</span>model_log<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">scatter_plot <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>scatter_data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Fitted<span class="punctuation">,</span> y <span class="operator">=</span> Std_Residuals<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span></span><br><span class="line">    title <span class="operator">=</span> <span class="string">&quot;Scatter Plot of Fitted Values and Standardized Residuals&quot;</span><span class="punctuation">,</span></span><br><span class="line">    x <span class="operator">=</span> <span class="string">&quot;Standardized Fitted Values&quot;</span><span class="punctuation">,</span></span><br><span class="line">    y <span class="operator">=</span> <span class="string">&quot;Standardized Residuals&quot;</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    panel.border <span class="operator">=</span> element_rect<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">print<span class="punctuation">(</span>scatter_plot<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611201013302.png" alt="因变量对数转换后的残差累计概率图的散点图"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611201103276.png" alt="因变量对数转换后的因变量预测值与标准化残差的散点图"></p>
<p>因变量对数转换后的回归方程基本满足正态性假设以及残差方差齐次性假设</p>
<p><strong>提取回归系数估计和95%置信区间</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提取回归系数估计和95%置信区间</span></span><br><span class="line">tidy<span class="punctuation">(</span>model_log<span class="punctuation">,</span> conf.int <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> conf.level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> tidy<span class="punctuation">(</span>model_log<span class="punctuation">,</span> conf.int <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> conf.level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 4 × 7</span></span><br><span class="line">  term        estimate std.error statistic  p.value  conf.low conf.high</span><br><span class="line">  <span class="operator">&lt;</span>chr<span class="operator">&gt;</span>          <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>     <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>     <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>    <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>     <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>     <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span></span><br><span class="line"><span class="number">1</span> <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">0.402</span>    <span class="number">0.105</span>        <span class="number">3.83</span>  <span class="number">1.50</span>e<span class="operator">-</span> <span class="number">4</span>  <span class="number">0.195</span>      <span class="number">0.608</span>  </span><br><span class="line"><span class="number">2</span> phyheal      <span class="number">0.204</span>    <span class="number">0.0208</span>       <span class="number">9.82</span>  <span class="number">2.63e-20</span>  <span class="number">0.163</span>      <span class="number">0.245</span>  </span><br><span class="line"><span class="number">3</span> menheal      <span class="number">0.00681</span>  <span class="number">0.0115</span>       <span class="number">0.593</span> <span class="number">5.54</span>e<span class="operator">-</span> <span class="number">1</span> <span class="operator">-</span><span class="number">0.0158</span>     <span class="number">0.0294</span> </span><br><span class="line"><span class="number">4</span> stress       <span class="number">0.00132</span>  <span class="number">0.000327</span>     <span class="number">4.04</span>  <span class="number">6.59</span>e<span class="operator">-</span> <span class="number">5</span>  <span class="number">0.000677</span>   <span class="number">0.00196</span></span><br></pre></td></tr></table></figure>
<h3 id="相关系数">相关系数</h3>
<p><strong>零相关系数</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算零相关系数</span></span><br><span class="line">corr.test<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;menheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">           logtimedrs phyheal menheal stress</span><br><span class="line">logtimedrs       <span class="number">1.00</span>    <span class="number">0.56</span>    <span class="number">0.34</span>   <span class="number">0.34</span></span><br></pre></td></tr></table></figure>
<p><strong>偏相关系数</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算偏相关系数</span></span><br><span class="line">pcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;menheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">           logtimedrs    phyheal    menheal     stress</span><br><span class="line">logtimedrs <span class="number">1.00000000</span> <span class="number">0.46174569</span> <span class="number">0.03139996</span> <span class="number">0.20929484</span></span><br></pre></td></tr></table></figure>
<p><strong>半偏相关系数</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算半偏相关系数</span></span><br><span class="line">spcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;menheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">           logtimedrs    phyheal    menheal     stress</span><br><span class="line">logtimedrs <span class="number">1.00000000</span> <span class="number">0.42062902</span> <span class="number">0.02538454</span> <span class="number">0.17294627</span></span><br></pre></td></tr></table></figure>
<h2 id="序列回归">序列回归</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拟合回归模型，逐步添加变量</span></span><br><span class="line"><span class="comment"># 第一步：仅包含 phyheal</span></span><br><span class="line">model1 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>logtimedrs <span class="operator">~</span> phyheal<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model1<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">lm.beta<span class="punctuation">(</span>model1<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算零相关系数</span></span><br><span class="line">corr.test<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算偏相关系数</span></span><br><span class="line">pcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算半偏相关系数</span></span><br><span class="line">spcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>model1<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">0.57627</span>    <span class="number">0.09877</span>   <span class="number">5.834</span> <span class="number">1.21e-08</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">phyheal      <span class="number">0.23250</span>    <span class="number">0.01821</span>  <span class="number">12.766</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.7931</span> on <span class="number">358</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.3128</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.3109</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>   <span class="number">163</span> on <span class="number">1</span> and <span class="number">358</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> lm.beta<span class="punctuation">(</span>model1<span class="punctuation">)</span></span><br><span class="line">Standardized Coefficients<span class="operator">::</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>     phyheal </span><br><span class="line">         <span class="literal">NA</span>   <span class="number">0.5593045</span> </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 计算零相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> corr.test<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">Correlation matrix </span><br><span class="line">           logtimedrs phyheal</span><br><span class="line">logtimedrs       <span class="number">1.00</span>    <span class="number">0.56</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 计算偏相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> pcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">           logtimedrs   phyheal</span><br><span class="line">logtimedrs  <span class="number">1.0000000</span> <span class="number">0.5593045</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 计算半偏相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> spcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">           logtimedrs   phyheal</span><br><span class="line">logtimedrs  <span class="number">1.0000000</span> <span class="number">0.5593045</span></span><br></pre></td></tr></table></figure>
<p>身体健康症状<code>phyheal</code>的零阶相关系数、偏相关系数与半偏相关系数相等</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第二步：添加 stress</span></span><br><span class="line">model2 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>logtimedrs <span class="operator">~</span> phyheal <span class="operator">+</span> stress<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">lm.beta<span class="punctuation">(</span>model2<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model2<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算零相关系数</span></span><br><span class="line">corr.test<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算偏相关系数</span></span><br><span class="line">pcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算半偏相关系数</span></span><br><span class="line">spcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>model2<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">0.4074062</span>  <span class="number">0.1041975</span>   <span class="number">3.910</span>  <span class="number">0.00011</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">phyheal     <span class="number">0.2095523</span>  <span class="number">0.0185741</span>  <span class="number">11.282</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">stress      <span class="number">0.0013633</span>  <span class="number">0.0003181</span>   <span class="number">4.286</span> <span class="number">2.35e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.7745</span> on <span class="number">357</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.3464</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.3428</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">94.62</span> on <span class="number">2</span> and <span class="number">357</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> lm.beta<span class="punctuation">(</span>model2<span class="punctuation">)</span></span><br><span class="line">Standardized Coefficients<span class="operator">::</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>     phyheal      stress </span><br><span class="line">         <span class="literal">NA</span>   <span class="number">0.5041089</span>   <span class="number">0.1915007</span> </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 计算零相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> corr.test<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">           logtimedrs phyheal stress</span><br><span class="line">logtimedrs       <span class="number">1.00</span>    <span class="number">0.56</span>   <span class="number">0.34</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 计算偏相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> pcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">           logtimedrs   phyheal    stress</span><br><span class="line">logtimedrs  <span class="number">1.0000000</span> <span class="number">0.5126673</span> <span class="number">0.2212089</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 计算半偏相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> spcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">           logtimedrs   phyheal    stress</span><br><span class="line">logtimedrs  <span class="number">1.0000000</span> <span class="number">0.4827156</span> <span class="number">0.1833739</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第三步：添加 menheal</span></span><br><span class="line">model3 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>logtimedrs <span class="operator">~</span> phyheal <span class="operator">+</span> stress <span class="operator">+</span> menheal<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model3<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>model3<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">0.4015263</span>  <span class="number">0.1047630</span>   <span class="number">3.833</span>  <span class="number">0.00015</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">phyheal     <span class="number">0.2040556</span>  <span class="number">0.0207754</span>   <span class="number">9.822</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">stress      <span class="number">0.0013197</span>  <span class="number">0.0003268</span>   <span class="number">4.038</span> <span class="number">6.59e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">menheal     <span class="number">0.0068070</span>  <span class="number">0.0114839</span>   <span class="number">0.593</span>  <span class="number">0.55373</span>    </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.7752</span> on <span class="number">356</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.3471</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.3416</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">63.08</span> on <span class="number">3</span> and <span class="number">356</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> lm.beta<span class="punctuation">(</span>model3<span class="punctuation">)</span></span><br><span class="line">Standardized Coefficients<span class="operator">::</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>     phyheal      stress     menheal </span><br><span class="line">         <span class="literal">NA</span>  <span class="number">0.49088568</span>  <span class="number">0.18537313</span>  <span class="number">0.03005799</span> </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 计算零相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> corr.test<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;menheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">           logtimedrs phyheal menheal stress</span><br><span class="line">logtimedrs       <span class="number">1.00</span>    <span class="number">0.56</span>    <span class="number">0.34</span>   <span class="number">0.34</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 计算偏相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> pcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;menheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">           logtimedrs    phyheal    menheal     stress</span><br><span class="line">logtimedrs <span class="number">1.00000000</span> <span class="number">0.46174569</span> <span class="number">0.03139996</span> <span class="number">0.20929484</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="comment"># 计算半偏相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> spcor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;logtimedrs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;phyheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;menheal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;stress&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">           logtimedrs    phyheal    menheal     stress</span><br><span class="line">logtimedrs <span class="number">1.00000000</span> <span class="number">0.42062902</span> <span class="number">0.02538454</span> <span class="number">0.17294627</span></span><br></pre></td></tr></table></figure>
<p>可以看出，模型三加入<code>menheal</code>并没有带来R<sup>2</sup>显著的变化，表明新加入的变量对预测因变量没有显著的贡献。并且心理健康症状<code>menheal</code>的标准化系数为0.03005799，不能显著预测看病次数。偏相关系数为0.03139996且半偏相关系数为0.02538454，与零阶相关系数0.34相差较大，表明<code>menheal</code>不能预测看病次数。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>model1<span class="punctuation">,</span> model2<span class="punctuation">,</span> model3<span class="punctuation">)</span></span><br><span class="line">Analysis of Variance Table</span><br><span class="line"></span><br><span class="line">Model <span class="number">1</span><span class="operator">:</span> logtimedrs <span class="operator">~</span> phyheal</span><br><span class="line">Model <span class="number">2</span><span class="operator">:</span> logtimedrs <span class="operator">~</span> phyheal <span class="operator">+</span> stress</span><br><span class="line">Model <span class="number">3</span><span class="operator">:</span> logtimedrs <span class="operator">~</span> phyheal <span class="operator">+</span> stress <span class="operator">+</span> menheal</span><br><span class="line">  Res.Df    RSS Df Sum of Sq       <span class="built_in">F</span>    Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="number">1</span>    <span class="number">358</span> <span class="number">225.18</span>                                   </span><br><span class="line"><span class="number">2</span>    <span class="number">357</span> <span class="number">214.16</span>  <span class="number">1</span>   <span class="number">11.0186</span> <span class="number">18.3347</span> <span class="number">2.386e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="number">3</span>    <span class="number">356</span> <span class="number">213.94</span>  <span class="number">1</span>    <span class="number">0.2111</span>  <span class="number">0.3513</span>    <span class="number">0.5537</span>    </span><br></pre></td></tr></table></figure>
<h1>EFA</h1>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>GPArotation<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/7第七章 探索性因素分析/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./7_2.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="数据预处理">数据预处理</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择Q1-Q32</span></span><br><span class="line">analysis_data <span class="operator">&lt;-</span> data<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">32</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 缺失值处理</span></span><br><span class="line">analysis_data<span class="punctuation">[</span>analysis_data <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="literal">NA</span></span><br><span class="line">colSums<span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>analysis_data<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line"><span class="comment"># summary(analysis_data)</span></span><br><span class="line">describe<span class="punctuation">(</span>analysis_data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除缺失值</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算相关系数矩阵</span></span><br><span class="line">cor_matrix <span class="operator">&lt;-</span> cor<span class="punctuation">(</span>analysis_data<span class="punctuation">,</span> use<span class="operator">=</span><span class="string">&quot;complete.obs&quot;</span><span class="punctuation">)</span></span><br><span class="line">cor.plot<span class="punctuation">(</span>cor_matrix<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># KMO检验 与 MSA</span></span><br><span class="line">KMO<span class="punctuation">(</span>cor_matrix<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Bartlett&#x27;s 检验</span></span><br><span class="line">cortest.bartlett<span class="punctuation">(</span>cor_matrix<span class="punctuation">,</span> n <span class="operator">=</span> nrow<span class="punctuation">(</span>analysis_data<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611212454868.png" alt="相关矩阵"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> KMO<span class="punctuation">(</span>cor_matrix<span class="punctuation">)</span></span><br><span class="line">Kaiser<span class="operator">-</span>Meyer<span class="operator">-</span>Olkin factor adequacy</span><br><span class="line">Call<span class="operator">:</span> KMO<span class="punctuation">(</span>r <span class="operator">=</span> cor_matrix<span class="punctuation">)</span></span><br><span class="line">Overall MSA <span class="operator">=</span>  <span class="number">0.86</span></span><br><span class="line">MSA <span class="keyword">for</span> each item <span class="operator">=</span> </span><br><span class="line">  Q1   Q2   Q3   Q4   Q5   Q6   Q7   Q8   Q9  Q10  Q11  Q12  Q13  Q14  Q15  Q16  Q17  Q18  Q19  Q20  Q21  Q22  Q23  Q24  Q25  Q26  Q27 </span><br><span class="line"><span class="number">0.91</span> <span class="number">0.90</span> <span class="number">0.90</span> <span class="number">0.87</span> <span class="number">0.87</span> <span class="number">0.79</span> <span class="number">0.79</span> <span class="number">0.82</span> <span class="number">0.91</span> <span class="number">0.85</span> <span class="number">0.86</span> <span class="number">0.88</span> <span class="number">0.89</span> <span class="number">0.90</span> <span class="number">0.82</span> <span class="number">0.86</span> <span class="number">0.88</span> <span class="number">0.83</span> <span class="number">0.91</span> <span class="number">0.82</span> <span class="number">0.89</span> <span class="number">0.85</span> <span class="number">0.81</span> <span class="number">0.82</span> <span class="number">0.83</span> <span class="number">0.88</span> <span class="number">0.83</span> </span><br><span class="line"> Q28  Q29  Q30  Q31  Q32 </span><br><span class="line"><span class="number">0.87</span> <span class="number">0.87</span> <span class="number">0.76</span> <span class="number">0.82</span> <span class="number">0.90</span> </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> cortest.bartlett<span class="punctuation">(</span>cor_matrix<span class="punctuation">,</span> n <span class="operator">=</span> nrow<span class="punctuation">(</span>analysis_data<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>chisq</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">4504.689</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>p.value</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>df</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">496</span></span><br></pre></td></tr></table></figure>
<p><code>KMO</code>的值为0.86大于0.5接近1；Bartlett球形检验结果是显著的；反映像相关矩阵MSA都大于0.5，适合做因素分析。</p>
<h2 id="确定因子数目">确定因子数目</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 估计合适的因子个数</span></span><br><span class="line">fa.parallel<span class="punctuation">(</span>analysis_data<span class="punctuation">,</span> fa<span class="operator">=</span><span class="string">&quot;fa&quot;</span><span class="punctuation">,</span> n.iter<span class="operator">=</span><span class="number">500</span><span class="punctuation">)</span></span><br><span class="line">vss<span class="punctuation">(</span>analysis_data<span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&quot;promax&quot;</span><span class="punctuation">,</span> fm <span class="operator">=</span> <span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611214026555.png" alt="碎石图"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611214137614.png" alt="vvs"></p>
<p>可以看出，碎石图的拐点位于5个因素的位置</p>
<h2 id="因素数固定为7的探索性因素分析">因素数固定为7的探索性因素分析</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 公共因素模型 主轴因素法 因子数为7</span></span><br><span class="line">efa_7_pa <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>analysis_data<span class="punctuation">,</span> nfactors<span class="operator">=</span><span class="number">7</span><span class="punctuation">,</span> rotate<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 总体方差解释</span></span><br><span class="line">efa_7_pa<span class="operator">$</span>Vaccounted</span><br><span class="line"><span class="comment"># 共同度</span></span><br><span class="line">efa_7_pa<span class="operator">$</span>communality</span><br><span class="line"><span class="comment"># 成分矩阵</span></span><br><span class="line">efa_7_pa<span class="operator">$</span>loadings</span><br><span class="line"><span class="comment"># 只显示大于0.3的载荷</span></span><br><span class="line">print<span class="punctuation">(</span>efa_7_pa<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">plot<span class="punctuation">(</span>efa_7_pa<span class="punctuation">)</span></span><br><span class="line">fa.diagram<span class="punctuation">(</span>efa_7_pa<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> efa_7_pa<span class="operator">$</span>Vaccounted</span><br><span class="line">                            PA1        PA2        PA3        PA4        PA5        PA6        PA7</span><br><span class="line">SS loadings           <span class="number">6.0813377</span> <span class="number">2.73434132</span> <span class="number">2.61094942</span> <span class="number">1.65202904</span> <span class="number">0.64506901</span> <span class="number">0.56737623</span> <span class="number">0.45388757</span></span><br><span class="line">Proportion Var        <span class="number">0.1900418</span> <span class="number">0.08544817</span> <span class="number">0.08159217</span> <span class="number">0.05162591</span> <span class="number">0.02015841</span> <span class="number">0.01773051</span> <span class="number">0.01418399</span></span><br><span class="line">Cumulative Var        <span class="number">0.1900418</span> <span class="number">0.27548997</span> <span class="number">0.35708214</span> <span class="number">0.40870804</span> <span class="number">0.42886645</span> <span class="number">0.44659696</span> <span class="number">0.46078095</span></span><br><span class="line">Proportion Explained  <span class="number">0.4124342</span> <span class="number">0.18544206</span> <span class="number">0.17707366</span> <span class="number">0.11204002</span> <span class="number">0.04374835</span> <span class="number">0.03847925</span> <span class="number">0.03078249</span></span><br><span class="line">Cumulative Proportion <span class="number">0.4124342</span> <span class="number">0.59787622</span> <span class="number">0.77494988</span> <span class="number">0.88698990</span> <span class="number">0.93073825</span> <span class="number">0.96921751</span> <span class="number">1.00000000</span></span><br><span class="line"><span class="operator">&gt;</span> efa_7_pa<span class="operator">$</span>communality</span><br><span class="line">       Q1        Q2        Q3        Q4        Q5        Q6        Q7        Q8        Q9       Q10       Q11       Q12       Q13 </span><br><span class="line"><span class="number">0.5301886</span> <span class="number">0.4358322</span> <span class="number">0.4134696</span> <span class="number">0.4153618</span> <span class="number">0.3550281</span> <span class="number">0.3194059</span> <span class="number">0.3771826</span> <span class="number">0.6217469</span> <span class="number">0.2791207</span> <span class="number">0.5942034</span> <span class="number">0.3818267</span> <span class="number">0.4474353</span> <span class="number">0.5873971</span> </span><br><span class="line">      Q14       Q15       Q16       Q17       Q18       Q19       Q20       Q21       Q22       Q23       Q24       Q25       Q26 </span><br><span class="line"><span class="number">0.4835861</span> <span class="number">0.6512268</span> <span class="number">0.4792159</span> <span class="number">0.6518687</span> <span class="number">0.6188608</span> <span class="number">0.4615502</span> <span class="number">0.5965053</span> <span class="number">0.5176691</span> <span class="number">0.4549469</span> <span class="number">0.3967925</span> <span class="number">0.2961682</span> <span class="number">0.4942008</span> <span class="number">0.4989878</span> </span><br><span class="line">      Q27       Q28       Q29       Q30       Q31       Q32 </span><br><span class="line"><span class="number">0.4268663</span> <span class="number">0.2830110</span> <span class="number">0.4525763</span> <span class="number">0.2163821</span> <span class="number">0.5086944</span> <span class="number">0.4976820</span> </span><br><span class="line"><span class="operator">&gt;</span> print<span class="punctuation">(</span>efa_7_pa<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Loadings<span class="operator">:</span></span><br><span class="line">    PA1    PA2    PA3    PA4    PA5    PA6    PA7   </span><br><span class="line">Q1  <span class="operator">-</span><span class="number">0.579</span>                                          </span><br><span class="line">Q2   <span class="number">0.508</span>                                          </span><br><span class="line">Q3   <span class="number">0.467</span>        <span class="operator">-</span><span class="number">0.398</span>                            </span><br><span class="line">Q4   <span class="number">0.332</span>  <span class="number">0.413</span>                                   </span><br><span class="line">Q5   <span class="number">0.482</span>                                          </span><br><span class="line">Q6   <span class="number">0.414</span>                                          </span><br><span class="line">Q7         <span class="operator">-</span><span class="number">0.301</span>  <span class="number">0.460</span>                            </span><br><span class="line">Q8   <span class="number">0.422</span>  <span class="number">0.527</span>  <span class="number">0.359</span>                            </span><br><span class="line">Q9  <span class="operator">-</span><span class="number">0.443</span>                                          </span><br><span class="line">Q10  <span class="number">0.527</span>                <span class="number">0.460</span>                     </span><br><span class="line">Q11               <span class="operator">-</span><span class="number">0.443</span>                            </span><br><span class="line">Q12  <span class="number">0.353</span>  <span class="number">0.389</span>  <span class="number">0.302</span>                            </span><br><span class="line">Q13  <span class="number">0.556</span>                              <span class="number">0.318</span>       </span><br><span class="line">Q14  <span class="number">0.547</span>                                          </span><br><span class="line">Q15 <span class="operator">-</span><span class="number">0.367</span> <span class="operator">-</span><span class="number">0.304</span>  <span class="number">0.603</span>                            </span><br><span class="line">Q16 <span class="operator">-</span><span class="number">0.327</span> <span class="operator">-</span><span class="number">0.514</span>                                   </span><br><span class="line">Q17 <span class="operator">-</span><span class="number">0.642</span>                <span class="number">0.368</span>                     </span><br><span class="line">Q18  <span class="number">0.518</span>                <span class="number">0.507</span>                     </span><br><span class="line">Q19  <span class="number">0.558</span>                                          </span><br><span class="line">Q20  <span class="number">0.392</span>  <span class="number">0.588</span>                                   </span><br><span class="line">Q21  <span class="number">0.536</span> <span class="operator">-</span><span class="number">0.312</span>        <span class="operator">-</span><span class="number">0.311</span>                     </span><br><span class="line">Q22 <span class="operator">-</span><span class="number">0.437</span>                       <span class="number">0.378</span>              </span><br><span class="line">Q23 <span class="operator">-</span><span class="number">0.362</span>         <span class="number">0.373</span>                            </span><br><span class="line">Q24         <span class="number">0.354</span>                                   </span><br><span class="line">Q25 <span class="operator">-</span><span class="number">0.471</span>  <span class="number">0.350</span>                                   </span><br><span class="line">Q26  <span class="number">0.534</span>                <span class="number">0.303</span>                     </span><br><span class="line">Q27               <span class="operator">-</span><span class="number">0.451</span>                            </span><br><span class="line">Q28  <span class="number">0.419</span>                                          </span><br><span class="line">Q29 <span class="operator">-</span><span class="number">0.360</span>         <span class="number">0.317</span>                            </span><br><span class="line">Q30                       <span class="number">0.306</span>                     </span><br><span class="line">Q31 <span class="operator">-</span><span class="number">0.352</span>         <span class="number">0.571</span>                            </span><br><span class="line">Q32  <span class="number">0.437</span>  <span class="number">0.444</span>                                   </span><br></pre></td></tr></table></figure>
<p>可以看出，总体方差解释率为46.078095%</p>
<p>并且在第7个因素上，没有任何一个变量的因素载荷绝对值大于0.3，且在第5、6个因素上，都各只有一个变量的因素载荷绝对值大于0.3</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611221757471.png" alt="7因素探索性因素分析"></p>
<h2 id="因素数固定为5的探索性因素分析">因素数固定为5的探索性因素分析</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 因子数为5</span></span><br><span class="line">efa_5_pa <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>analysis_data<span class="punctuation">,</span> nfactors<span class="operator">=</span><span class="number">5</span><span class="punctuation">,</span> rotate<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 总体方差解释</span></span><br><span class="line">efa_5_pa<span class="operator">$</span>Vaccounted</span><br><span class="line"><span class="comment"># 共同度</span></span><br><span class="line">efa_5_pa<span class="operator">$</span>communality</span><br><span class="line"><span class="comment"># 成分矩阵</span></span><br><span class="line">efa_5_pa<span class="operator">$</span>loadings</span><br><span class="line"><span class="comment"># 只显示大于0.3的载荷</span></span><br><span class="line">print<span class="punctuation">(</span>efa_5_pa<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">plot<span class="punctuation">(</span>efa_5_pa<span class="punctuation">)</span></span><br><span class="line">fa.diagram<span class="punctuation">(</span>efa_5_pa<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> efa_5_pa<span class="operator">$</span>Vaccounted</span><br><span class="line">                            PA1        PA2        PA3        PA4        PA5</span><br><span class="line">SS loadings           <span class="number">6.0447895</span> <span class="number">2.70811626</span> <span class="number">2.58239077</span> <span class="number">1.62184075</span> <span class="number">0.59269854</span></span><br><span class="line">Proportion Var        <span class="number">0.1888997</span> <span class="number">0.08462863</span> <span class="number">0.08069971</span> <span class="number">0.05068252</span> <span class="number">0.01852183</span></span><br><span class="line">Cumulative Var        <span class="number">0.1888997</span> <span class="number">0.27352830</span> <span class="number">0.35422802</span> <span class="number">0.40491054</span> <span class="number">0.42343237</span></span><br><span class="line">Proportion Explained  <span class="number">0.4461153</span> <span class="number">0.19986340</span> <span class="number">0.19058465</span> <span class="number">0.11969450</span> <span class="number">0.04374212</span></span><br><span class="line">Cumulative Proportion <span class="number">0.4461153</span> <span class="number">0.64597873</span> <span class="number">0.83656339</span> <span class="number">0.95625788</span> <span class="number">1.00000000</span></span><br><span class="line"><span class="operator">&gt;</span> efa_5_pa<span class="operator">$</span>communality</span><br><span class="line">       Q1        Q2        Q3        Q4        Q5        Q6        Q7        Q8        Q9       Q10       Q11       Q12       Q13 </span><br><span class="line"><span class="number">0.4895669</span> <span class="number">0.4184995</span> <span class="number">0.4129032</span> <span class="number">0.3615361</span> <span class="number">0.3316432</span> <span class="number">0.2657098</span> <span class="number">0.3831236</span> <span class="number">0.6236585</span> <span class="number">0.2700609</span> <span class="number">0.5442838</span> <span class="number">0.3369135</span> <span class="number">0.4022832</span> <span class="number">0.4255985</span> </span><br><span class="line">      Q14       Q15       Q16       Q17       Q18       Q19       Q20       Q21       Q22       Q23       Q24       Q25       Q26 </span><br><span class="line"><span class="number">0.4926129</span> <span class="number">0.6275907</span> <span class="number">0.4857603</span> <span class="number">0.6250116</span> <span class="number">0.6247279</span> <span class="number">0.4436987</span> <span class="number">0.5957230</span> <span class="number">0.5273436</span> <span class="number">0.2401221</span> <span class="number">0.3335453</span> <span class="number">0.2501605</span> <span class="number">0.4073258</span> <span class="number">0.4757534</span> </span><br><span class="line">      Q27       Q28       Q29       Q30       Q31       Q32 </span><br><span class="line"><span class="number">0.3700609</span> <span class="number">0.2784140</span> <span class="number">0.3481493</span> <span class="number">0.1868792</span> <span class="number">0.4746635</span> <span class="number">0.4965126</span> </span><br><span class="line"><span class="operator">&gt;</span> print<span class="punctuation">(</span>efa_5_pa<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Loadings<span class="operator">:</span></span><br><span class="line">    PA1    PA2    PA3    PA4    PA5   </span><br><span class="line">Q1  <span class="operator">-</span><span class="number">0.576</span>                            </span><br><span class="line">Q2   <span class="number">0.507</span>                            </span><br><span class="line">Q3   <span class="number">0.469</span>        <span class="operator">-</span><span class="number">0.400</span>              </span><br><span class="line">Q4   <span class="number">0.332</span>  <span class="number">0.404</span>                     </span><br><span class="line">Q5   <span class="number">0.481</span>                            </span><br><span class="line">Q6   <span class="number">0.412</span>                            </span><br><span class="line">Q7         <span class="operator">-</span><span class="number">0.303</span>  <span class="number">0.463</span>              </span><br><span class="line">Q8   <span class="number">0.425</span>  <span class="number">0.528</span>  <span class="number">0.363</span>              </span><br><span class="line">Q9  <span class="operator">-</span><span class="number">0.444</span>                            </span><br><span class="line">Q10  <span class="number">0.525</span>                <span class="number">0.447</span>       </span><br><span class="line">Q11               <span class="operator">-</span><span class="number">0.438</span>              </span><br><span class="line">Q12  <span class="number">0.352</span>  <span class="number">0.383</span>                     </span><br><span class="line">Q13  <span class="number">0.542</span>                            </span><br><span class="line">Q14  <span class="number">0.550</span>                            </span><br><span class="line">Q15 <span class="operator">-</span><span class="number">0.366</span> <span class="operator">-</span><span class="number">0.302</span>  <span class="number">0.601</span>              </span><br><span class="line">Q16 <span class="operator">-</span><span class="number">0.330</span> <span class="operator">-</span><span class="number">0.517</span>                     </span><br><span class="line">Q17 <span class="operator">-</span><span class="number">0.640</span>                <span class="number">0.371</span>       </span><br><span class="line">Q18  <span class="number">0.520</span>                <span class="number">0.511</span>       </span><br><span class="line">Q19  <span class="number">0.558</span>                            </span><br><span class="line">Q20  <span class="number">0.395</span>  <span class="number">0.588</span>                     </span><br><span class="line">Q21  <span class="number">0.538</span> <span class="operator">-</span><span class="number">0.316</span>        <span class="operator">-</span><span class="number">0.321</span>       </span><br><span class="line">Q22 <span class="operator">-</span><span class="number">0.423</span>                            </span><br><span class="line">Q23 <span class="operator">-</span><span class="number">0.359</span>         <span class="number">0.367</span>              </span><br><span class="line">Q24         <span class="number">0.348</span>                     </span><br><span class="line">Q25 <span class="operator">-</span><span class="number">0.464</span>  <span class="number">0.340</span>                     </span><br><span class="line">Q26  <span class="number">0.533</span>                            </span><br><span class="line">Q27               <span class="operator">-</span><span class="number">0.444</span>              </span><br><span class="line">Q28  <span class="number">0.420</span>                            </span><br><span class="line">Q29 <span class="operator">-</span><span class="number">0.353</span>         <span class="number">0.308</span>              </span><br><span class="line">Q30                       <span class="number">0.301</span>       </span><br><span class="line">Q31 <span class="operator">-</span><span class="number">0.350</span>         <span class="number">0.567</span>              </span><br><span class="line">Q32  <span class="number">0.440</span>  <span class="number">0.443</span>                     </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以看出，总体方差解释率为42.343237%</p>
<p>并且在第5个因素上，没有任何一个变量的因素载荷绝对值大于0.3</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611221825594.png" alt="5因素探索性因素分析"></p>
<h2 id="因素数固定为4的探索性因素分析">因素数固定为4的探索性因素分析</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 因子数为4 斜交旋转</span></span><br><span class="line">efa_4_pa <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>analysis_data<span class="punctuation">,</span> nfactors<span class="operator">=</span><span class="number">4</span><span class="punctuation">,</span> rotate<span class="operator">=</span><span class="string">&quot;promax&quot;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 总体方差解释</span></span><br><span class="line">efa_4_pa<span class="operator">$</span>Vaccounted</span><br><span class="line"><span class="comment"># 共同度</span></span><br><span class="line">efa_4_pa<span class="operator">$</span>communality</span><br><span class="line"><span class="comment"># 成分矩阵</span></span><br><span class="line">efa_4_pa<span class="operator">$</span>loadings</span><br><span class="line"><span class="comment"># 只显示大于0.3的载荷</span></span><br><span class="line">print<span class="punctuation">(</span>efa_4_pa<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> efa_4_pa<span class="operator">$</span>Vaccounted</span><br><span class="line">                            PA1        PA2       PA4        PA3</span><br><span class="line">SS loadings           <span class="number">3.6326482</span> <span class="number">3.15732774</span> <span class="number">3.0501600</span> <span class="number">3.04880469</span></span><br><span class="line">Proportion Var        <span class="number">0.1135203</span> <span class="number">0.09866649</span> <span class="number">0.0953175</span> <span class="number">0.09527515</span></span><br><span class="line">Cumulative Var        <span class="number">0.1135203</span> <span class="number">0.21218675</span> <span class="number">0.3075042</span> <span class="number">0.40277940</span></span><br><span class="line">Proportion Explained  <span class="number">0.2818423</span> <span class="number">0.24496410</span> <span class="number">0.2366494</span> <span class="number">0.23654424</span></span><br><span class="line">Cumulative Proportion <span class="number">0.2818423</span> <span class="number">0.52680636</span> <span class="number">0.7634558</span> <span class="number">1.00000000</span></span><br><span class="line"><span class="operator">&gt;</span> efa_4_pa<span class="operator">$</span>communality</span><br><span class="line">       Q1        Q2        Q3        Q4        Q5        Q6        Q7        Q8        Q9       Q10       Q11       Q12       Q13 </span><br><span class="line"><span class="number">0.4900625</span> <span class="number">0.3937478</span> <span class="number">0.4067060</span> <span class="number">0.3584038</span> <span class="number">0.3256476</span> <span class="number">0.2662986</span> <span class="number">0.3822206</span> <span class="number">0.6101605</span> <span class="number">0.2693080</span> <span class="number">0.5384912</span> <span class="number">0.3172389</span> <span class="number">0.3925288</span> <span class="number">0.4219459</span> </span><br><span class="line">      Q14       Q15       Q16       Q17       Q18       Q19       Q20       Q21       Q22       Q23       Q24       Q25       Q26 </span><br><span class="line"><span class="number">0.4532441</span> <span class="number">0.5764920</span> <span class="number">0.3976837</span> <span class="number">0.6248901</span> <span class="number">0.6294796</span> <span class="number">0.3836804</span> <span class="number">0.5833695</span> <span class="number">0.5209850</span> <span class="number">0.1843002</span> <span class="number">0.2696753</span> <span class="number">0.1921420</span> <span class="number">0.3905649</span> <span class="number">0.4716011</span> </span><br><span class="line">      Q27       Q28       Q29       Q30       Q31       Q32 </span><br><span class="line"><span class="number">0.3483654</span> <span class="number">0.2010546</span> <span class="number">0.3486561</span> <span class="number">0.1874059</span> <span class="number">0.4625831</span> <span class="number">0.4900075</span> </span><br><span class="line"><span class="operator">&gt;</span> print<span class="punctuation">(</span>efa_4_pa<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Loadings<span class="operator">:</span></span><br><span class="line">    PA1    PA2    PA4    PA3   </span><br><span class="line">Q1   <span class="number">0.700</span>                     </span><br><span class="line">Q2                 <span class="number">0.592</span>       </span><br><span class="line">Q3                       <span class="operator">-</span><span class="number">0.566</span></span><br><span class="line">Q4          <span class="number">0.601</span>              </span><br><span class="line">Q5  <span class="operator">-</span><span class="number">0.546</span>                     </span><br><span class="line">Q6                 <span class="number">0.457</span>       </span><br><span class="line">Q7                        <span class="number">0.655</span></span><br><span class="line">Q8          <span class="number">0.789</span>              </span><br><span class="line">Q9   <span class="number">0.509</span>                     </span><br><span class="line">Q10                <span class="number">0.765</span>       </span><br><span class="line">Q11                      <span class="operator">-</span><span class="number">0.594</span></span><br><span class="line">Q12         <span class="number">0.627</span>              </span><br><span class="line">Q13 <span class="operator">-</span><span class="number">0.626</span>                     </span><br><span class="line">Q14                <span class="number">0.606</span>       </span><br><span class="line">Q15                       <span class="number">0.782</span></span><br><span class="line">Q16        <span class="operator">-</span><span class="number">0.620</span>              </span><br><span class="line">Q17  <span class="number">0.815</span>                     </span><br><span class="line">Q18                <span class="number">0.858</span>       </span><br><span class="line">Q19                      <span class="operator">-</span><span class="number">0.427</span></span><br><span class="line">Q20         <span class="number">0.762</span>              </span><br><span class="line">Q21 <span class="operator">-</span><span class="number">0.731</span>                     </span><br><span class="line">Q22                            </span><br><span class="line">Q23                       <span class="number">0.478</span></span><br><span class="line">Q24         <span class="number">0.432</span>              </span><br><span class="line">Q25  <span class="number">0.639</span>                     </span><br><span class="line">Q26                <span class="number">0.653</span>       </span><br><span class="line">Q27                      <span class="operator">-</span><span class="number">0.611</span></span><br><span class="line">Q28                            </span><br><span class="line">Q29  <span class="number">0.548</span>                     </span><br><span class="line">Q30                <span class="number">0.482</span>       </span><br><span class="line">Q31                       <span class="number">0.674</span></span><br><span class="line">Q32         <span class="number">0.681</span>              </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以看出，总体方差解释率为40.277940%
有两个变量Q22与Q28在所有因素上的载荷绝对值都小于0.3。并且Q22的共同度为0.1843002，Q28的共同度为0.2010546。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611221945224.png" alt="4因素探索性因素分析"></p>
<p><mark>为了避免误删的情况，一次删除一个变量</mark>，先删除共同度更低的Q22</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删去Q22</span></span><br><span class="line">analysis_data1 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>analysis_data<span class="punctuation">,</span> select <span class="operator">=</span> <span class="operator">-</span>Q22<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>analysis_data1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 因子数为4 斜交旋转</span></span><br><span class="line">efa_4_pa1 <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>analysis_data1<span class="punctuation">,</span> nfactors<span class="operator">=</span><span class="number">4</span><span class="punctuation">,</span> rotate<span class="operator">=</span><span class="string">&quot;promax&quot;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 总体方差解释</span></span><br><span class="line">efa_4_pa1<span class="operator">$</span>Vaccounted</span><br><span class="line"><span class="comment"># 共同度</span></span><br><span class="line">efa_4_pa1<span class="operator">$</span>communality</span><br><span class="line"><span class="comment"># 成分矩阵</span></span><br><span class="line">efa_4_pa1<span class="operator">$</span>loadings</span><br><span class="line"><span class="comment"># 只显示大于0.3的载荷</span></span><br><span class="line">print<span class="punctuation">(</span>efa_4_pa1<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">plot<span class="punctuation">(</span>efa_4_pa1<span class="punctuation">)</span></span><br><span class="line">fa.diagram<span class="punctuation">(</span>efa_4_pa1<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> efa_4_pa1<span class="operator">$</span>Vaccounted</span><br><span class="line">                            PA1       PA2        PA3        PA4</span><br><span class="line">SS loadings           <span class="number">3.5893385</span> <span class="number">3.1448807</span> <span class="number">3.04123134</span> <span class="number">2.92815052</span></span><br><span class="line">Proportion Var        <span class="number">0.1157851</span> <span class="number">0.1014478</span> <span class="number">0.09810424</span> <span class="number">0.09445647</span></span><br><span class="line">Cumulative Var        <span class="number">0.1157851</span> <span class="number">0.2172329</span> <span class="number">0.31533711</span> <span class="number">0.40979358</span></span><br><span class="line">Proportion Explained  <span class="number">0.2825450</span> <span class="number">0.2475582</span> <span class="number">0.23939915</span> <span class="number">0.23049768</span></span><br><span class="line">Cumulative Proportion <span class="number">0.2825450</span> <span class="number">0.5301032</span> <span class="number">0.76950232</span> <span class="number">1.00000000</span></span><br><span class="line"><span class="operator">&gt;</span> efa_4_pa1<span class="operator">$</span>communality</span><br><span class="line">       Q1        Q2        Q3        Q4        Q5        Q6        Q7        Q8        Q9       Q10       Q11       Q12       Q13 </span><br><span class="line"><span class="number">0.4863391</span> <span class="number">0.3795585</span> <span class="number">0.4091628</span> <span class="number">0.3578021</span> <span class="number">0.3240189</span> <span class="number">0.2766300</span> <span class="number">0.3825274</span> <span class="number">0.6092897</span> <span class="number">0.2706913</span> <span class="number">0.5401742</span> <span class="number">0.3174019</span> <span class="number">0.3949205</span> <span class="number">0.4275838</span> </span><br><span class="line">      Q14       Q15       Q16       Q17       Q18       Q19       Q20       Q21       Q23       Q24       Q25       Q26       Q27 </span><br><span class="line"><span class="number">0.4403981</span> <span class="number">0.5756366</span> <span class="number">0.3959852</span> <span class="number">0.6258198</span> <span class="number">0.6288677</span> <span class="number">0.3899786</span> <span class="number">0.5801802</span> <span class="number">0.5219272</span> <span class="number">0.2694124</span> <span class="number">0.1931119</span> <span class="number">0.3943182</span> <span class="number">0.4680189</span> <span class="number">0.3528202</span> </span><br><span class="line">      Q28       Q29       Q30       Q31       Q32 </span><br><span class="line"><span class="number">0.2060787</span> <span class="number">0.3450362</span> <span class="number">0.1908110</span> <span class="number">0.4578422</span> <span class="number">0.4912575</span> </span><br><span class="line"><span class="operator">&gt;</span> print<span class="punctuation">(</span>efa_4_pa1<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Loadings<span class="operator">:</span></span><br><span class="line">    PA1    PA2    PA3    PA4   </span><br><span class="line">Q1   <span class="number">0.693</span>                     </span><br><span class="line">Q2                        <span class="number">0.570</span></span><br><span class="line">Q3                <span class="operator">-</span><span class="number">0.566</span>       </span><br><span class="line">Q4          <span class="number">0.598</span>              </span><br><span class="line">Q5  <span class="operator">-</span><span class="number">0.541</span>                     </span><br><span class="line">Q6                        <span class="number">0.461</span></span><br><span class="line">Q7                 <span class="number">0.651</span>       </span><br><span class="line">Q8          <span class="number">0.785</span>              </span><br><span class="line">Q9   <span class="number">0.505</span>                     </span><br><span class="line">Q10                       <span class="number">0.752</span></span><br><span class="line">Q11               <span class="operator">-</span><span class="number">0.591</span>       </span><br><span class="line">Q12         <span class="number">0.625</span>              </span><br><span class="line">Q13 <span class="operator">-</span><span class="number">0.622</span>                     </span><br><span class="line">Q14                       <span class="number">0.586</span></span><br><span class="line">Q15                <span class="number">0.776</span>       </span><br><span class="line">Q16        <span class="operator">-</span><span class="number">0.616</span>              </span><br><span class="line">Q17  <span class="number">0.806</span>                     </span><br><span class="line">Q18                       <span class="number">0.841</span></span><br><span class="line">Q19               <span class="operator">-</span><span class="number">0.430</span>       </span><br><span class="line">Q20         <span class="number">0.758</span>              </span><br><span class="line">Q21 <span class="operator">-</span><span class="number">0.724</span>                     </span><br><span class="line">Q23                <span class="number">0.476</span>       </span><br><span class="line">Q24         <span class="number">0.429</span>              </span><br><span class="line">Q25  <span class="number">0.634</span>                     </span><br><span class="line">Q26                       <span class="number">0.639</span></span><br><span class="line">Q27               <span class="operator">-</span><span class="number">0.610</span>       </span><br><span class="line">Q28                            </span><br><span class="line">Q29  <span class="number">0.539</span>                     </span><br><span class="line">Q30                       <span class="number">0.476</span></span><br><span class="line">Q31                <span class="number">0.667</span>       </span><br><span class="line">Q32         <span class="number">0.680</span>              </span><br></pre></td></tr></table></figure>
<p>可以看出，总体方差解释率为40.979358%
变量Q28在所有因素上的载荷绝对值小于0.3，Q28的共同度为0.2060787。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240611222024031.png" alt="4因素探索性因素分析"></p>
<p>继续删除Q28变量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删去Q28</span></span><br><span class="line">analysis_data2 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>analysis_data1<span class="punctuation">,</span> select <span class="operator">=</span> <span class="operator">-</span>Q28<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>analysis_data2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 因子数为4 斜交旋转</span></span><br><span class="line">efa_4_pa2 <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>analysis_data2<span class="punctuation">,</span> nfactors<span class="operator">=</span><span class="number">4</span><span class="punctuation">,</span> rotate<span class="operator">=</span><span class="string">&quot;promax&quot;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&quot;pa&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 总体方差解释</span></span><br><span class="line">efa_4_pa2<span class="operator">$</span>Vaccounted</span><br><span class="line"><span class="comment"># 共同度</span></span><br><span class="line">efa_4_pa2<span class="operator">$</span>communality</span><br><span class="line"><span class="comment"># 成分矩阵</span></span><br><span class="line">efa_4_pa2<span class="operator">$</span>loadings</span><br><span class="line"><span class="comment"># 只显示大于0.3的载荷</span></span><br><span class="line">print<span class="punctuation">(</span>efa_4_pa2<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">plot<span class="punctuation">(</span>efa_4_pa2<span class="punctuation">)</span></span><br><span class="line">fa.diagram<span class="punctuation">(</span>efa_4_pa2<span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> efa_4_pa2<span class="operator">$</span>Vaccounted</span><br><span class="line">                            PA1       PA2        PA3        PA4</span><br><span class="line">SS loadings           <span class="number">3.5828806</span> <span class="number">3.0766135</span> <span class="number">2.99839031</span> <span class="number">2.84177976</span></span><br><span class="line">Proportion Var        <span class="number">0.1194294</span> <span class="number">0.1025538</span> <span class="number">0.09994634</span> <span class="number">0.09472599</span></span><br><span class="line">Cumulative Var        <span class="number">0.1194294</span> <span class="number">0.2219831</span> <span class="number">0.32192948</span> <span class="number">0.41665547</span></span><br><span class="line">Proportion Explained  <span class="number">0.2866381</span> <span class="number">0.2461357</span> <span class="number">0.23987767</span> <span class="number">0.22734849</span></span><br><span class="line">Cumulative Proportion <span class="number">0.2866381</span> <span class="number">0.5327738</span> <span class="number">0.77265151</span> <span class="number">1.00000000</span></span><br><span class="line"><span class="operator">&gt;</span> efa_4_pa2<span class="operator">$</span>communality</span><br><span class="line">       Q1        Q2        Q3        Q4        Q5        Q6        Q7        Q8        Q9       Q10       Q11       Q12       Q13 </span><br><span class="line"><span class="number">0.4862573</span> <span class="number">0.3824251</span> <span class="number">0.4032269</span> <span class="number">0.3536933</span> <span class="number">0.3241615</span> <span class="number">0.2812596</span> <span class="number">0.3745370</span> <span class="number">0.6094749</span> <span class="number">0.2703332</span> <span class="number">0.5315761</span> <span class="number">0.3167107</span> <span class="number">0.3900420</span> <span class="number">0.4270932</span> </span><br><span class="line">      Q14       Q15       Q16       Q17       Q18       Q19       Q20       Q21       Q23       Q24       Q25       Q26       Q27 </span><br><span class="line"><span class="number">0.4543375</span> <span class="number">0.5865768</span> <span class="number">0.4022270</span> <span class="number">0.6254822</span> <span class="number">0.6306127</span> <span class="number">0.3890294</span> <span class="number">0.5902971</span> <span class="number">0.5227965</span> <span class="number">0.2737261</span> <span class="number">0.1899345</span> <span class="number">0.3935340</span> <span class="number">0.4567565</span> <span class="number">0.3432978</span> </span><br><span class="line">      Q29       Q30       Q31       Q32 </span><br><span class="line"><span class="number">0.3456581</span> <span class="number">0.1904744</span> <span class="number">0.4630060</span> <span class="number">0.4911267</span> </span><br><span class="line"><span class="operator">&gt;</span> print<span class="punctuation">(</span>efa_4_pa2<span class="operator">$</span>loadings<span class="punctuation">,</span> cutoff<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Loadings<span class="operator">:</span></span><br><span class="line">    PA1    PA2    PA3    PA4   </span><br><span class="line">Q1   <span class="number">0.693</span>                     </span><br><span class="line">Q2                        <span class="number">0.566</span></span><br><span class="line">Q3                <span class="operator">-</span><span class="number">0.560</span>       </span><br><span class="line">Q4          <span class="number">0.589</span>              </span><br><span class="line">Q5  <span class="operator">-</span><span class="number">0.540</span>                     </span><br><span class="line">Q6                        <span class="number">0.459</span></span><br><span class="line">Q7                 <span class="number">0.640</span>       </span><br><span class="line">Q8          <span class="number">0.776</span>              </span><br><span class="line">Q9   <span class="number">0.504</span>                     </span><br><span class="line">Q10                       <span class="number">0.737</span></span><br><span class="line">Q11               <span class="operator">-</span><span class="number">0.585</span>       </span><br><span class="line">Q12         <span class="number">0.612</span>              </span><br><span class="line">Q13 <span class="operator">-</span><span class="number">0.621</span>                     </span><br><span class="line">Q14                       <span class="number">0.591</span></span><br><span class="line">Q15                <span class="number">0.776</span>       </span><br><span class="line">Q16        <span class="operator">-</span><span class="number">0.613</span>              </span><br><span class="line">Q17  <span class="number">0.807</span>                     </span><br><span class="line">Q18                       <span class="number">0.831</span></span><br><span class="line">Q19               <span class="operator">-</span><span class="number">0.432</span>       </span><br><span class="line">Q20         <span class="number">0.757</span>              </span><br><span class="line">Q21 <span class="operator">-</span><span class="number">0.722</span>                     </span><br><span class="line">Q23                <span class="number">0.477</span>       </span><br><span class="line">Q24         <span class="number">0.423</span>              </span><br><span class="line">Q25  <span class="number">0.629</span>                     </span><br><span class="line">Q26                       <span class="number">0.620</span></span><br><span class="line">Q27               <span class="operator">-</span><span class="number">0.598</span>       </span><br><span class="line">Q29  <span class="number">0.539</span>                     </span><br><span class="line">Q30                       <span class="number">0.467</span></span><br><span class="line">Q31                <span class="number">0.662</span>       </span><br><span class="line">Q32         <span class="number">0.673</span>              </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612091441304.png" alt="4因素探索性因素分析"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 因素相关矩阵</span></span><br><span class="line">efa_4_pa2<span class="operator">$</span>score.cor</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> efa_4_pa2<span class="operator">$</span>score.cor</span><br><span class="line">           <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span>       <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span>       <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span>       <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="number">1.0000000</span> <span class="operator">-</span><span class="number">0.1472319</span>  <span class="number">0.2644861</span> <span class="operator">-</span><span class="number">0.4064475</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">0.1472319</span>  <span class="number">1.0000000</span> <span class="operator">-</span><span class="number">0.1725307</span>  <span class="number">0.1851080</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="number">0.2644861</span> <span class="operator">-</span><span class="number">0.1725307</span>  <span class="number">1.0000000</span> <span class="operator">-</span><span class="number">0.1787275</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">0.4064475</span>  <span class="number">0.1851080</span> <span class="operator">-</span><span class="number">0.1787275</span>  <span class="number">1.0000000</span></span><br></pre></td></tr></table></figure>
<p>可以根据每个因素下的题目的意义给因素命名</p>
<h1>CFA</h1>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>semPlot<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/8第八章 验证性因素分析/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;./8_1.dat&quot;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> na.strings <span class="operator">=</span> <span class="string">&quot;NA&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="数据介绍">数据介绍</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># library(psych)</span></span><br><span class="line"><span class="comment"># describe(data)</span></span><br></pre></td></tr></table></figure>
<p>后三列数据分别是被试编码、被试年龄以及性别</p>
<h2 id="探索性因素分析">探索性因素分析</h2>
<h3 id="第一次CFA">第一次CFA</h3>
<p>模型识别：待估计的参数数量t=11(因素载荷)+11(误差项方差)+1(两个因素的相关)=23 &lt; (模型协方差矩阵的元素数)<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>q</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{q(q+1)}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> = 66</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义CFA模型1</span></span><br><span class="line">model1 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 定义潜变量 verbal_IQ</span></span><br><span class="line"><span class="string">  verbal_IQ =~ V1 + V2 + V3 + V4 + V5 + V6</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 定义潜变量 Performance_IQ</span></span><br><span class="line"><span class="string">  Performance_IQ =~ V7 + V8 + V9 + V10 + V11</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 显式请求截距</span></span><br><span class="line"><span class="string">  V1 ~1</span></span><br><span class="line"><span class="string">  V2 ~1</span></span><br><span class="line"><span class="string">  V3 ~1</span></span><br><span class="line"><span class="string">  V4 ~1</span></span><br><span class="line"><span class="string">  V5 ~1</span></span><br><span class="line"><span class="string">  V6 ~1</span></span><br><span class="line"><span class="string">  V7 ~1</span></span><br><span class="line"><span class="string">  V8 ~1</span></span><br><span class="line"><span class="string">  V9 ~1</span></span><br><span class="line"><span class="string">  V10 ~1</span></span><br><span class="line"><span class="string">  V11 ~1</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行CFA模型</span></span><br><span class="line">fit1 <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model1<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">summary<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修正指数结果</span></span><br><span class="line">modificationIndices<span class="punctuation">(</span>fit1<span class="punctuation">,</span> sort <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> minimum.value <span class="operator">=</span> <span class="number">4.0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">semPaths<span class="punctuation">(</span>fit1<span class="punctuation">,</span> whatLabels<span class="operator">=</span><span class="string">&quot;est&quot;</span><span class="punctuation">,</span> layout<span class="operator">=</span><span class="string">&quot;tree&quot;</span><span class="punctuation">,</span> edge.label.cex<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">,</span> node.label.cex<span class="operator">=</span><span class="number">0.9</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>模型拟合结果</p>
<p><strong>卡方值</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                <span class="number">70.640</span></span><br><span class="line">  Degrees of freedom                                <span class="number">43</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.005</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">519.204</span></span><br><span class="line">  Degrees of freedom                                <span class="number">55</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br></pre></td></tr></table></figure>
<p><strong>似然值与信息标准指数</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>              <span class="operator">-</span><span class="number">4491.822</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>      <span class="operator">-</span><span class="number">4456.502</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                                <span class="number">9051.643</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                              <span class="number">9159.246</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>       <span class="number">9051.579</span></span><br></pre></td></tr></table></figure>
<p><strong>相对拟合指数(比较拟合指数CFI、非标准拟合指数TLI)与绝对拟合指数(近似误差均方根RMSEA)</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.940</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.924</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.061</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.033</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.085</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.233</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.103</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.054</span></span><br></pre></td></tr></table></figure>
<p>模型的<code>RMSEA</code>为0.061小于0.08，<code>CFI</code>为0.940，<code>TLI</code>为0.924，均大于0.9，表明模型拟合结果良好。</p>
<p>模型原始估计结果</p>
<p>因素载荷结果的估计值、标准误差、z分数以及统计显著性检验结果，方差标准化的结果<code>Std.all</code></p>
<p>默认采用固定因素载荷为1的方法设定潜变量的量尺，<mark>采用每个潜变量的第一个观测变量的因素载荷为1</mark></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Latent Variables<span class="operator">:</span></span><br><span class="line">                    Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  verbal_IQ <span class="operator">=</span><span class="operator">~</span>                                                           </span><br><span class="line">    V1                 <span class="number">1.000</span>                               <span class="number">2.206</span>    <span class="number">0.760</span></span><br><span class="line">    V2                 <span class="number">0.926</span>    <span class="number">0.108</span>    <span class="number">8.609</span>    <span class="number">0.000</span>    <span class="number">2.042</span>    <span class="number">0.691</span></span><br><span class="line">    V3                 <span class="number">0.589</span>    <span class="number">0.084</span>    <span class="number">7.013</span>    <span class="number">0.000</span>    <span class="number">1.300</span>    <span class="number">0.565</span></span><br><span class="line">    V4                 <span class="number">1.012</span>    <span class="number">0.115</span>    <span class="number">8.764</span>    <span class="number">0.000</span>    <span class="number">2.232</span>    <span class="number">0.703</span></span><br><span class="line">    V5                 <span class="number">1.020</span>    <span class="number">0.107</span>    <span class="number">9.548</span>    <span class="number">0.000</span>    <span class="number">2.250</span>    <span class="number">0.770</span></span><br><span class="line">    V6                 <span class="number">0.477</span>    <span class="number">0.099</span>    <span class="number">4.805</span>    <span class="number">0.000</span>    <span class="number">1.053</span>    <span class="number">0.390</span></span><br><span class="line">  Performance_IQ <span class="operator">=</span><span class="operator">~</span>                                                      </span><br><span class="line">    V7                 <span class="number">1.000</span>                               <span class="number">1.742</span>    <span class="number">0.595</span></span><br><span class="line">    V8                 <span class="number">0.719</span>    <span class="number">0.156</span>    <span class="number">4.614</span>    <span class="number">0.000</span>    <span class="number">1.253</span>    <span class="number">0.473</span></span><br><span class="line">    V9                 <span class="number">1.060</span>    <span class="number">0.187</span>    <span class="number">5.675</span>    <span class="number">0.000</span>    <span class="number">1.846</span>    <span class="number">0.683</span></span><br><span class="line">    V10                <span class="number">0.921</span>    <span class="number">0.177</span>    <span class="number">5.215</span>    <span class="number">0.000</span>    <span class="number">1.605</span>    <span class="number">0.566</span></span><br><span class="line">    V11                <span class="number">0.119</span>    <span class="number">0.147</span>    <span class="number">0.810</span>    <span class="number">0.418</span>    <span class="number">0.207</span>    <span class="number">0.072</span></span><br></pre></td></tr></table></figure>
<p>可以看出，<code>X11</code>在潜变量<code>F2</code>上的标准化因素载荷仅为0.072，且没有达到显著水平</p>
<p>潜变量的相关的估计值、标准误差、z分数以及统计显著性检验结果，方差标准化的结果<code>Std.all</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Covariances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  verbal_IQ <span class="operator">~</span><span class="operator">~</span>                                                          </span><br><span class="line">    Performance_IQ    <span class="number">2.263</span>    <span class="number">0.515</span>    <span class="number">4.397</span>    <span class="number">0.000</span>    <span class="number">0.589</span>    <span class="number">0.589</span></span><br></pre></td></tr></table></figure>
<p>截距的估计值、标准误差、z分数以及统计显著性检验结果，方差标准化的结果<code>Std.all</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Intercepts<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V1                <span class="number">9.497</span>    <span class="number">0.220</span>   <span class="number">43.264</span>    <span class="number">0.000</span>    <span class="number">9.497</span>    <span class="number">3.270</span></span><br><span class="line">   .V2               <span class="number">10.000</span>    <span class="number">0.224</span>   <span class="number">44.740</span>    <span class="number">0.000</span>   <span class="number">10.000</span>    <span class="number">3.382</span></span><br><span class="line">   .V3                <span class="number">9.000</span>    <span class="number">0.174</span>   <span class="number">51.758</span>    <span class="number">0.000</span>    <span class="number">9.000</span>    <span class="number">3.913</span></span><br><span class="line">   .V4               <span class="number">10.611</span>    <span class="number">0.240</span>   <span class="number">44.220</span>    <span class="number">0.000</span>   <span class="number">10.611</span>    <span class="number">3.343</span></span><br><span class="line">   .V5               <span class="number">10.703</span>    <span class="number">0.221</span>   <span class="number">48.416</span>    <span class="number">0.000</span>   <span class="number">10.703</span>    <span class="number">3.660</span></span><br><span class="line">   .V6                <span class="number">8.731</span>    <span class="number">0.204</span>   <span class="number">42.837</span>    <span class="number">0.000</span>    <span class="number">8.731</span>    <span class="number">3.238</span></span><br><span class="line">   .V7               <span class="number">10.680</span>    <span class="number">0.221</span>   <span class="number">48.288</span>    <span class="number">0.000</span>   <span class="number">10.680</span>    <span class="number">3.650</span></span><br><span class="line">   .V8               <span class="number">10.371</span>    <span class="number">0.200</span>   <span class="number">51.734</span>    <span class="number">0.000</span>   <span class="number">10.371</span>    <span class="number">3.911</span></span><br><span class="line">   .V9               <span class="number">10.314</span>    <span class="number">0.204</span>   <span class="number">50.496</span>    <span class="number">0.000</span>   <span class="number">10.314</span>    <span class="number">3.817</span></span><br><span class="line">   .V10              <span class="number">10.903</span>    <span class="number">0.214</span>   <span class="number">50.860</span>    <span class="number">0.000</span>   <span class="number">10.903</span>    <span class="number">3.845</span></span><br><span class="line">   .V11               <span class="number">8.549</span>    <span class="number">0.216</span>   <span class="number">39.487</span>    <span class="number">0.000</span>    <span class="number">8.549</span>    <span class="number">2.985</span></span><br></pre></td></tr></table></figure>
<p>误差的方差与潜变量的方差的估计值、标准误差、z分数以及统计显著性检验结果，方差标准化的结果<code>Std.all</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V1                <span class="number">3.566</span>    <span class="number">0.507</span>    <span class="number">7.034</span>    <span class="number">0.000</span>    <span class="number">3.566</span>    <span class="number">0.423</span></span><br><span class="line">   .V2                <span class="number">4.572</span>    <span class="number">0.585</span>    <span class="number">7.815</span>    <span class="number">0.000</span>    <span class="number">4.572</span>    <span class="number">0.523</span></span><br><span class="line">   .V3                <span class="number">3.602</span>    <span class="number">0.420</span>    <span class="number">8.571</span>    <span class="number">0.000</span>    <span class="number">3.602</span>    <span class="number">0.681</span></span><br><span class="line">   .V4                <span class="number">5.096</span>    <span class="number">0.662</span>    <span class="number">7.702</span>    <span class="number">0.000</span>    <span class="number">5.096</span>    <span class="number">0.506</span></span><br><span class="line">   .V5                <span class="number">3.487</span>    <span class="number">0.506</span>    <span class="number">6.886</span>    <span class="number">0.000</span>    <span class="number">3.487</span>    <span class="number">0.408</span></span><br><span class="line">   .V6                <span class="number">6.162</span>    <span class="number">0.680</span>    <span class="number">9.056</span>    <span class="number">0.000</span>    <span class="number">6.162</span>    <span class="number">0.848</span></span><br><span class="line">   .V7                <span class="number">5.526</span>    <span class="number">0.757</span>    <span class="number">7.296</span>    <span class="number">0.000</span>    <span class="number">5.526</span>    <span class="number">0.646</span></span><br><span class="line">   .V8                <span class="number">5.463</span>    <span class="number">0.658</span>    <span class="number">8.298</span>    <span class="number">0.000</span>    <span class="number">5.463</span>    <span class="number">0.777</span></span><br><span class="line">   .V9                <span class="number">3.894</span>    <span class="number">0.640</span>    <span class="number">6.083</span>    <span class="number">0.000</span>    <span class="number">3.894</span>    <span class="number">0.533</span></span><br><span class="line">   .V10               <span class="number">5.467</span>    <span class="number">0.719</span>    <span class="number">7.600</span>    <span class="number">0.000</span>    <span class="number">5.467</span>    <span class="number">0.680</span></span><br><span class="line">   .V11               <span class="number">8.159</span>    <span class="number">0.874</span>    <span class="number">9.335</span>    <span class="number">0.000</span>    <span class="number">8.159</span>    <span class="number">0.995</span></span><br><span class="line">    verbal_IQ         <span class="number">4.867</span>    <span class="number">0.883</span>    <span class="number">5.514</span>    <span class="number">0.000</span>    <span class="number">1.000</span>    <span class="number">1.000</span></span><br><span class="line">    Performance_IQ    <span class="number">3.035</span>    <span class="number">0.844</span>    <span class="number">3.593</span>    <span class="number">0.000</span>    <span class="number">1.000</span>    <span class="number">1.000</span></span><br></pre></td></tr></table></figure>
<p><strong>R<sup>2</sup>结果</strong></p>
<p>R<sup>2</sup>结果为每道题标准化因素载荷的平凡，描述了题目信度的高低</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    V1                <span class="number">0.577</span></span><br><span class="line">    V2                <span class="number">0.477</span></span><br><span class="line">    V3                <span class="number">0.319</span></span><br><span class="line">    V4                <span class="number">0.494</span></span><br><span class="line">    V5                <span class="number">0.592</span></span><br><span class="line">    V6                <span class="number">0.152</span></span><br><span class="line">    V7                <span class="number">0.354</span></span><br><span class="line">    V8                <span class="number">0.223</span></span><br><span class="line">    V9                <span class="number">0.467</span></span><br><span class="line">    V10               <span class="number">0.320</span></span><br><span class="line">    V11               <span class="number">0.005</span></span><br></pre></td></tr></table></figure>
<p><strong>修正指数结果</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修正指数结果</span></span><br><span class="line">modificationIndices<span class="punctuation">(</span>fit1<span class="punctuation">,</span> sort <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> minimum.value <span class="operator">=</span> <span class="number">4.0</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>修正指数结果部分呈现了所有可能路径的修正指数值<code>mi</code>、自由估计该参数时可能的估计值<code>epc</code>、使用连续潜变量的方差标准化的估计值<code>sepc.lv</code>、使用连续潜变量及背景变量和结果变量的方差进行标准化的估计值<code>sepc.all</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">              lhs op rhs    mi    epc sepc.lv sepc.all sepc.nox</span><br><span class="line"><span class="number">45</span> Performance_IQ <span class="operator">=</span><span class="operator">~</span>  V2 <span class="number">9.823</span>  <span class="number">0.538</span>   <span class="number">0.937</span>    <span class="number">0.317</span>    <span class="number">0.317</span></span><br><span class="line"><span class="number">75</span>             V3 <span class="operator">~</span><span class="operator">~</span> V10 <span class="number">6.362</span> <span class="operator">-</span><span class="number">0.945</span>  <span class="operator">-</span><span class="number">0.945</span>   <span class="operator">-</span><span class="number">0.213</span>   <span class="operator">-</span><span class="number">0.213</span></span><br><span class="line"><span class="number">50</span>             V1 <span class="operator">~</span><span class="operator">~</span>  V2 <span class="number">5.221</span> <span class="operator">-</span><span class="number">0.985</span>  <span class="operator">-</span><span class="number">0.985</span>   <span class="operator">-</span><span class="number">0.244</span>   <span class="operator">-</span><span class="number">0.244</span></span><br><span class="line"><span class="number">94</span>             V6 <span class="operator">~</span><span class="operator">~</span> V11 <span class="number">4.927</span>  <span class="number">1.207</span>   <span class="number">1.207</span>    <span class="number">0.170</span>    <span class="number">0.170</span></span><br><span class="line"><span class="number">64</span>             V2 <span class="operator">~</span><span class="operator">~</span>  V7 <span class="number">4.685</span>  <span class="number">0.969</span>   <span class="number">0.969</span>    <span class="number">0.193</span>    <span class="number">0.193</span></span><br><span class="line"><span class="number">98</span>             V7 <span class="operator">~</span><span class="operator">~</span> V11 <span class="number">4.575</span> <span class="operator">-</span><span class="number">1.225</span>  <span class="operator">-</span><span class="number">1.225</span>   <span class="operator">-</span><span class="number">0.182</span>   <span class="operator">-</span><span class="number">0.182</span></span><br><span class="line"><span class="number">44</span> Performance_IQ <span class="operator">=</span><span class="operator">~</span>  V1 <span class="number">4.477</span> <span class="operator">-</span><span class="number">0.342</span>  <span class="operator">-</span><span class="number">0.596</span>   <span class="operator">-</span><span class="number">0.205</span>   <span class="operator">-</span><span class="number">0.205</span></span><br><span class="line"><span class="number">53</span>             V1 <span class="operator">~</span><span class="operator">~</span>  V5 <span class="number">4.403</span>  <span class="number">0.912</span>   <span class="number">0.912</span>    <span class="number">0.259</span>    <span class="number">0.259</span></span><br><span class="line"><span class="number">86</span>             V5 <span class="operator">~</span><span class="operator">~</span>  V8 <span class="number">4.146</span> <span class="operator">-</span><span class="number">0.798</span>  <span class="operator">-</span><span class="number">0.798</span>   <span class="operator">-</span><span class="number">0.183</span>   <span class="operator">-</span><span class="number">0.183</span></span><br><span class="line"><span class="number">51</span>             V1 <span class="operator">~</span><span class="operator">~</span>  V3 <span class="number">4.133</span>  <span class="number">0.697</span>   <span class="number">0.697</span>    <span class="number">0.194</span>    <span class="number">0.194</span></span><br></pre></td></tr></table></figure>
<p>看出<code>V2</code>可能测量了<code>Performance_IQ</code>这个因素</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240617184624483.png" alt="第一次CFA"></p>
<h3 id="修正后的第二次CFA">修正后的第二次CFA</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修正模型</span></span><br><span class="line">model2 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 定义潜变量 verbal_IQ</span></span><br><span class="line"><span class="string">  verbal_IQ =~ V1 + V2 + V3 + V4 + V5 + V6</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 定义潜变量 Performance_IQ</span></span><br><span class="line"><span class="string">  Performance_IQ =~ V2 + V7 + V8 + V9 + V10 + V11</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 显式请求截距</span></span><br><span class="line"><span class="string">  V1 ~1</span></span><br><span class="line"><span class="string">  V2 ~1</span></span><br><span class="line"><span class="string">  V3 ~1</span></span><br><span class="line"><span class="string">  V4 ~1</span></span><br><span class="line"><span class="string">  V5 ~1</span></span><br><span class="line"><span class="string">  V6 ~1</span></span><br><span class="line"><span class="string">  V7 ~1</span></span><br><span class="line"><span class="string">  V8 ~1</span></span><br><span class="line"><span class="string">  V9 ~1</span></span><br><span class="line"><span class="string">  V10 ~1</span></span><br><span class="line"><span class="string">  V11 ~1</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line">fit2 <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model2<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit2<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">semPaths<span class="punctuation">(</span>fit2<span class="punctuation">,</span> whatLabels<span class="operator">=</span><span class="string">&quot;est&quot;</span><span class="punctuation">,</span> layout<span class="operator">=</span><span class="string">&quot;tree&quot;</span><span class="punctuation">,</span> edge.label.cex<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">,</span> node.label.cex<span class="operator">=</span><span class="number">0.9</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                <span class="number">60.642</span></span><br><span class="line">  Degrees of freedom                                <span class="number">42</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.031</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">519.204</span></span><br><span class="line">  Degrees of freedom                                <span class="number">55</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.960</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.947</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>              <span class="operator">-</span><span class="number">4486.823</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>      <span class="operator">-</span><span class="number">4456.502</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                                <span class="number">9043.645</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                              <span class="number">9154.413</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>       <span class="number">9043.579</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.050</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.016</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.077</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.465</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.031</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.050</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">Latent Variables<span class="operator">:</span></span><br><span class="line">                    Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  verbal_IQ <span class="operator">=</span><span class="operator">~</span>                                                           </span><br><span class="line">    V1                 <span class="number">1.000</span>                               <span class="number">2.256</span>    <span class="number">0.777</span></span><br><span class="line">    V2                 <span class="number">0.661</span>    <span class="number">0.118</span>    <span class="number">5.606</span>    <span class="number">0.000</span>    <span class="number">1.491</span>    <span class="number">0.504</span></span><br><span class="line">    V3                 <span class="number">0.579</span>    <span class="number">0.082</span>    <span class="number">7.101</span>    <span class="number">0.000</span>    <span class="number">1.307</span>    <span class="number">0.568</span></span><br><span class="line">    V4                 <span class="number">0.977</span>    <span class="number">0.112</span>    <span class="number">8.751</span>    <span class="number">0.000</span>    <span class="number">2.205</span>    <span class="number">0.695</span></span><br><span class="line">    V5                 <span class="number">1.008</span>    <span class="number">0.103</span>    <span class="number">9.739</span>    <span class="number">0.000</span>    <span class="number">2.273</span>    <span class="number">0.777</span></span><br><span class="line">    V6                 <span class="number">0.476</span>    <span class="number">0.097</span>    <span class="number">4.918</span>    <span class="number">0.000</span>    <span class="number">1.075</span>    <span class="number">0.399</span></span><br><span class="line">  Performance_IQ <span class="operator">=</span><span class="operator">~</span>                                                      </span><br><span class="line">    V2                 <span class="number">1.000</span>                               <span class="number">0.884</span>    <span class="number">0.299</span></span><br><span class="line">    V7                 <span class="number">2.024</span>    <span class="number">0.657</span>    <span class="number">3.080</span>    <span class="number">0.002</span>    <span class="number">1.790</span>    <span class="number">0.612</span></span><br><span class="line">    V8                 <span class="number">1.345</span>    <span class="number">0.470</span>    <span class="number">2.862</span>    <span class="number">0.004</span>    <span class="number">1.189</span>    <span class="number">0.448</span></span><br><span class="line">    V9                 <span class="number">2.062</span>    <span class="number">0.662</span>    <span class="number">3.112</span>    <span class="number">0.002</span>    <span class="number">1.823</span>    <span class="number">0.675</span></span><br><span class="line">    V10                <span class="number">1.847</span>    <span class="number">0.606</span>    <span class="number">3.048</span>    <span class="number">0.002</span>    <span class="number">1.633</span>    <span class="number">0.576</span></span><br><span class="line">    V11                <span class="number">0.227</span>    <span class="number">0.294</span>    <span class="number">0.772</span>    <span class="number">0.440</span>    <span class="number">0.200</span>    <span class="number">0.070</span></span><br><span class="line"></span><br><span class="line">Covariances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  verbal_IQ <span class="operator">~</span><span class="operator">~</span>                                                          </span><br><span class="line">    Performance_IQ    <span class="number">1.064</span>    <span class="number">0.380</span>    <span class="number">2.795</span>    <span class="number">0.005</span>    <span class="number">0.533</span>    <span class="number">0.533</span></span><br><span class="line"></span><br><span class="line">Intercepts<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V1                <span class="number">9.497</span>    <span class="number">0.220</span>   <span class="number">43.264</span>    <span class="number">0.000</span>    <span class="number">9.497</span>    <span class="number">3.270</span></span><br><span class="line">   .V2               <span class="number">10.000</span>    <span class="number">0.224</span>   <span class="number">44.740</span>    <span class="number">0.000</span>   <span class="number">10.000</span>    <span class="number">3.382</span></span><br><span class="line">   .V3                <span class="number">9.000</span>    <span class="number">0.174</span>   <span class="number">51.758</span>    <span class="number">0.000</span>    <span class="number">9.000</span>    <span class="number">3.913</span></span><br><span class="line">   .V4               <span class="number">10.611</span>    <span class="number">0.240</span>   <span class="number">44.220</span>    <span class="number">0.000</span>   <span class="number">10.611</span>    <span class="number">3.343</span></span><br><span class="line">   .V5               <span class="number">10.703</span>    <span class="number">0.221</span>   <span class="number">48.416</span>    <span class="number">0.000</span>   <span class="number">10.703</span>    <span class="number">3.660</span></span><br><span class="line">   .V6                <span class="number">8.731</span>    <span class="number">0.204</span>   <span class="number">42.837</span>    <span class="number">0.000</span>    <span class="number">8.731</span>    <span class="number">3.238</span></span><br><span class="line">   .V7               <span class="number">10.680</span>    <span class="number">0.221</span>   <span class="number">48.288</span>    <span class="number">0.000</span>   <span class="number">10.680</span>    <span class="number">3.650</span></span><br><span class="line">   .V8               <span class="number">10.371</span>    <span class="number">0.200</span>   <span class="number">51.734</span>    <span class="number">0.000</span>   <span class="number">10.371</span>    <span class="number">3.911</span></span><br><span class="line">   .V9               <span class="number">10.314</span>    <span class="number">0.204</span>   <span class="number">50.496</span>    <span class="number">0.000</span>   <span class="number">10.314</span>    <span class="number">3.817</span></span><br><span class="line">   .V10              <span class="number">10.903</span>    <span class="number">0.214</span>   <span class="number">50.860</span>    <span class="number">0.000</span>   <span class="number">10.903</span>    <span class="number">3.845</span></span><br><span class="line">   .V11               <span class="number">8.549</span>    <span class="number">0.216</span>   <span class="number">39.487</span>    <span class="number">0.000</span>    <span class="number">8.549</span>    <span class="number">2.985</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V1                <span class="number">3.343</span>    <span class="number">0.502</span>    <span class="number">6.665</span>    <span class="number">0.000</span>    <span class="number">3.343</span>    <span class="number">0.396</span></span><br><span class="line">   .V2                <span class="number">4.331</span>    <span class="number">0.554</span>    <span class="number">7.819</span>    <span class="number">0.000</span>    <span class="number">4.331</span>    <span class="number">0.495</span></span><br><span class="line">   .V3                <span class="number">3.584</span>    <span class="number">0.420</span>    <span class="number">8.533</span>    <span class="number">0.000</span>    <span class="number">3.584</span>    <span class="number">0.677</span></span><br><span class="line">   .V4                <span class="number">5.217</span>    <span class="number">0.675</span>    <span class="number">7.726</span>    <span class="number">0.000</span>    <span class="number">5.217</span>    <span class="number">0.518</span></span><br><span class="line">   .V5                <span class="number">3.383</span>    <span class="number">0.508</span>    <span class="number">6.655</span>    <span class="number">0.000</span>    <span class="number">3.383</span>    <span class="number">0.396</span></span><br><span class="line">   .V6                <span class="number">6.116</span>    <span class="number">0.677</span>    <span class="number">9.032</span>    <span class="number">0.000</span>    <span class="number">6.116</span>    <span class="number">0.841</span></span><br><span class="line">   .V7                <span class="number">5.358</span>    <span class="number">0.741</span>    <span class="number">7.231</span>    <span class="number">0.000</span>    <span class="number">5.358</span>    <span class="number">0.626</span></span><br><span class="line">   .V8                <span class="number">5.620</span>    <span class="number">0.663</span>    <span class="number">8.480</span>    <span class="number">0.000</span>    <span class="number">5.620</span>    <span class="number">0.799</span></span><br><span class="line">   .V9                <span class="number">3.979</span>    <span class="number">0.623</span>    <span class="number">6.385</span>    <span class="number">0.000</span>    <span class="number">3.979</span>    <span class="number">0.545</span></span><br><span class="line">   .V10               <span class="number">5.376</span>    <span class="number">0.707</span>    <span class="number">7.603</span>    <span class="number">0.000</span>    <span class="number">5.376</span>    <span class="number">0.668</span></span><br><span class="line">   .V11               <span class="number">8.162</span>    <span class="number">0.874</span>    <span class="number">9.337</span>    <span class="number">0.000</span>    <span class="number">8.162</span>    <span class="number">0.995</span></span><br><span class="line">    verbal_IQ         <span class="number">5.090</span>    <span class="number">0.899</span>    <span class="number">5.659</span>    <span class="number">0.000</span>    <span class="number">1.000</span>    <span class="number">1.000</span></span><br><span class="line">    Performance_IQ    <span class="number">0.782</span>    <span class="number">0.470</span>    <span class="number">1.662</span>    <span class="number">0.097</span>    <span class="number">1.000</span>    <span class="number">1.000</span></span><br><span class="line"></span><br><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    V1                <span class="number">0.604</span></span><br><span class="line">    V2                <span class="number">0.505</span></span><br><span class="line">    V3                <span class="number">0.323</span></span><br><span class="line">    V4                <span class="number">0.482</span></span><br><span class="line">    V5                <span class="number">0.604</span></span><br><span class="line">    V6                <span class="number">0.159</span></span><br><span class="line">    V7                <span class="number">0.374</span></span><br><span class="line">    V8                <span class="number">0.201</span></span><br><span class="line">    V9                <span class="number">0.455</span></span><br><span class="line">    V10               <span class="number">0.332</span></span><br><span class="line">    V11               <span class="number">0.005</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以看出<code>X11</code>的因素载荷是不显著的，且标准化的载荷值只有0.070。可以考虑删除<code>X11</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240617184716153.png" alt="修正后的第二次CFA"></p>
<p><strong>比较模型拟合指数</strong></p>
<p>模型2是在模型1的基础上增加了参数，两个模型呈嵌套关系，可以进行拟合程度比较。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anova<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">     Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span>   </span><br><span class="line">fit2 <span class="number">42</span> <span class="number">9043.6</span> <span class="number">9154.4</span> <span class="number">60.642</span>                                         </span><br><span class="line">fit1 <span class="number">43</span> <span class="number">9051.6</span> <span class="number">9159.2</span> <span class="number">70.640</span>      <span class="number">9.998</span> <span class="number">0.22675</span>       <span class="number">1</span>   <span class="number">0.001567</span> <span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为9.998，自由度的差值为1，表明两个模型的差异显著。模型二的拟合指数AIC、BIC、RMSEA、CFI、TLI优于模型1。</p>
<h3 id="修正后的第三次CFA">修正后的第三次CFA</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修正模型</span></span><br><span class="line">model3 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 定义潜变量 verbal_IQ</span></span><br><span class="line"><span class="string">  verbal_IQ =~ V1 + V2 + V3 + V4 + V5 + V6</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 定义潜变量 Performance_IQ</span></span><br><span class="line"><span class="string">  Performance_IQ =~ V2 + V7 + V8 + V9 + V10</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 显式请求截距</span></span><br><span class="line"><span class="string">  V1 ~1</span></span><br><span class="line"><span class="string">  V2 ~1</span></span><br><span class="line"><span class="string">  V3 ~1</span></span><br><span class="line"><span class="string">  V4 ~1</span></span><br><span class="line"><span class="string">  V5 ~1</span></span><br><span class="line"><span class="string">  V6 ~1</span></span><br><span class="line"><span class="string">  V7 ~1</span></span><br><span class="line"><span class="string">  V8 ~1</span></span><br><span class="line"><span class="string">  V9 ~1</span></span><br><span class="line"><span class="string">  V10 ~1</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line">fit3 <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit3<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建可视化</span></span><br><span class="line">semPaths<span class="punctuation">(</span>fit3<span class="punctuation">,</span> whatLabels<span class="operator">=</span><span class="string">&quot;est&quot;</span><span class="punctuation">,</span> layout<span class="operator">=</span><span class="string">&quot;tree&quot;</span><span class="punctuation">,</span> edge.label.cex<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">,</span> node.label.cex<span class="operator">=</span><span class="number">0.9</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                <span class="number">45.276</span></span><br><span class="line">  Degrees of freedom                                <span class="number">33</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.075</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">503.222</span></span><br><span class="line">  Degrees of freedom                                <span class="number">45</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.973</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.963</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>              <span class="operator">-</span><span class="number">4054.684</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>      <span class="operator">-</span><span class="number">4032.046</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                                <span class="number">8173.368</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                              <span class="number">8274.642</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>       <span class="number">8173.308</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.046</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.077</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.549</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.033</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.045</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">Latent Variables<span class="operator">:</span></span><br><span class="line">                    Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  verbal_IQ <span class="operator">=</span><span class="operator">~</span>                                                           </span><br><span class="line">    V1                 <span class="number">1.000</span>                               <span class="number">2.256</span>    <span class="number">0.777</span></span><br><span class="line">    V2                 <span class="number">0.661</span>    <span class="number">0.118</span>    <span class="number">5.608</span>    <span class="number">0.000</span>    <span class="number">1.491</span>    <span class="number">0.504</span></span><br><span class="line">    V3                 <span class="number">0.579</span>    <span class="number">0.082</span>    <span class="number">7.099</span>    <span class="number">0.000</span>    <span class="number">1.306</span>    <span class="number">0.568</span></span><br><span class="line">    V4                 <span class="number">0.977</span>    <span class="number">0.112</span>    <span class="number">8.755</span>    <span class="number">0.000</span>    <span class="number">2.206</span>    <span class="number">0.695</span></span><br><span class="line">    V5                 <span class="number">1.007</span>    <span class="number">0.103</span>    <span class="number">9.738</span>    <span class="number">0.000</span>    <span class="number">2.273</span>    <span class="number">0.777</span></span><br><span class="line">    V6                 <span class="number">0.476</span>    <span class="number">0.097</span>    <span class="number">4.916</span>    <span class="number">0.000</span>    <span class="number">1.074</span>    <span class="number">0.398</span></span><br><span class="line">  Performance_IQ <span class="operator">=</span><span class="operator">~</span>                                                      </span><br><span class="line">    V2                 <span class="number">1.000</span>                               <span class="number">0.885</span>    <span class="number">0.299</span></span><br><span class="line">    V7                 <span class="number">2.041</span>    <span class="number">0.661</span>    <span class="number">3.088</span>    <span class="number">0.002</span>    <span class="number">1.807</span>    <span class="number">0.618</span></span><br><span class="line">    V8                 <span class="number">1.340</span>    <span class="number">0.468</span>    <span class="number">2.863</span>    <span class="number">0.004</span>    <span class="number">1.186</span>    <span class="number">0.447</span></span><br><span class="line">    V9                 <span class="number">2.045</span>    <span class="number">0.657</span>    <span class="number">3.114</span>    <span class="number">0.002</span>    <span class="number">1.811</span>    <span class="number">0.670</span></span><br><span class="line">    V10                <span class="number">1.843</span>    <span class="number">0.604</span>    <span class="number">3.051</span>    <span class="number">0.002</span>    <span class="number">1.632</span>    <span class="number">0.575</span></span><br><span class="line"></span><br><span class="line">Covariances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  verbal_IQ <span class="operator">~</span><span class="operator">~</span>                                                          </span><br><span class="line">    Performance_IQ    <span class="number">1.064</span>    <span class="number">0.381</span>    <span class="number">2.797</span>    <span class="number">0.005</span>    <span class="number">0.533</span>    <span class="number">0.533</span></span><br><span class="line"></span><br><span class="line">Intercepts<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V1                <span class="number">9.497</span>    <span class="number">0.220</span>   <span class="number">43.264</span>    <span class="number">0.000</span>    <span class="number">9.497</span>    <span class="number">3.270</span></span><br><span class="line">   .V2               <span class="number">10.000</span>    <span class="number">0.224</span>   <span class="number">44.740</span>    <span class="number">0.000</span>   <span class="number">10.000</span>    <span class="number">3.382</span></span><br><span class="line">   .V3                <span class="number">9.000</span>    <span class="number">0.174</span>   <span class="number">51.758</span>    <span class="number">0.000</span>    <span class="number">9.000</span>    <span class="number">3.913</span></span><br><span class="line">   .V4               <span class="number">10.611</span>    <span class="number">0.240</span>   <span class="number">44.220</span>    <span class="number">0.000</span>   <span class="number">10.611</span>    <span class="number">3.343</span></span><br><span class="line">   .V5               <span class="number">10.703</span>    <span class="number">0.221</span>   <span class="number">48.416</span>    <span class="number">0.000</span>   <span class="number">10.703</span>    <span class="number">3.660</span></span><br><span class="line">   .V6                <span class="number">8.731</span>    <span class="number">0.204</span>   <span class="number">42.837</span>    <span class="number">0.000</span>    <span class="number">8.731</span>    <span class="number">3.238</span></span><br><span class="line">   .V7               <span class="number">10.680</span>    <span class="number">0.221</span>   <span class="number">48.288</span>    <span class="number">0.000</span>   <span class="number">10.680</span>    <span class="number">3.650</span></span><br><span class="line">   .V8               <span class="number">10.371</span>    <span class="number">0.200</span>   <span class="number">51.734</span>    <span class="number">0.000</span>   <span class="number">10.371</span>    <span class="number">3.911</span></span><br><span class="line">   .V9               <span class="number">10.314</span>    <span class="number">0.204</span>   <span class="number">50.496</span>    <span class="number">0.000</span>   <span class="number">10.314</span>    <span class="number">3.817</span></span><br><span class="line">   .V10              <span class="number">10.903</span>    <span class="number">0.214</span>   <span class="number">50.860</span>    <span class="number">0.000</span>   <span class="number">10.903</span>    <span class="number">3.845</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V1                <span class="number">3.342</span>    <span class="number">0.502</span>    <span class="number">6.662</span>    <span class="number">0.000</span>    <span class="number">3.342</span>    <span class="number">0.396</span></span><br><span class="line">   .V2                <span class="number">4.329</span>    <span class="number">0.554</span>    <span class="number">7.815</span>    <span class="number">0.000</span>    <span class="number">4.329</span>    <span class="number">0.495</span></span><br><span class="line">   .V3                <span class="number">3.585</span>    <span class="number">0.420</span>    <span class="number">8.534</span>    <span class="number">0.000</span>    <span class="number">3.585</span>    <span class="number">0.677</span></span><br><span class="line">   .V4                <span class="number">5.213</span>    <span class="number">0.675</span>    <span class="number">7.724</span>    <span class="number">0.000</span>    <span class="number">5.213</span>    <span class="number">0.517</span></span><br><span class="line">   .V5                <span class="number">3.385</span>    <span class="number">0.508</span>    <span class="number">6.658</span>    <span class="number">0.000</span>    <span class="number">3.385</span>    <span class="number">0.396</span></span><br><span class="line">   .V6                <span class="number">6.117</span>    <span class="number">0.677</span>    <span class="number">9.032</span>    <span class="number">0.000</span>    <span class="number">6.117</span>    <span class="number">0.841</span></span><br><span class="line">   .V7                <span class="number">5.295</span>    <span class="number">0.740</span>    <span class="number">7.156</span>    <span class="number">0.000</span>    <span class="number">5.295</span>    <span class="number">0.619</span></span><br><span class="line">   .V8                <span class="number">5.626</span>    <span class="number">0.663</span>    <span class="number">8.482</span>    <span class="number">0.000</span>    <span class="number">5.626</span>    <span class="number">0.800</span></span><br><span class="line">   .V9                <span class="number">4.022</span>    <span class="number">0.624</span>    <span class="number">6.445</span>    <span class="number">0.000</span>    <span class="number">4.022</span>    <span class="number">0.551</span></span><br><span class="line">   .V10               <span class="number">5.379</span>    <span class="number">0.708</span>    <span class="number">7.602</span>    <span class="number">0.000</span>    <span class="number">5.379</span>    <span class="number">0.669</span></span><br><span class="line">    verbal_IQ         <span class="number">5.091</span>    <span class="number">0.899</span>    <span class="number">5.660</span>    <span class="number">0.000</span>    <span class="number">1.000</span>    <span class="number">1.000</span></span><br><span class="line">    Performance_IQ    <span class="number">0.784</span>    <span class="number">0.471</span>    <span class="number">1.665</span>    <span class="number">0.096</span>    <span class="number">1.000</span>    <span class="number">1.000</span></span><br><span class="line"></span><br><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    V1                <span class="number">0.604</span></span><br><span class="line">    V2                <span class="number">0.505</span></span><br><span class="line">    V3                <span class="number">0.323</span></span><br><span class="line">    V4                <span class="number">0.483</span></span><br><span class="line">    V5                <span class="number">0.604</span></span><br><span class="line">    V6                <span class="number">0.159</span></span><br><span class="line">    V7                <span class="number">0.381</span></span><br><span class="line">    V8                <span class="number">0.200</span></span><br><span class="line">    V9                <span class="number">0.449</span></span><br><span class="line">    V10               <span class="number">0.331</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240617184858323.png" alt="修正后的第三次CFA"></p>
<p><strong>比较模型拟合指数</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">     Df    AIC    BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span>   </span><br><span class="line">fit3 <span class="number">33</span> <span class="number">8173.4</span> <span class="number">8274.6</span> <span class="number">45.276</span>                                          </span><br><span class="line">fit2 <span class="number">42</span> <span class="number">9043.6</span> <span class="number">9154.4</span> <span class="number">60.642</span>     <span class="number">15.365</span> <span class="number">0.063572</span>       <span class="number">9</span>   <span class="number">0.081379</span> . </span><br><span class="line">fit1 <span class="number">43</span> <span class="number">9051.6</span> <span class="number">9159.2</span> <span class="number">70.640</span>      <span class="number">9.998</span> <span class="number">0.226753</span>       <span class="number">1</span>   <span class="number">0.001567</span> <span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>模型三与模型二保焊的变量不同，不具有嵌套关系。只需要参考拟合指数AIC、BIC、RMSEA、CFI、TLI，表明模型三优于模型二。</p>
<h2 id="等价性检验">等价性检验</h2>
<p>对不同性别的测验等价性进行检验</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">analysis_data_withgender<span class="operator">$</span>V14 <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>analysis_data_withgender<span class="operator">$</span>V14<span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;male&quot;</span><span class="punctuation">,</span> <span class="string">&quot;female&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看性别分布</span></span><br><span class="line">table<span class="punctuation">(</span>analysis_data_withgender<span class="operator">$</span>V14<span class="punctuation">)</span>  </span><br></pre></td></tr></table></figure>
<p>使用最终确定的模型三作为等价性检验模型</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">model3 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 定义潜变量 verbal_</span></span><br><span class="line"><span class="string">IQ</span></span><br><span class="line"><span class="string">  verbal_IQ =~ V1 + V2 + V3 + V4 + V5 + V6</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 定义潜变量 Performance_IQ</span></span><br><span class="line"><span class="string">  Performance_IQ =~ V2 + V7 + V8 + V9 + V10</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 显式请求截距</span></span><br><span class="line"><span class="string">  V1 ~1</span></span><br><span class="line"><span class="string">  V2 ~1</span></span><br><span class="line"><span class="string">  V3 ~1</span></span><br><span class="line"><span class="string">  V4 ~1</span></span><br><span class="line"><span class="string">  V5 ~1</span></span><br><span class="line"><span class="string">  V6 ~1</span></span><br><span class="line"><span class="string">  V7 ~1</span></span><br><span class="line"><span class="string">  V8 ~1</span></span><br><span class="line"><span class="string">  V9 ~1</span></span><br><span class="line"><span class="string">  V10 ~1</span></span><br><span class="line"><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="不同性别分别拟合模型">不同性别分别拟合模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分别提取男性和女性的数据</span></span><br><span class="line">data_male <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>data<span class="punctuation">,</span> V14 <span class="operator">==</span> <span class="string">&quot;male&quot;</span><span class="punctuation">)</span></span><br><span class="line">data_female <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>data<span class="punctuation">,</span> V14 <span class="operator">==</span> <span class="string">&quot;female&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对男性数据拟合模型</span></span><br><span class="line">fit_male <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data <span class="operator">=</span> data_male<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_male<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对女性数据拟合模型</span></span><br><span class="line">fit_female <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data <span class="operator">=</span> data_female<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_female<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit_male<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.910</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.877</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.081</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.033</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.122</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.121</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.546</span></span><br><span class="line">  </span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit_female<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">1.000</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">1.030</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.058</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.920</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.008</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以看出男生组RMSEA为0.081，CFI值为0.910，TLI值为0.877；女生组RMSEA为0.000，CFI值为1.000，TLI值为1.030，表明两组模型都拟合良好</p>
<h3 id="因素模式相同模型-基线模型">因素模式相同模型(基线模型)</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置等价模型</span></span><br><span class="line">configural_model <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">,</span> group<span class="operator">=</span><span class="string">&quot;V14&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>configural_model<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                <span class="number">79.129</span></span><br><span class="line">  Degrees of freedom                                <span class="number">66</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.129</span></span><br><span class="line">  Test statistic <span class="keyword">for</span> each group<span class="operator">:</span></span><br><span class="line">    female                                      <span class="number">27.457</span></span><br><span class="line">    male                                        <span class="number">51.672</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">548.746</span></span><br><span class="line">  Degrees of freedom                                <span class="number">90</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.971</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.961</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>              <span class="operator">-</span><span class="number">4044.360</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>      <span class="operator">-</span><span class="number">4004.796</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                                <span class="number">8216.720</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                              <span class="number">8419.266</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>       <span class="number">8216.598</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.048</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.083</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.516</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.068</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.057</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以看出<code>RMSEA</code>值为0.048，<code>CFI</code>的值为0.971，<code>TLI</code>的值为0.961，表明模型拟合较好。该模型作为基线模型，用于检验其他等价性条件是否满足。</p>
<h3 id="因素载荷等价模型-弱等价性">因素载荷等价模型(弱等价性)</h3>
<p>不同组的观测变量与对应的潜变量之间的因素载荷的值是相等的</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 度量等价</span></span><br><span class="line">metric_model <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data<span class="operator">=</span>analysis_data_withgender<span class="punctuation">,</span> group<span class="operator">=</span><span class="string">&quot;V14&quot;</span><span class="punctuation">,</span> group.equal<span class="operator">=</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>metric_model<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>configural_model<span class="punctuation">,</span> metric_model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">                 Df    AIC    BIC  Chisq Chisq diff RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">configural_model <span class="number">66</span> <span class="number">8216.7</span> <span class="number">8419.3</span> <span class="number">79.129</span>                                    </span><br><span class="line">metric_model     <span class="number">75</span> <span class="number">8205.9</span> <span class="number">8380.0</span> <span class="number">86.297</span>     <span class="number">7.1688</span>     <span class="number">0</span>       <span class="number">9</span>     <span class="number">0.6196</span></span><br></pre></td></tr></table></figure>
<p>弱等价性模型嵌套于基线模型，可以使用嵌套模型的比较方法。</p>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为7.1688，自由度的差值<code>Df diff</code>为9，表明两个模型的卡方差异不显著。可以接受弱等价模型，即认为不同性别之间满足因素载荷等价条件。</p>
<h3 id="截距等价性模型-强等价性">截距等价性模型(强等价性)</h3>
<p>不同组的观测变量的截距相等</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 截距等价</span></span><br><span class="line">scalar_model <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data<span class="operator">=</span>analysis_data_withgender<span class="punctuation">,</span> group<span class="operator">=</span><span class="string">&quot;V14&quot;</span><span class="punctuation">,</span> group.equal<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>scalar_model<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>configural_model<span class="punctuation">,</span> metric_model<span class="punctuation">,</span> scalar_model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">                 Df    AIC    BIC  Chisq Chisq diff RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">configural_model <span class="number">66</span> <span class="number">8216.7</span> <span class="number">8419.3</span> <span class="number">79.129</span>                                    </span><br><span class="line">metric_model     <span class="number">75</span> <span class="number">8205.9</span> <span class="number">8380.0</span> <span class="number">86.297</span>     <span class="number">7.1688</span>     <span class="number">0</span>       <span class="number">9</span>     <span class="number">0.6196</span></span><br><span class="line">scalar_model     <span class="number">83</span> <span class="number">8193.3</span> <span class="number">8342.0</span> <span class="number">89.687</span>     <span class="number">3.3898</span>     <span class="number">0</span>       <span class="number">8</span>     <span class="number">0.9076</span></span><br></pre></td></tr></table></figure>
<p>强等价性模型嵌套于弱等价性模型，可以使用嵌套模型的比较方法。</p>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为3.3898，自由度的差值<code>Df diff</code>为8，表明两个模型的卡方差异不显著。可以接受强等价模型，即认为不同性别之间满足截距等价条件。</p>
<h3 id="误差方差等价模型">误差方差等价模型</h3>
<p>假定来自不同组的误差方差相等</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 误差方差等价</span></span><br><span class="line">error_variance_model <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data<span class="operator">=</span>analysis_data_withgender<span class="punctuation">,</span> group<span class="operator">=</span><span class="string">&quot;V14&quot;</span><span class="punctuation">,</span> group.equal<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>error_variance_model<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>configural_model<span class="punctuation">,</span> metric_model<span class="punctuation">,</span> scalar_model<span class="punctuation">,</span> error_variance_model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">                     Df    AIC    BIC  Chisq Chisq diff RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">configural_model     <span class="number">66</span> <span class="number">8216.7</span> <span class="number">8419.3</span> <span class="number">79.129</span>                                    </span><br><span class="line">metric_model         <span class="number">75</span> <span class="number">8205.9</span> <span class="number">8380.0</span> <span class="number">86.297</span>     <span class="number">7.1688</span>     <span class="number">0</span>       <span class="number">9</span>     <span class="number">0.6196</span></span><br><span class="line">scalar_model         <span class="number">83</span> <span class="number">8193.3</span> <span class="number">8342.0</span> <span class="number">89.687</span>     <span class="number">3.3898</span>     <span class="number">0</span>       <span class="number">8</span>     <span class="number">0.9076</span></span><br><span class="line">error_variance_model <span class="number">93</span> <span class="number">8178.4</span> <span class="number">8295.5</span> <span class="number">94.812</span>     <span class="number">5.1252</span>     <span class="number">0</span>      <span class="number">10</span>     <span class="number">0.8827</span></span><br></pre></td></tr></table></figure>
<p>误差方差等价模型嵌套于强等价性模型，可以使用嵌套模型的比较方法。</p>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为5.1252，自由度的差值<code>Df diff</code>为10，表明两个模型的卡方差异不显著。可以接受误差方差等价模型，即认为不同性别之间满足误差方差等价条件。</p>
<h3 id="潜变量方差等价模型">潜变量方差等价模型</h3>
<p>假定来自不同组的误差方差相等，不同组的误差协方差相等</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 潜变量方差等价</span></span><br><span class="line">latent_variance_model <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data<span class="operator">=</span>analysis_data_withgender<span class="punctuation">,</span> group<span class="operator">=</span><span class="string">&quot;V14&quot;</span><span class="punctuation">,</span> group.equal<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.variances&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>latent_variance_model<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>configural_model<span class="punctuation">,</span> metric_model<span class="punctuation">,</span> scalar_model<span class="punctuation">,</span> error_variance_model<span class="punctuation">,</span> latent_variance_model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">                      Df    AIC    BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">configural_model      <span class="number">66</span> <span class="number">8216.7</span> <span class="number">8419.3</span> <span class="number">79.129</span>                                       </span><br><span class="line">metric_model          <span class="number">75</span> <span class="number">8205.9</span> <span class="number">8380.0</span> <span class="number">86.297</span>     <span class="number">7.1688</span> <span class="number">0.000000</span>       <span class="number">9</span>     <span class="number">0.6196</span></span><br><span class="line">scalar_model          <span class="number">83</span> <span class="number">8193.3</span> <span class="number">8342.0</span> <span class="number">89.687</span>     <span class="number">3.3898</span> <span class="number">0.000000</span>       <span class="number">8</span>     <span class="number">0.9076</span></span><br><span class="line">error_variance_model  <span class="number">93</span> <span class="number">8178.4</span> <span class="number">8295.5</span> <span class="number">94.812</span>     <span class="number">5.1252</span> <span class="number">0.000000</span>      <span class="number">10</span>     <span class="number">0.8827</span></span><br><span class="line">latent_variance_model <span class="number">95</span> <span class="number">8177.7</span> <span class="number">8288.5</span> <span class="number">98.131</span>     <span class="number">3.3185</span> <span class="number">0.086801</span>       <span class="number">2</span>     <span class="number">0.1903</span></span><br></pre></td></tr></table></figure>
<p>潜变量方差等价模型嵌套于误差方差等价模型，可以使用嵌套模型的比较方法。</p>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为3.3185，自由度的差值<code>Df diff</code>为2，表明两个模型的卡方差异不显著。可以接受潜变量方差等价模型，即认为不同性别之间满足潜变量方差等价条件。</p>
<h3 id="潜变量协方差矩阵等价模型">潜变量协方差矩阵等价模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 潜变量协方差等价</span></span><br><span class="line">latent_covariance_model <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data<span class="operator">=</span>analysis_data_withgender<span class="punctuation">,</span> group<span class="operator">=</span><span class="string">&quot;V14&quot;</span><span class="punctuation">,</span> group.equal<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.variances&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.covariances&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>latent_covariance_model<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>configural_model<span class="punctuation">,</span> metric_model<span class="punctuation">,</span> scalar_model<span class="punctuation">,</span> error_variance_model<span class="punctuation">,</span> latent_variance_model<span class="punctuation">,</span> latent_covariance_model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">                        Df    AIC    BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">configural_model        <span class="number">66</span> <span class="number">8216.7</span> <span class="number">8419.3</span> <span class="number">79.129</span>                                       </span><br><span class="line">metric_model            <span class="number">75</span> <span class="number">8205.9</span> <span class="number">8380.0</span> <span class="number">86.297</span>     <span class="number">7.1688</span> <span class="number">0.000000</span>       <span class="number">9</span>     <span class="number">0.6196</span></span><br><span class="line">scalar_model            <span class="number">83</span> <span class="number">8193.3</span> <span class="number">8342.0</span> <span class="number">89.687</span>     <span class="number">3.3898</span> <span class="number">0.000000</span>       <span class="number">8</span>     <span class="number">0.9076</span></span><br><span class="line">error_variance_model    <span class="number">93</span> <span class="number">8178.4</span> <span class="number">8295.5</span> <span class="number">94.812</span>     <span class="number">5.1252</span> <span class="number">0.000000</span>      <span class="number">10</span>     <span class="number">0.8827</span></span><br><span class="line">latent_variance_model   <span class="number">95</span> <span class="number">8177.7</span> <span class="number">8288.5</span> <span class="number">98.131</span>     <span class="number">3.3185</span> <span class="number">0.086801</span>       <span class="number">2</span>     <span class="number">0.1903</span></span><br><span class="line">latent_covariance_model <span class="number">96</span> <span class="number">8176.8</span> <span class="number">8284.4</span> <span class="number">99.187</span>     <span class="number">1.0564</span> <span class="number">0.025385</span>       <span class="number">1</span>     <span class="number">0.3040</span></span><br></pre></td></tr></table></figure>
<p>潜变量协方差等价模型嵌套于潜变量方差等价模型，可以使用嵌套模型的比较方法。</p>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为1.0564，自由度的差值<code>Df diff</code>为1，表明两个模型的卡方差异不显著。可以接受潜变量协方差等价模型，即认为不同性别之间满足潜变量协方差等价条件。</p>
<h3 id="潜变量的均值等价模型">潜变量的均值等价模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 潜变量均值等价</span></span><br><span class="line">latent_mean_model <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model3<span class="punctuation">,</span> data<span class="operator">=</span>analysis_data_withgender<span class="punctuation">,</span> group<span class="operator">=</span><span class="string">&quot;V14&quot;</span><span class="punctuation">,</span> group.equal<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.variances&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.covariances&quot;</span><span class="punctuation">,</span> <span class="string">&quot;means&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>latent_mean_model<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>configural_model<span class="punctuation">,</span> metric_model<span class="punctuation">,</span> scalar_model<span class="punctuation">,</span> error_variance_model<span class="punctuation">,</span> latent_variance_model<span class="punctuation">,</span> latent_covariance_model<span class="punctuation">,</span> latent_mean_model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">                        Df    AIC    BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">configural_model        <span class="number">66</span> <span class="number">8216.7</span> <span class="number">8419.3</span> <span class="number">79.129</span>                                       </span><br><span class="line">metric_model            <span class="number">75</span> <span class="number">8205.9</span> <span class="number">8380.0</span> <span class="number">86.297</span>     <span class="number">7.1688</span> <span class="number">0.000000</span>       <span class="number">9</span>     <span class="number">0.6196</span></span><br><span class="line">scalar_model            <span class="number">83</span> <span class="number">8193.3</span> <span class="number">8342.0</span> <span class="number">89.687</span>     <span class="number">3.3898</span> <span class="number">0.000000</span>       <span class="number">8</span>     <span class="number">0.9076</span></span><br><span class="line">error_variance_model    <span class="number">93</span> <span class="number">8178.4</span> <span class="number">8295.5</span> <span class="number">94.812</span>     <span class="number">5.1252</span> <span class="number">0.000000</span>      <span class="number">10</span>     <span class="number">0.8827</span></span><br><span class="line">latent_variance_model   <span class="number">95</span> <span class="number">8177.7</span> <span class="number">8288.5</span> <span class="number">98.131</span>     <span class="number">3.3185</span> <span class="number">0.086801</span>       <span class="number">2</span>     <span class="number">0.1903</span></span><br><span class="line">latent_covariance_model <span class="number">96</span> <span class="number">8176.8</span> <span class="number">8284.4</span> <span class="number">99.187</span>     <span class="number">1.0564</span> <span class="number">0.025385</span>       <span class="number">1</span>     <span class="number">0.3040</span></span><br><span class="line">latent_mean_model       <span class="number">98</span> <span class="number">8173.4</span> <span class="number">8274.6</span> <span class="number">99.777</span>     <span class="number">0.5901</span> <span class="number">0.000000</span>       <span class="number">2</span>     <span class="number">0.7445</span></span><br></pre></td></tr></table></figure>
<p>潜变量均值等价模型嵌套于潜变量协方差等价，可以使用嵌套模型的比较方法。</p>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为0.5901，自由度的差值<code>Df diff</code>为2，表明两个模型的卡方差异不显著。可以接受潜变量均值等价模型，即认为不同性别之间满足潜变量均值等价条件。</p>
<h1>路径分析</h1>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>tidySEM<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/9第九章 路径分析/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;./9_1_dataPA.dat&quot;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> na.strings <span class="operator">=</span> <span class="string">&quot;NA&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="数据介绍-2">数据介绍</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># describe(data)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算相关系数矩阵</span></span><br><span class="line">cor_matrix <span class="operator">&lt;-</span> cor<span class="punctuation">(</span>data<span class="punctuation">,</span> use<span class="operator">=</span><span class="string">&quot;complete.obs&quot;</span><span class="punctuation">)</span></span><br><span class="line">cor.plot<span class="punctuation">(</span>cor_matrix<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612130509210.png" alt="相关矩阵"></p>
<h2 id="饱和的递归模型">饱和的递归模型</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义模型</span></span><br><span class="line">model1 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 因果关系</span></span><br><span class="line"><span class="string">  V3 ~ V1 + V2</span></span><br><span class="line"><span class="string">  V4 ~ V1 + V2 + V3</span></span><br><span class="line"><span class="string">  V5 ~ V1 + V2 + V3 + V4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 协方差</span></span><br><span class="line"><span class="string">  V1 ~~ V2 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 指定残差</span></span><br><span class="line"><span class="string">  V3 ~~ V3</span></span><br><span class="line"><span class="string">  V4 ~~ V4</span></span><br><span class="line"><span class="string">  V5 ~~ V5</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 显式请求截距</span></span><br><span class="line"><span class="string">  V3 ~1</span></span><br><span class="line"><span class="string">  V4 ~1</span></span><br><span class="line"><span class="string">  V5 ~1</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拟合模型</span></span><br><span class="line">fit1 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model1<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">layout_matrix <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> <span class="built_in">dimnames</span> <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="literal">NULL</span><span class="punctuation">,</span> <span class="literal">NULL</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V4&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V5&quot;</span></span><br><span class="line">graph_sem<span class="punctuation">(</span>fit1<span class="punctuation">,</span> layout <span class="operator">=</span> layout_matrix<span class="punctuation">,</span> text_size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240617190449340.png" alt="饱和递归模型"></p>
<p>模型拟合结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                 <span class="number">0.000</span></span><br><span class="line">  Degrees of freedom                                 <span class="number">0</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">165.893</span></span><br><span class="line">  Degrees of freedom                                <span class="number">10</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">1.000</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">1.000</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>              <span class="operator">-</span><span class="number">9938.865</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>      <span class="operator">-</span><span class="number">9938.865</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                               <span class="number">19907.729</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                             <span class="number">19966.553</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>      <span class="number">19918.962</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.000</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                       <span class="literal">NA</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                       <span class="literal">NA</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.000</span></span><br></pre></td></tr></table></figure>
<p>参数估计结果与标准化参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  V3 <span class="operator">~</span>                                                                  </span><br><span class="line">    V1                <span class="number">0.217</span>    <span class="number">0.026</span>    <span class="number">8.260</span>    <span class="number">0.000</span>    <span class="number">0.217</span>    <span class="number">0.392</span></span><br><span class="line">    V2                <span class="number">0.079</span>    <span class="number">0.046</span>    <span class="number">1.721</span>    <span class="number">0.085</span>    <span class="number">0.079</span>    <span class="number">0.082</span></span><br><span class="line">  V4 <span class="operator">~</span>                                                                  </span><br><span class="line">    V1               <span class="operator">-</span><span class="number">0.014</span>    <span class="number">0.055</span>   <span class="operator">-</span><span class="number">0.261</span>    <span class="number">0.794</span>   <span class="operator">-</span><span class="number">0.014</span>   <span class="operator">-</span><span class="number">0.014</span></span><br><span class="line">    V2               <span class="operator">-</span><span class="number">0.393</span>    <span class="number">0.089</span>   <span class="operator">-</span><span class="number">4.433</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.393</span>   <span class="operator">-</span><span class="number">0.223</span></span><br><span class="line">    V3               <span class="operator">-</span><span class="number">0.198</span>    <span class="number">0.099</span>   <span class="operator">-</span><span class="number">1.995</span>    <span class="number">0.046</span>   <span class="operator">-</span><span class="number">0.198</span>   <span class="operator">-</span><span class="number">0.109</span></span><br><span class="line">  V5 <span class="operator">~</span>                                                                  </span><br><span class="line">    V1                <span class="number">0.032</span>    <span class="number">0.048</span>    <span class="number">0.663</span>    <span class="number">0.507</span>    <span class="number">0.032</span>    <span class="number">0.034</span></span><br><span class="line">    V2               <span class="operator">-</span><span class="number">0.122</span>    <span class="number">0.079</span>   <span class="operator">-</span><span class="number">1.533</span>    <span class="number">0.125</span>   <span class="operator">-</span><span class="number">0.122</span>   <span class="operator">-</span><span class="number">0.074</span></span><br><span class="line">    V3               <span class="operator">-</span><span class="number">0.442</span>    <span class="number">0.087</span>   <span class="operator">-</span><span class="number">5.071</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.442</span>   <span class="operator">-</span><span class="number">0.260</span></span><br><span class="line">    V4                <span class="number">0.271</span>    <span class="number">0.045</span>    <span class="number">6.005</span>    <span class="number">0.000</span>    <span class="number">0.271</span>    <span class="number">0.291</span></span><br><span class="line"></span><br><span class="line">Covariances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  V1 <span class="operator">~</span><span class="operator">~</span>                                                                 </span><br><span class="line">    V2              <span class="operator">-</span><span class="number">75.607</span>  <span class="number">130.551</span>   <span class="operator">-</span><span class="number">0.579</span>    <span class="number">0.562</span>  <span class="operator">-</span><span class="number">75.607</span>   <span class="operator">-</span><span class="number">0.030</span></span><br><span class="line"></span><br><span class="line">Intercepts<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V3               <span class="number">58.217</span>    <span class="number">2.050</span>   <span class="number">28.399</span>    <span class="number">0.000</span>   <span class="number">58.217</span>    <span class="number">1.584</span></span><br><span class="line">   .V4               <span class="number">18.685</span>    <span class="number">6.993</span>    <span class="number">2.672</span>    <span class="number">0.008</span>   <span class="number">18.685</span>    <span class="number">0.279</span></span><br><span class="line">   .V5              <span class="number">743.742</span>    <span class="number">6.158</span>  <span class="number">120.772</span>    <span class="number">0.000</span>  <span class="number">743.742</span>   <span class="number">11.916</span></span><br><span class="line">    V1               <span class="number">40.900</span>    <span class="number">3.439</span>   <span class="number">11.894</span>    <span class="number">0.000</span>   <span class="number">40.900</span>    <span class="number">0.616</span></span><br><span class="line">    V2                <span class="number">0.000</span>    <span class="number">1.965</span>    <span class="number">0.000</span>    <span class="number">1.000</span>    <span class="number">0.000</span>    <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V3             <span class="number">1136.158</span>   <span class="number">83.195</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">1136.158</span>    <span class="number">0.841</span></span><br><span class="line">   .V4             <span class="number">4181.001</span>  <span class="number">306.155</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">4181.001</span>    <span class="number">0.934</span></span><br><span class="line">   .V5             <span class="number">3181.454</span>  <span class="number">232.963</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">3181.454</span>    <span class="number">0.817</span></span><br><span class="line">    V1             <span class="number">4410.394</span>  <span class="number">322.952</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">4410.394</span>    <span class="number">1.000</span></span><br><span class="line">    V2             <span class="number">1440.129</span>  <span class="number">105.454</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">1440.129</span>    <span class="number">1.000</span></span><br></pre></td></tr></table></figure>
<p>可以看出<code>V1</code> ~ <code>V4</code>、<code>V2</code> ~ <code>V3</code>、<code>V1</code> ~ <code>V5</code>、<code>V2</code> ~ <code>V5</code>路径不显著，可以考虑后续模型修正。</p>
<p>间接因果效应计算</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算间接效应</span></span><br><span class="line">model2 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 因果关系</span></span><br><span class="line"><span class="string">  V3 ~ c1*V1 + c2*V2</span></span><br><span class="line"><span class="string">  V4 ~ b1*V1 + b2*V2 + b3*V3</span></span><br><span class="line"><span class="string">  V5 ~ a1*V1 + a2*V2 + a3*V3 + a4*V4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 协方差</span></span><br><span class="line"><span class="string">  V1 ~~ V2 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 指定残差</span></span><br><span class="line"><span class="string">  V3 ~~ e3*V3</span></span><br><span class="line"><span class="string">  V4 ~~ e4*V4</span></span><br><span class="line"><span class="string">  V5 ~~ e5*V5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 显式请求截距</span></span><br><span class="line"><span class="string">  V3 ~1</span></span><br><span class="line"><span class="string">  V4 ~1</span></span><br><span class="line"><span class="string">  V5 ~1</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 计算间接效应</span></span><br><span class="line"><span class="string">  # 间接效应: V1到V4通过V3</span></span><br><span class="line"><span class="string">  ind_V1_V4 := c1 * b3</span></span><br><span class="line"><span class="string">  # 间接效应: V1到V5通过V3和V4</span></span><br><span class="line"><span class="string">  ind_V1_V5 := a4 * (ind_V1_V4 + b1) + a3 * c1</span></span><br><span class="line"><span class="string">  # 间接效应: V2到V4通过V3</span></span><br><span class="line"><span class="string">  ind_V2_V4 := c2 * b3</span></span><br><span class="line"><span class="string">  # 间接效应: V2到V5通过V3和V4</span></span><br><span class="line"><span class="string">  ind_V2_V5 := a4 * (ind_V2_V4 + b2) + a3 * c2</span></span><br><span class="line"><span class="string">  # 间接效应: V3到V5通过V4</span></span><br><span class="line"><span class="string">  ind_V3_V5 := b3 * a4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 计算总效应</span></span><br><span class="line"><span class="string">  # 总效应: V1到V4</span></span><br><span class="line"><span class="string">  total_V1_V4 := b1 + ind_V1_V4</span></span><br><span class="line"><span class="string">  # 总效应: V1到V5</span></span><br><span class="line"><span class="string">  total_V1_V5 := a1 + ind_V1_V5</span></span><br><span class="line"><span class="string">  # 总效应: V2到V4</span></span><br><span class="line"><span class="string">  total_V2_V4 := b2 + ind_V2_V4</span></span><br><span class="line"><span class="string">  # 总效应: V2到V5</span></span><br><span class="line"><span class="string">  total_V2_V5 := a2 + ind_V2_V5</span></span><br><span class="line"><span class="string">  # 总效应: V3到V5</span></span><br><span class="line"><span class="string">  total_V3_V5 := a3 + ind_V3_V5</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拟合模型</span></span><br><span class="line">fit2 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model2<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit2<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>间接效应与直接效应的估计值与标准化估计值</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Defined Parameters<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">    ind_V1_V4        <span class="operator">-</span><span class="number">0.043</span>    <span class="number">0.022</span>   <span class="operator">-</span><span class="number">1.939</span>    <span class="number">0.052</span>   <span class="operator">-</span><span class="number">0.043</span>   <span class="operator">-</span><span class="number">0.043</span></span><br><span class="line">    ind_V1_V5        <span class="operator">-</span><span class="number">0.112</span>    <span class="number">0.027</span>   <span class="operator">-</span><span class="number">4.181</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.112</span>   <span class="operator">-</span><span class="number">0.119</span></span><br><span class="line">    ind_V2_V4        <span class="operator">-</span><span class="number">0.016</span>    <span class="number">0.012</span>   <span class="operator">-</span><span class="number">1.303</span>    <span class="number">0.192</span>   <span class="operator">-</span><span class="number">0.016</span>   <span class="operator">-</span><span class="number">0.009</span></span><br><span class="line">    ind_V2_V5        <span class="operator">-</span><span class="number">0.146</span>    <span class="number">0.038</span>   <span class="operator">-</span><span class="number">3.822</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.146</span>   <span class="operator">-</span><span class="number">0.089</span></span><br><span class="line">    ind_V3_V5        <span class="operator">-</span><span class="number">0.054</span>    <span class="number">0.028</span>   <span class="operator">-</span><span class="number">1.893</span>    <span class="number">0.058</span>   <span class="operator">-</span><span class="number">0.054</span>   <span class="operator">-</span><span class="number">0.032</span></span><br><span class="line">    total_V1_V4      <span class="operator">-</span><span class="number">0.057</span>    <span class="number">0.051</span>   <span class="operator">-</span><span class="number">1.132</span>    <span class="number">0.258</span>   <span class="operator">-</span><span class="number">0.057</span>   <span class="operator">-</span><span class="number">0.057</span></span><br><span class="line">    total_V1_V5      <span class="operator">-</span><span class="number">0.080</span>    <span class="number">0.048</span>   <span class="operator">-</span><span class="number">1.666</span>    <span class="number">0.096</span>   <span class="operator">-</span><span class="number">0.080</span>   <span class="operator">-</span><span class="number">0.085</span></span><br><span class="line">    total_V2_V4      <span class="operator">-</span><span class="number">0.409</span>    <span class="number">0.089</span>   <span class="operator">-</span><span class="number">4.604</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.409</span>   <span class="operator">-</span><span class="number">0.232</span></span><br><span class="line">    total_V2_V5      <span class="operator">-</span><span class="number">0.267</span>    <span class="number">0.084</span>   <span class="operator">-</span><span class="number">3.191</span>    <span class="number">0.001</span>   <span class="operator">-</span><span class="number">0.267</span>   <span class="operator">-</span><span class="number">0.163</span></span><br><span class="line">    total_V3_V5      <span class="operator">-</span><span class="number">0.496</span>    <span class="number">0.091</span>   <span class="operator">-</span><span class="number">5.461</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.496</span>   <span class="operator">-</span><span class="number">0.292</span></span><br></pre></td></tr></table></figure>
<h2 id="非饱和的递归模型">非饱和的递归模型</h2>
<p>删去<code>V2</code>到<code>V3</code>路径以及<code>V1</code>到<code>V4</code>路径</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 非饱和递归模型</span></span><br><span class="line">model3 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 因果关系</span></span><br><span class="line"><span class="string">  V3 ~ c1*V1</span></span><br><span class="line"><span class="string">  V4 ~ b2*V2 + b3*V3</span></span><br><span class="line"><span class="string">  V5 ~ a1*V1 + a2*V2 + a3*V3 + a4*V4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 协方差</span></span><br><span class="line"><span class="string">  V1 ~~ V2 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 指定残差</span></span><br><span class="line"><span class="string">  V3 ~~ e3*V3</span></span><br><span class="line"><span class="string">  V4 ~~ e4*V4</span></span><br><span class="line"><span class="string">  V5 ~~ e5*V5</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 显式请求截距</span></span><br><span class="line"><span class="string">  V3 ~1</span></span><br><span class="line"><span class="string">  V4 ~1</span></span><br><span class="line"><span class="string">  V5 ~1</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 计算间接效应</span></span><br><span class="line"><span class="string">  # 间接效应: V1到V4通过V3</span></span><br><span class="line"><span class="string">  ind_V1_V4 := c1 * b3</span></span><br><span class="line"><span class="string">  # 间接效应: V1到V5通过V3和V4</span></span><br><span class="line"><span class="string">  ind_V1_V5 := c1 * b3 * a4 + c1 * a3</span></span><br><span class="line"><span class="string">  # 间接效应: V2到V5通过V4</span></span><br><span class="line"><span class="string">  ind_V2_V5 := b2 * a4</span></span><br><span class="line"><span class="string">  # 间接效应: V3到V5通过V4</span></span><br><span class="line"><span class="string">  ind_V3_V5 := b3 * a4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 计算总效应</span></span><br><span class="line"><span class="string">  # 总效应: V1到V5</span></span><br><span class="line"><span class="string">  total_V1_V5 := a1 + ind_V1_V5</span></span><br><span class="line"><span class="string">  # 总效应: V2到V5</span></span><br><span class="line"><span class="string">  total_V2_V5 := a2 + ind_V2_V5</span></span><br><span class="line"><span class="string">  # 总效应: V3到V5</span></span><br><span class="line"><span class="string">  total_V3_V5 := a3 + ind_V3_V5</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line">fit3 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model3<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit3<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> estimates<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">layout_matrix <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> <span class="built_in">dimnames</span> <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="literal">NULL</span><span class="punctuation">,</span> <span class="literal">NULL</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V4&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V5&quot;</span></span><br><span class="line">graph_sem<span class="punctuation">(</span>fit3<span class="punctuation">,</span> layout <span class="operator">=</span> layout_matrix<span class="punctuation">,</span> text_size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240617190654877.png" alt="非饱和递归模型"></p>
<p>模型拟合结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                 <span class="number">3.019</span></span><br><span class="line">  Degrees of freedom                                 <span class="number">2</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.221</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">165.893</span></span><br><span class="line">  Degrees of freedom                                <span class="number">10</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.993</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.967</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>              <span class="operator">-</span><span class="number">9940.374</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>      <span class="operator">-</span><span class="number">9938.865</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                               <span class="number">19916.748</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                             <span class="number">19987.337</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>      <span class="number">19930.228</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.037</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.116</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.493</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.237</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.020</span></span><br></pre></td></tr></table></figure>
<p>参数估计结果与标准化参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  V3 <span class="operator">~</span>                                                                  </span><br><span class="line">    V1        <span class="punctuation">(</span>c1<span class="punctuation">)</span>    <span class="number">0.216</span>    <span class="number">0.026</span>    <span class="number">8.180</span>    <span class="number">0.000</span>    <span class="number">0.216</span>    <span class="number">0.390</span></span><br><span class="line">  V4 <span class="operator">~</span>                                                                  </span><br><span class="line">    V2        <span class="punctuation">(</span>b2<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.391</span>    <span class="number">0.088</span>   <span class="operator">-</span><span class="number">4.436</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.391</span>   <span class="operator">-</span><span class="number">0.222</span></span><br><span class="line">    V3        <span class="punctuation">(</span>b3<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.208</span>    <span class="number">0.091</span>   <span class="operator">-</span><span class="number">2.287</span>    <span class="number">0.022</span>   <span class="operator">-</span><span class="number">0.208</span>   <span class="operator">-</span><span class="number">0.115</span></span><br><span class="line">  V5 <span class="operator">~</span>                                                                  </span><br><span class="line">    V1        <span class="punctuation">(</span>a1<span class="punctuation">)</span>    <span class="number">0.032</span>    <span class="number">0.048</span>    <span class="number">0.664</span>    <span class="number">0.507</span>    <span class="number">0.032</span>    <span class="number">0.034</span></span><br><span class="line">    V2        <span class="punctuation">(</span>a2<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.122</span>    <span class="number">0.079</span>   <span class="operator">-</span><span class="number">1.539</span>    <span class="number">0.124</span>   <span class="operator">-</span><span class="number">0.122</span>   <span class="operator">-</span><span class="number">0.074</span></span><br><span class="line">    V3        <span class="punctuation">(</span>a3<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.442</span>    <span class="number">0.087</span>   <span class="operator">-</span><span class="number">5.088</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.442</span>   <span class="operator">-</span><span class="number">0.261</span></span><br><span class="line">    V4        <span class="punctuation">(</span>a4<span class="punctuation">)</span>    <span class="number">0.271</span>    <span class="number">0.045</span>    <span class="number">6.006</span>    <span class="number">0.000</span>    <span class="number">0.271</span>    <span class="number">0.291</span></span><br><span class="line"></span><br><span class="line">Covariances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  V1 <span class="operator">~</span><span class="operator">~</span>                                                                 </span><br><span class="line">    V2              <span class="operator">-</span><span class="number">75.607</span>  <span class="number">130.551</span>   <span class="operator">-</span><span class="number">0.579</span>    <span class="number">0.562</span>  <span class="operator">-</span><span class="number">75.607</span>   <span class="operator">-</span><span class="number">0.030</span></span><br><span class="line"></span><br><span class="line">Intercepts<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V3               <span class="number">58.273</span>    <span class="number">2.058</span>   <span class="number">28.318</span>    <span class="number">0.000</span>   <span class="number">58.273</span>    <span class="number">1.586</span></span><br><span class="line">   .V4               <span class="number">18.783</span>    <span class="number">6.971</span>    <span class="number">2.695</span>    <span class="number">0.007</span>   <span class="number">18.783</span>    <span class="number">0.281</span></span><br><span class="line">   .V5              <span class="number">743.742</span>    <span class="number">6.146</span>  <span class="number">121.004</span>    <span class="number">0.000</span>  <span class="number">743.742</span>   <span class="number">11.954</span></span><br><span class="line">    V1               <span class="number">40.900</span>    <span class="number">3.439</span>   <span class="number">11.894</span>    <span class="number">0.000</span>   <span class="number">40.900</span>    <span class="number">0.616</span></span><br><span class="line">    V2                <span class="number">0.000</span>    <span class="number">1.965</span>    <span class="number">0.000</span>    <span class="number">1.000</span>    <span class="number">0.000</span>    <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V3        <span class="punctuation">(</span>e3<span class="punctuation">)</span> <span class="number">1145.182</span>   <span class="number">83.856</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">1145.182</span>    <span class="number">0.848</span></span><br><span class="line">   .V4        <span class="punctuation">(</span>e4<span class="punctuation">)</span> <span class="number">4181.767</span>  <span class="number">306.211</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">4181.767</span>    <span class="number">0.938</span></span><br><span class="line">   .V5        <span class="punctuation">(</span>e5<span class="punctuation">)</span> <span class="number">3181.453</span>  <span class="number">232.963</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">3181.453</span>    <span class="number">0.822</span></span><br><span class="line">    V1             <span class="number">4410.394</span>  <span class="number">322.952</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">4410.394</span>    <span class="number">1.000</span></span><br><span class="line">    V2             <span class="number">1440.129</span>  <span class="number">105.454</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">1440.129</span>    <span class="number">1.000</span></span><br><span class="line"></span><br><span class="line">Defined Parameters<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">    ind_V1_V4        <span class="operator">-</span><span class="number">0.045</span>    <span class="number">0.020</span>   <span class="operator">-</span><span class="number">2.203</span>    <span class="number">0.028</span>   <span class="operator">-</span><span class="number">0.045</span>   <span class="operator">-</span><span class="number">0.045</span></span><br><span class="line">    ind_V1_V5        <span class="operator">-</span><span class="number">0.108</span>    <span class="number">0.023</span>   <span class="operator">-</span><span class="number">4.593</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.108</span>   <span class="operator">-</span><span class="number">0.115</span></span><br><span class="line">    ind_V2_V5        <span class="operator">-</span><span class="number">0.106</span>    <span class="number">0.030</span>   <span class="operator">-</span><span class="number">3.568</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.106</span>   <span class="operator">-</span><span class="number">0.065</span></span><br><span class="line">    ind_V3_V5        <span class="operator">-</span><span class="number">0.057</span>    <span class="number">0.026</span>   <span class="operator">-</span><span class="number">2.137</span>    <span class="number">0.033</span>   <span class="operator">-</span><span class="number">0.057</span>   <span class="operator">-</span><span class="number">0.033</span></span><br><span class="line">    total_V1_V5      <span class="operator">-</span><span class="number">0.076</span>    <span class="number">0.046</span>   <span class="operator">-</span><span class="number">1.640</span>    <span class="number">0.101</span>   <span class="operator">-</span><span class="number">0.076</span>   <span class="operator">-</span><span class="number">0.081</span></span><br><span class="line">    total_V2_V5      <span class="operator">-</span><span class="number">0.228</span>    <span class="number">0.081</span>   <span class="operator">-</span><span class="number">2.824</span>    <span class="number">0.005</span>   <span class="operator">-</span><span class="number">0.228</span>   <span class="operator">-</span><span class="number">0.139</span></span><br><span class="line">    total_V3_V5      <span class="operator">-</span><span class="number">0.498</span>    <span class="number">0.090</span>   <span class="operator">-</span><span class="number">5.550</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.498</span>   <span class="operator">-</span><span class="number">0.294</span></span><br></pre></td></tr></table></figure>
<p>可以看出<code>V1</code> ~ <code>V5</code>、<code>V2</code> ~ <code>V5</code>路径不显著，可以考虑后续模型修正。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit2<span class="punctuation">,</span> fit3<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">     Df   AIC   BIC Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit2  <span class="number">0</span> <span class="number">19918</span> <span class="number">19996</span> <span class="number">0.000</span>                                       </span><br><span class="line">fit3  <span class="number">2</span> <span class="number">19917</span> <span class="number">19987</span> <span class="number">3.019</span>     <span class="number">3.0189</span> <span class="number">0.036958</span>       <span class="number">2</span>      <span class="number">0.221</span></span><br></pre></td></tr></table></figure>
<p>非饱和模型的卡方值<code>Chisq</code>为3.019，p值<code>Pr(&gt;Chisq)</code>为0.221，即在0.05水平上不显著</p>
<p>但是RMSEA、CFI、TLI都达到了模型良好拟合的判断标准，而且相比饱和模型的拟合指数相比变化量更小，表明删去路径后非饱和模型能比饱和模型能够更好地拟合数据，统计上可以接受零假设，因此对原饱和模型进行修正，用该非饱和模型进行替代</p>
<p>删去<code>V1</code>到<code>V5</code>路径以及<code>V2</code>到<code>V5</code>路径</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修正模型</span></span><br><span class="line">model4 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 因果关系</span></span><br><span class="line"><span class="string">  V3 ~ c1*V1</span></span><br><span class="line"><span class="string">  V4 ~ b2*V2 + b3*V3</span></span><br><span class="line"><span class="string">  V5 ~ a3*V3 + a4*V4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 协方差</span></span><br><span class="line"><span class="string">  V1 ~~ V2 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 指定残差</span></span><br><span class="line"><span class="string">  V3 ~~ e3*V3</span></span><br><span class="line"><span class="string">  V4 ~~ e4*V4</span></span><br><span class="line"><span class="string">  V5 ~~ e5*V5</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 显式请求截距</span></span><br><span class="line"><span class="string">  V3 ~1</span></span><br><span class="line"><span class="string">  V4 ~1</span></span><br><span class="line"><span class="string">  V5 ~1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 计算间接效应</span></span><br><span class="line"><span class="string">  # 间接效应: V1到V4通过V3</span></span><br><span class="line"><span class="string">  ind_V1_V4 := c1*b3</span></span><br><span class="line"><span class="string">  # 间接效应: V1到V5通过V3和V4</span></span><br><span class="line"><span class="string">  ind_V1_V5 := c1 * b3 * a4 + c1 * a3</span></span><br><span class="line"><span class="string">  # 间接效应: V2到V5通过V4</span></span><br><span class="line"><span class="string">  ind_V2_V5 := b2 * a4</span></span><br><span class="line"><span class="string">  # 间接效应: V3到V5通过V4</span></span><br><span class="line"><span class="string">  ind_V3_V5 := b3 * a4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 计算总效应</span></span><br><span class="line"><span class="string">  # 总效应: V3到V5</span></span><br><span class="line"><span class="string">  total_V3_V5 := a3 + ind_V3_V5</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line">fit4 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model4<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit4<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> estimates<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">layout_matrix <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> <span class="built_in">dimnames</span> <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="literal">NULL</span><span class="punctuation">,</span> <span class="literal">NULL</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V4&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;V5&quot;</span></span><br><span class="line">graph_sem<span class="punctuation">(</span>fit4<span class="punctuation">,</span> layout <span class="operator">=</span> layout_matrix<span class="punctuation">,</span> text_size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240617190814266.png" alt="非饱和模型"></p>
<p>模型拟合结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                 <span class="number">5.938</span></span><br><span class="line">  Degrees of freedom                                 <span class="number">4</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.204</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">165.893</span></span><br><span class="line">  Degrees of freedom                                <span class="number">10</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.988</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.969</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>              <span class="operator">-</span><span class="number">9941.834</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>      <span class="operator">-</span><span class="number">9938.865</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                               <span class="number">19915.667</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                             <span class="number">19978.412</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>      <span class="number">19927.649</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.036</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.092</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.582</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.113</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.029</span></span><br></pre></td></tr></table></figure>
<p>参数估计结果与标准化参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  V3 <span class="operator">~</span>                                                                  </span><br><span class="line">    V1        <span class="punctuation">(</span>c1<span class="punctuation">)</span>    <span class="number">0.216</span>    <span class="number">0.026</span>    <span class="number">8.180</span>    <span class="number">0.000</span>    <span class="number">0.216</span>    <span class="number">0.390</span></span><br><span class="line">  V4 <span class="operator">~</span>                                                                  </span><br><span class="line">    V2        <span class="punctuation">(</span>b2<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.391</span>    <span class="number">0.088</span>   <span class="operator">-</span><span class="number">4.436</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.391</span>   <span class="operator">-</span><span class="number">0.222</span></span><br><span class="line">    V3        <span class="punctuation">(</span>b3<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.208</span>    <span class="number">0.091</span>   <span class="operator">-</span><span class="number">2.287</span>    <span class="number">0.022</span>   <span class="operator">-</span><span class="number">0.208</span>   <span class="operator">-</span><span class="number">0.115</span></span><br><span class="line">  V5 <span class="operator">~</span>                                                                  </span><br><span class="line">    V3        <span class="punctuation">(</span>a3<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.424</span>    <span class="number">0.080</span>   <span class="operator">-</span><span class="number">5.287</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.424</span>   <span class="operator">-</span><span class="number">0.250</span></span><br><span class="line">    V4        <span class="punctuation">(</span>a4<span class="punctuation">)</span>    <span class="number">0.287</span>    <span class="number">0.044</span>    <span class="number">6.489</span>    <span class="number">0.000</span>    <span class="number">0.287</span>    <span class="number">0.307</span></span><br><span class="line"></span><br><span class="line">Covariances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  V1 <span class="operator">~</span><span class="operator">~</span>                                                                 </span><br><span class="line">    V2              <span class="operator">-</span><span class="number">75.607</span>  <span class="number">130.551</span>   <span class="operator">-</span><span class="number">0.579</span>    <span class="number">0.562</span>  <span class="operator">-</span><span class="number">75.607</span>   <span class="operator">-</span><span class="number">0.030</span></span><br><span class="line"></span><br><span class="line">Intercepts<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V3               <span class="number">58.273</span>    <span class="number">2.058</span>   <span class="number">28.318</span>    <span class="number">0.000</span>   <span class="number">58.273</span>    <span class="number">1.586</span></span><br><span class="line">   .V4               <span class="number">18.783</span>    <span class="number">6.971</span>    <span class="number">2.695</span>    <span class="number">0.007</span>   <span class="number">18.783</span>    <span class="number">0.281</span></span><br><span class="line">   .V5              <span class="number">743.808</span>    <span class="number">6.158</span>  <span class="number">120.790</span>    <span class="number">0.000</span>  <span class="number">743.808</span>   <span class="number">11.936</span></span><br><span class="line">    V1               <span class="number">40.900</span>    <span class="number">3.439</span>   <span class="number">11.894</span>    <span class="number">0.000</span>   <span class="number">40.900</span>    <span class="number">0.616</span></span><br><span class="line">    V2                <span class="number">0.000</span>    <span class="number">1.965</span>    <span class="number">0.000</span>    <span class="number">1.000</span>    <span class="number">0.000</span>    <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .V3        <span class="punctuation">(</span>e3<span class="punctuation">)</span> <span class="number">1145.182</span>   <span class="number">83.856</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">1145.182</span>    <span class="number">0.848</span></span><br><span class="line">   .V4        <span class="punctuation">(</span>e4<span class="punctuation">)</span> <span class="number">4181.767</span>  <span class="number">306.211</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">4181.767</span>    <span class="number">0.938</span></span><br><span class="line">   .V5        <span class="punctuation">(</span>e5<span class="punctuation">)</span> <span class="number">3206.449</span>  <span class="number">234.793</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">3206.449</span>    <span class="number">0.826</span></span><br><span class="line">    V1             <span class="number">4410.394</span>  <span class="number">322.952</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">4410.394</span>    <span class="number">1.000</span></span><br><span class="line">    V2             <span class="number">1440.129</span>  <span class="number">105.454</span>   <span class="number">13.657</span>    <span class="number">0.000</span> <span class="number">1440.129</span>    <span class="number">1.000</span></span><br><span class="line"></span><br><span class="line">Defined Parameters<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">    ind_V1_V4        <span class="operator">-</span><span class="number">0.045</span>    <span class="number">0.020</span>   <span class="operator">-</span><span class="number">2.203</span>    <span class="number">0.028</span>   <span class="operator">-</span><span class="number">0.045</span>   <span class="operator">-</span><span class="number">0.045</span></span><br><span class="line">    ind_V1_V5        <span class="operator">-</span><span class="number">0.105</span>    <span class="number">0.022</span>   <span class="operator">-</span><span class="number">4.714</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.105</span>   <span class="operator">-</span><span class="number">0.111</span></span><br><span class="line">    ind_V2_V5        <span class="operator">-</span><span class="number">0.112</span>    <span class="number">0.031</span>   <span class="operator">-</span><span class="number">3.662</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.112</span>   <span class="operator">-</span><span class="number">0.068</span></span><br><span class="line">    ind_V3_V5        <span class="operator">-</span><span class="number">0.060</span>    <span class="number">0.028</span>   <span class="operator">-</span><span class="number">2.157</span>    <span class="number">0.031</span>   <span class="operator">-</span><span class="number">0.060</span>   <span class="operator">-</span><span class="number">0.035</span></span><br><span class="line">    total_V3_V5      <span class="operator">-</span><span class="number">0.484</span>    <span class="number">0.084</span>   <span class="operator">-</span><span class="number">5.768</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.484</span>   <span class="operator">-</span><span class="number">0.286</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit2<span class="punctuation">,</span> fit3<span class="punctuation">,</span> fit4<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">     Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit2  <span class="number">0</span> <span class="number">19918</span> <span class="number">19996</span> <span class="number">0.0000</span>                                       </span><br><span class="line">fit3  <span class="number">2</span> <span class="number">19917</span> <span class="number">19987</span> <span class="number">3.0190</span>     <span class="number">3.0189</span> <span class="number">0.036958</span>       <span class="number">2</span>     <span class="number">0.2210</span></span><br><span class="line">fit4  <span class="number">4</span> <span class="number">19916</span> <span class="number">19978</span> <span class="number">5.9377</span>     <span class="number">2.9188</span> <span class="number">0.035094</span>       <span class="number">2</span>     <span class="number">0.2324</span></span><br></pre></td></tr></table></figure>
<h1>结构方程模型</h1>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>tidySEM<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/10第十章 结构方程模型/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;./10_1.dat&quot;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> na.strings <span class="operator">=</span> <span class="string">&quot;NA&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="数据介绍-3">数据介绍</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据名称</span></span><br><span class="line"><span class="comment"># work1 -- V1</span></span><br><span class="line"><span class="comment"># work2 -- V2</span></span><br><span class="line"><span class="comment"># ee1 -- V3</span></span><br><span class="line"><span class="comment"># ee2 -- V4</span></span><br><span class="line"><span class="comment"># ee3 -- V5</span></span><br><span class="line"><span class="comment"># dpl1 -- V6</span></span><br><span class="line"><span class="comment"># dpl2 -- V7</span></span><br><span class="line"><span class="comment"># pa1 -- V8</span></span><br><span class="line"><span class="comment"># pa2 -- V9</span></span><br><span class="line"><span class="comment"># pa3 -- V10</span></span><br><span class="line"><span class="comment"># Gender -- V11</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重命名数据集中的变量</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;work1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;work2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ee1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ee2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ee3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;dpl1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;dpl2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;pa1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;pa2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;pa3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Gender&quot;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="operator">$</span>Gender <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>data<span class="operator">$</span>Gender<span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;male&quot;</span><span class="punctuation">,</span> <span class="string">&quot;female&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">table<span class="punctuation">(</span>data<span class="operator">$</span>Gender<span class="punctuation">)</span>  <span class="comment"># 查看性别分布</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="结构方程模型">结构方程模型</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义模型</span></span><br><span class="line">model <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 测量模型</span></span><br><span class="line"><span class="string">  EE =~ ee1 + ee2 + ee3       # EE 由 ee1, ee2, ee3 测量</span></span><br><span class="line"><span class="string">  D =~ dpl1 + dpl2            # D 由 dpl1, dpl2 测量</span></span><br><span class="line"><span class="string">  PA =~ pa1 + pa2 + pa3       # PA 由 pa1, pa2, pa3 测量</span></span><br><span class="line"><span class="string">  WO =~ work1 + work2         # WO 由 work1, work2 测量</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 结构模型</span></span><br><span class="line"><span class="string">  EE ~ WO                     # EE 被 WO 预测</span></span><br><span class="line"><span class="string">  D ~ EE                      # D 被 EE 预测</span></span><br><span class="line"><span class="string">  PA ~ EE                     # PA 被 EE 预测</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 协方差</span></span><br><span class="line"><span class="string">  PA ~~ D                     # PA 和 D 之间的协方差</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 截距</span></span><br><span class="line"><span class="string">  ee1 ~ 1</span></span><br><span class="line"><span class="string">  ee2 ~ 1</span></span><br><span class="line"><span class="string">  ee3 ~ 1</span></span><br><span class="line"><span class="string">  dpl1 ~ 1</span></span><br><span class="line"><span class="string">  dpl2 ~ 1</span></span><br><span class="line"><span class="string">  pa1 ~ 1</span></span><br><span class="line"><span class="string">  pa2 ~ 1</span></span><br><span class="line"><span class="string">  pa3 ~ 1</span></span><br><span class="line"><span class="string">  work1 ~ 1</span></span><br><span class="line"><span class="string">  work2 ~ 1</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拟合模型</span></span><br><span class="line">fit <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">layout_matrix <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> <span class="built_in">dimnames</span> <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="literal">NULL</span><span class="punctuation">,</span> <span class="literal">NULL</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;work1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;work2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;WO&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;EE&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;ee1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;ee2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;ee3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;PA&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;pa1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;pa2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;pa3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;dpl1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;dpl2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;D&quot;</span></span><br><span class="line">graph_sem<span class="punctuation">(</span>fit<span class="punctuation">,</span> layout <span class="operator">=</span> layout_matrix<span class="punctuation">,</span> text_size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240617200422254.png" alt="结构方程模型"></p>
<p>模型拟合结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                               <span class="number">301.492</span></span><br><span class="line">  Degrees of freedom                                <span class="number">31</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                              <span class="number">7493.700</span></span><br><span class="line">  Degrees of freedom                                <span class="number">45</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.964</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.947</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>             <span class="operator">-</span><span class="number">18293.991</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>     <span class="operator">-</span><span class="number">18143.245</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                               <span class="number">36655.982</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                             <span class="number">36835.006</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>      <span class="number">36727.000</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.078</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.070</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.086</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.000</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.360</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.040</span></span><br></pre></td></tr></table></figure>
<p>可以看出，卡方值为301.492，自由度为31，CFI值为0.964，TLI值为0.947，RMSEA值为0.078，表明模型拟合较好。</p>
<p>模型估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">Latent Variables<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  EE <span class="operator">=</span><span class="operator">~</span>                                                                 </span><br><span class="line">    ee1               <span class="number">1.000</span>                               <span class="number">1.146</span>    <span class="number">0.875</span></span><br><span class="line">    ee2               <span class="number">1.017</span>    <span class="number">0.021</span>   <span class="number">48.938</span>    <span class="number">0.000</span>    <span class="number">1.166</span>    <span class="number">0.927</span></span><br><span class="line">    ee3               <span class="number">0.963</span>    <span class="number">0.023</span>   <span class="number">42.771</span>    <span class="number">0.000</span>    <span class="number">1.104</span>    <span class="number">0.851</span></span><br><span class="line">  D <span class="operator">=</span><span class="operator">~</span>                                                                  </span><br><span class="line">    dpl1              <span class="number">1.000</span>                               <span class="number">0.947</span>    <span class="number">0.865</span></span><br><span class="line">    dpl2              <span class="number">0.941</span>    <span class="number">0.044</span>   <span class="number">21.591</span>    <span class="number">0.000</span>    <span class="number">0.891</span>    <span class="number">0.754</span></span><br><span class="line">  PA <span class="operator">=</span><span class="operator">~</span>                                                                 </span><br><span class="line">    pa1               <span class="number">1.000</span>                               <span class="number">0.738</span>    <span class="number">0.809</span></span><br><span class="line">    pa2               <span class="number">1.076</span>    <span class="number">0.036</span>   <span class="number">29.617</span>    <span class="number">0.000</span>    <span class="number">0.794</span>    <span class="number">0.825</span></span><br><span class="line">    pa3               <span class="number">0.979</span>    <span class="number">0.035</span>   <span class="number">27.854</span>    <span class="number">0.000</span>    <span class="number">0.723</span>    <span class="number">0.750</span></span><br><span class="line">  WO <span class="operator">=</span><span class="operator">~</span>                                                                 </span><br><span class="line">    work1             <span class="number">1.000</span>                               <span class="number">1.007</span>    <span class="number">0.838</span></span><br><span class="line">    work2             <span class="number">0.652</span>    <span class="number">0.039</span>   <span class="number">16.585</span>    <span class="number">0.000</span>    <span class="number">0.656</span>    <span class="number">0.602</span></span><br><span class="line"></span><br><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  EE <span class="operator">~</span>                                                                  </span><br><span class="line">    WO                <span class="number">0.766</span>    <span class="number">0.046</span>   <span class="number">16.490</span>    <span class="number">0.000</span>    <span class="number">0.673</span>    <span class="number">0.673</span></span><br><span class="line">  D <span class="operator">~</span>                                                                   </span><br><span class="line">    EE                <span class="number">0.462</span>    <span class="number">0.024</span>   <span class="number">19.325</span>    <span class="number">0.000</span>    <span class="number">0.559</span>    <span class="number">0.559</span></span><br><span class="line">  PA <span class="operator">~</span>                                                                  </span><br><span class="line">    EE               <span class="operator">-</span><span class="number">0.262</span>    <span class="number">0.019</span>  <span class="operator">-</span><span class="number">13.776</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.408</span>   <span class="operator">-</span><span class="number">0.408</span></span><br><span class="line"></span><br><span class="line">Covariances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line"> .D <span class="operator">~</span><span class="operator">~</span>                                                                  </span><br><span class="line">   .PA               <span class="operator">-</span><span class="number">0.174</span>    <span class="number">0.019</span>   <span class="operator">-</span><span class="number">8.950</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.328</span>   <span class="operator">-</span><span class="number">0.328</span></span><br><span class="line"></span><br><span class="line">Intercepts<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .ee1               <span class="number">3.855</span>    <span class="number">0.035</span>  <span class="number">111.347</span>    <span class="number">0.000</span>    <span class="number">3.855</span>    <span class="number">2.944</span></span><br><span class="line">   .ee2               <span class="number">3.530</span>    <span class="number">0.033</span>  <span class="number">106.201</span>    <span class="number">0.000</span>    <span class="number">3.530</span>    <span class="number">2.808</span></span><br><span class="line">   .ee3               <span class="number">3.165</span>    <span class="number">0.034</span>   <span class="number">92.281</span>    <span class="number">0.000</span>    <span class="number">3.165</span>    <span class="number">2.440</span></span><br><span class="line">   .dpl1              <span class="number">2.319</span>    <span class="number">0.029</span>   <span class="number">80.113</span>    <span class="number">0.000</span>    <span class="number">2.319</span>    <span class="number">2.119</span></span><br><span class="line">   .dpl2              <span class="number">2.086</span>    <span class="number">0.031</span>   <span class="number">66.763</span>    <span class="number">0.000</span>    <span class="number">2.086</span>    <span class="number">1.765</span></span><br><span class="line">   .pa1               <span class="number">5.748</span>    <span class="number">0.024</span>  <span class="number">238.172</span>    <span class="number">0.000</span>    <span class="number">5.748</span>    <span class="number">6.298</span></span><br><span class="line">   .pa2               <span class="number">5.850</span>    <span class="number">0.025</span>  <span class="number">229.759</span>    <span class="number">0.000</span>    <span class="number">5.850</span>    <span class="number">6.076</span></span><br><span class="line">   .pa3               <span class="number">5.815</span>    <span class="number">0.025</span>  <span class="number">228.188</span>    <span class="number">0.000</span>    <span class="number">5.815</span>    <span class="number">6.034</span></span><br><span class="line">   .work1             <span class="number">3.240</span>    <span class="number">0.032</span>  <span class="number">101.996</span>    <span class="number">0.000</span>    <span class="number">3.240</span>    <span class="number">2.697</span></span><br><span class="line">   .work2             <span class="number">2.243</span>    <span class="number">0.029</span>   <span class="number">77.885</span>    <span class="number">0.000</span>    <span class="number">2.243</span>    <span class="number">2.060</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .ee1               <span class="number">0.400</span>    <span class="number">0.021</span>   <span class="number">19.017</span>    <span class="number">0.000</span>    <span class="number">0.400</span>    <span class="number">0.234</span></span><br><span class="line">   .ee2               <span class="number">0.222</span>    <span class="number">0.017</span>   <span class="number">13.108</span>    <span class="number">0.000</span>    <span class="number">0.222</span>    <span class="number">0.140</span></span><br><span class="line">   .ee3               <span class="number">0.463</span>    <span class="number">0.022</span>   <span class="number">20.743</span>    <span class="number">0.000</span>    <span class="number">0.463</span>    <span class="number">0.275</span></span><br><span class="line">   .dpl1              <span class="number">0.302</span>    <span class="number">0.037</span>    <span class="number">8.137</span>    <span class="number">0.000</span>    <span class="number">0.302</span>    <span class="number">0.252</span></span><br><span class="line">   .dpl2              <span class="number">0.603</span>    <span class="number">0.039</span>   <span class="number">15.621</span>    <span class="number">0.000</span>    <span class="number">0.603</span>    <span class="number">0.432</span></span><br><span class="line">   .pa1               <span class="number">0.288</span>    <span class="number">0.017</span>   <span class="number">16.743</span>    <span class="number">0.000</span>    <span class="number">0.288</span>    <span class="number">0.346</span></span><br><span class="line">   .pa2               <span class="number">0.296</span>    <span class="number">0.019</span>   <span class="number">15.573</span>    <span class="number">0.000</span>    <span class="number">0.296</span>    <span class="number">0.320</span></span><br><span class="line">   .pa3               <span class="number">0.406</span>    <span class="number">0.020</span>   <span class="number">20.150</span>    <span class="number">0.000</span>    <span class="number">0.406</span>    <span class="number">0.438</span></span><br><span class="line">   .work1             <span class="number">0.429</span>    <span class="number">0.054</span>    <span class="number">7.876</span>    <span class="number">0.000</span>    <span class="number">0.429</span>    <span class="number">0.297</span></span><br><span class="line">   .work2             <span class="number">0.756</span>    <span class="number">0.036</span>   <span class="number">21.071</span>    <span class="number">0.000</span>    <span class="number">0.756</span>    <span class="number">0.637</span></span><br><span class="line">   .EE                <span class="number">0.719</span>    <span class="number">0.048</span>   <span class="number">15.109</span>    <span class="number">0.000</span>    <span class="number">0.547</span>    <span class="number">0.547</span></span><br><span class="line">   .D                 <span class="number">0.616</span>    <span class="number">0.044</span>   <span class="number">14.058</span>    <span class="number">0.000</span>    <span class="number">0.687</span>    <span class="number">0.687</span></span><br><span class="line">   .PA                <span class="number">0.454</span>    <span class="number">0.028</span>   <span class="number">16.485</span>    <span class="number">0.000</span>    <span class="number">0.834</span>    <span class="number">0.834</span></span><br><span class="line">    WO                <span class="number">1.014</span>    <span class="number">0.073</span>   <span class="number">13.851</span>    <span class="number">0.000</span>    <span class="number">1.000</span>    <span class="number">1.000</span></span><br><span class="line"></span><br><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    ee1               <span class="number">0.766</span></span><br><span class="line">    ee2               <span class="number">0.860</span></span><br><span class="line">    ee3               <span class="number">0.725</span></span><br><span class="line">    dpl1              <span class="number">0.748</span></span><br><span class="line">    dpl2              <span class="number">0.568</span></span><br><span class="line">    pa1               <span class="number">0.654</span></span><br><span class="line">    pa2               <span class="number">0.680</span></span><br><span class="line">    pa3               <span class="number">0.562</span></span><br><span class="line">    work1             <span class="number">0.703</span></span><br><span class="line">    work2             <span class="number">0.363</span></span><br><span class="line">    EE                <span class="number">0.453</span></span><br><span class="line">    D                 <span class="number">0.313</span></span><br><span class="line">    PA                <span class="number">0.166</span></span><br></pre></td></tr></table></figure>
<h2 id="结构方程模型多组比较">结构方程模型多组比较</h2>
<h3 id="不同性别分别拟合模型-2">不同性别分别拟合模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不同性别分别拟合模型</span></span><br><span class="line"><span class="comment"># 分别提取男性和女性的数据</span></span><br><span class="line">data_male <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>data<span class="punctuation">,</span> Gender <span class="operator">==</span> <span class="string">&quot;male&quot;</span><span class="punctuation">)</span></span><br><span class="line">data_female <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>data<span class="punctuation">,</span> Gender <span class="operator">==</span> <span class="string">&quot;female&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对男性数据拟合模型</span></span><br><span class="line">fit_male <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model<span class="punctuation">,</span> data <span class="operator">=</span> data_male<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_male<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对女性数据拟合模型</span></span><br><span class="line">fit_female <span class="operator">&lt;-</span> cfa<span class="punctuation">(</span>model<span class="punctuation">,</span> data <span class="operator">=</span> data_female<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_female<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit_male<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                               <span class="number">201.953</span></span><br><span class="line">  Degrees of freedom                                <span class="number">31</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.954</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.933</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.088</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.077</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.100</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.000</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.878</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit_female<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                               <span class="number">157.743</span></span><br><span class="line">  Degrees of freedom                                <span class="number">31</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.967</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.951</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.076</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.064</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.087</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.000</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.276</span></span><br></pre></td></tr></table></figure>
<h3 id="结构模式相同模型-基线模型">结构模式相同模型(基线模型)</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拟合基线模型（不包含等价约束）</span></span><br><span class="line">fit_baseline <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span> group <span class="operator">=</span> <span class="string">&quot;Gender&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                               <span class="number">359.696</span></span><br><span class="line">  Degrees of freedom                                <span class="number">62</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.000</span></span><br><span class="line">  Test statistic <span class="keyword">for</span> each group<span class="operator">:</span></span><br><span class="line">    female                                     <span class="number">157.743</span></span><br><span class="line">    male                                       <span class="number">201.953</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.960</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.942</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.082</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.074</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.090</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.000</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.662</span></span><br></pre></td></tr></table></figure>
<p>可以看出<code>RMSEA</code>值为0.082，<code>CFI</code>的值为0.960，<code>TLI</code>的值为0.942，卡方值为359.696，自由度为62，表明模型拟合较好。该模型作为基线模型，用于检验其他等价性条件是否满足。</p>
<h3 id="测量模型：因素载荷等价模型-弱等价性">测量模型：因素载荷等价模型(弱等价性)</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测量模型部分 - 因素载荷等价</span></span><br><span class="line">fit_metric <span class="operator">&lt;-</span> update<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> group.equal <span class="operator">=</span> <span class="string">&quot;loadings&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_metric<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">             Df   AIC   BIC  Chisq Chisq diff RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit_baseline <span class="number">62</span> <span class="number">36683</span> <span class="number">37041</span> <span class="number">359.70</span>                                    </span><br><span class="line">fit_metric   <span class="number">68</span> <span class="number">36675</span> <span class="number">37002</span> <span class="number">364.27</span>     <span class="number">4.5749</span>     <span class="number">0</span>       <span class="number">6</span>     <span class="number">0.5994</span></span><br></pre></td></tr></table></figure>
<p>弱等价性模型嵌套于基线模型，可以使用嵌套模型的比较方法。</p>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为4.5749，自由度的差值<code>Df diff</code>为6，表明两个模型的卡方差异不显著。可以接受弱等价模型，即认为不同性别之间满足因素载荷等价条件。</p>
<h3 id="测量模型：误差协方差矩阵等价模型">测量模型：误差协方差矩阵等价模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测量模型部分 - 误差协方差矩阵等价</span></span><br><span class="line">fit_residuals <span class="operator">&lt;-</span> update<span class="punctuation">(</span>fit_metric<span class="punctuation">,</span> group.equal <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_residuals<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">              Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit_baseline  <span class="number">62</span> <span class="number">36683</span> <span class="number">37041</span> <span class="number">359.70</span>                                       </span><br><span class="line">fit_metric    <span class="number">68</span> <span class="number">36675</span> <span class="number">37002</span> <span class="number">364.27</span>     <span class="number">4.5749</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.5994</span></span><br><span class="line">fit_residuals <span class="number">78</span> <span class="number">36670</span> <span class="number">36944</span> <span class="number">379.52</span>    <span class="number">15.2466</span> <span class="number">0.027089</span>      <span class="number">10</span>     <span class="number">0.1233</span></span><br></pre></td></tr></table></figure>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为15.2466，自由度的差值<code>Df diff</code>为10，表明两个模型的卡方差异不显著。可以接受误差方差等价模型，即认为不同性别之间满足误差方差等价条件。</p>
<h3 id="测量模型：截距等价模型">测量模型：截距等价模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fit_scalar <span class="operator">&lt;-</span> update<span class="punctuation">(</span>fit_residuals<span class="punctuation">,</span> group.equal <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_scalar<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">              Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit_baseline  <span class="number">62</span> <span class="number">36683</span> <span class="number">37041</span> <span class="number">359.70</span>                                       </span><br><span class="line">fit_metric    <span class="number">68</span> <span class="number">36675</span> <span class="number">37002</span> <span class="number">364.27</span>     <span class="number">4.5749</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.5994</span></span><br><span class="line">fit_residuals <span class="number">78</span> <span class="number">36670</span> <span class="number">36944</span> <span class="number">379.52</span>    <span class="number">15.2466</span> <span class="number">0.027089</span>      <span class="number">10</span>     <span class="number">0.1233</span></span><br><span class="line">fit_scalar    <span class="number">84</span> <span class="number">36663</span> <span class="number">36905</span> <span class="number">384.07</span>     <span class="number">4.5511</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.6025</span></span><br></pre></td></tr></table></figure>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为4.5511，自由度的差值<code>Df diff</code>为6，表明两个模型的卡方差异不显著。可以接受强等价模型，即认为不同性别之间满足截距等价条件。</p>
<h3 id="结构模型：潜变量路径系数等价模型">结构模型：潜变量路径系数等价模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 潜变量相关或回归系数等价性检验</span></span><br><span class="line">fit_structural <span class="operator">&lt;-</span> update<span class="punctuation">(</span>fit_scalar<span class="punctuation">,</span> group.equal <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;regressions&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_structural<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">,</span> fit_structural<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">,</span> fit_structural<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">               Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit_baseline   <span class="number">62</span> <span class="number">36683</span> <span class="number">37041</span> <span class="number">359.70</span>                                       </span><br><span class="line">fit_metric     <span class="number">68</span> <span class="number">36675</span> <span class="number">37002</span> <span class="number">364.27</span>     <span class="number">4.5749</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.5994</span></span><br><span class="line">fit_residuals  <span class="number">78</span> <span class="number">36670</span> <span class="number">36944</span> <span class="number">379.52</span>    <span class="number">15.2466</span> <span class="number">0.027089</span>      <span class="number">10</span>     <span class="number">0.1233</span></span><br><span class="line">fit_scalar     <span class="number">84</span> <span class="number">36663</span> <span class="number">36905</span> <span class="number">384.07</span>     <span class="number">4.5511</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.6025</span></span><br><span class="line">fit_structural <span class="number">87</span> <span class="number">36662</span> <span class="number">36889</span> <span class="number">389.60</span>     <span class="number">5.5357</span> <span class="number">0.034382</span>       <span class="number">3</span>     <span class="number">0.1365</span></span><br></pre></td></tr></table></figure>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为5.5357，自由度的差值<code>Df diff</code>为4，表明两个模型的卡方差异不显著。可以接受潜变量路径系数等价模型，即认为不同性别之间满足路径系数等价条件。</p>
<h3 id="结构模型：潜变量协方差矩阵等价模型">结构模型：潜变量协方差矩阵等价模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结构模型部分 - 潜变量协方差矩阵等价</span></span><br><span class="line">fit_covariance <span class="operator">&lt;-</span> update<span class="punctuation">(</span>fit_structural<span class="punctuation">,</span> group.equal <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;regressions&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.covariances&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_covariance<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">,</span> fit_structural<span class="punctuation">,</span> fit_covariance<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">,</span> fit_structural<span class="punctuation">,</span> fit_covariance<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">               Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit_baseline   <span class="number">62</span> <span class="number">36683</span> <span class="number">37041</span> <span class="number">359.70</span>                                       </span><br><span class="line">fit_metric     <span class="number">68</span> <span class="number">36675</span> <span class="number">37002</span> <span class="number">364.27</span>     <span class="number">4.5749</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.5994</span></span><br><span class="line">fit_residuals  <span class="number">78</span> <span class="number">36670</span> <span class="number">36944</span> <span class="number">379.52</span>    <span class="number">15.2466</span> <span class="number">0.027089</span>      <span class="number">10</span>     <span class="number">0.1233</span></span><br><span class="line">fit_scalar     <span class="number">84</span> <span class="number">36663</span> <span class="number">36905</span> <span class="number">384.07</span>     <span class="number">4.5511</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.6025</span></span><br><span class="line">fit_structural <span class="number">87</span> <span class="number">36662</span> <span class="number">36889</span> <span class="number">389.60</span>     <span class="number">5.5357</span> <span class="number">0.034382</span>       <span class="number">3</span>     <span class="number">0.1365</span></span><br><span class="line">fit_covariance <span class="number">88</span> <span class="number">36662</span> <span class="number">36883</span> <span class="number">391.08</span>     <span class="number">1.4783</span> <span class="number">0.025865</span>       <span class="number">1</span>     <span class="number">0.2240</span></span><br></pre></td></tr></table></figure>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为1.4783，自由度的差值<code>Df diff</code>为1，表明两个模型的卡方差异不显著。可以接受潜变量协方差等价模型，即认为不同性别之间满足潜变量协方差等价条件。</p>
<h3 id="结构模型：潜变量方差等价模型">结构模型：潜变量方差等价模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结构模型部分 - 潜变量方差等价</span></span><br><span class="line">fit_variances <span class="operator">&lt;-</span> update<span class="punctuation">(</span>fit_covariance<span class="punctuation">,</span> group.equal <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;regressions&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.covariances&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.variances&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_variances<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">,</span> fit_covariance<span class="punctuation">,</span> fit_variances<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">,</span> fit_structural<span class="punctuation">,</span> fit_covariance<span class="punctuation">,</span> fit_variances<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">               Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit_baseline   <span class="number">62</span> <span class="number">36683</span> <span class="number">37041</span> <span class="number">359.70</span>                                       </span><br><span class="line">fit_metric     <span class="number">68</span> <span class="number">36675</span> <span class="number">37002</span> <span class="number">364.27</span>     <span class="number">4.5749</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.5994</span></span><br><span class="line">fit_residuals  <span class="number">78</span> <span class="number">36670</span> <span class="number">36944</span> <span class="number">379.52</span>    <span class="number">15.2466</span> <span class="number">0.027089</span>      <span class="number">10</span>     <span class="number">0.1233</span></span><br><span class="line">fit_scalar     <span class="number">84</span> <span class="number">36663</span> <span class="number">36905</span> <span class="number">384.07</span>     <span class="number">4.5511</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.6025</span></span><br><span class="line">fit_structural <span class="number">87</span> <span class="number">36662</span> <span class="number">36889</span> <span class="number">389.60</span>     <span class="number">5.5357</span> <span class="number">0.034382</span>       <span class="number">3</span>     <span class="number">0.1365</span></span><br><span class="line">fit_covariance <span class="number">88</span> <span class="number">36662</span> <span class="number">36883</span> <span class="number">391.08</span>     <span class="number">1.4783</span> <span class="number">0.025865</span>       <span class="number">1</span>     <span class="number">0.2240</span></span><br><span class="line">fit_variances  <span class="number">92</span> <span class="number">36660</span> <span class="number">36860</span> <span class="number">397.44</span>     <span class="number">6.3575</span> <span class="number">0.028710</span>       <span class="number">4</span>     <span class="number">0.1740</span></span><br></pre></td></tr></table></figure>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为6.3575，自由度的差值<code>Df diff</code>为4，表明两个模型的卡方差异不显著。可以接受潜变量方差等价模型，即认为不同性别之间满足潜变量方差等价条件。</p>
<h3 id="结构模型：潜在因素均值等价模型">结构模型：潜在因素均值等价模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结构模型部分 - 潜在因素均值等价</span></span><br><span class="line">fit_means <span class="operator">&lt;-</span> update<span class="punctuation">(</span>fit_variances<span class="punctuation">,</span> group.equal <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;loadings&quot;</span><span class="punctuation">,</span> <span class="string">&quot;residuals&quot;</span><span class="punctuation">,</span> <span class="string">&quot;intercepts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;regressions&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.covariances&quot;</span><span class="punctuation">,</span> <span class="string">&quot;lv.variances&quot;</span><span class="punctuation">,</span> <span class="string">&quot;means&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_means<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">,</span> fit_covariance<span class="punctuation">,</span> fit_means<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit_baseline<span class="punctuation">,</span> fit_metric<span class="punctuation">,</span> fit_residuals<span class="punctuation">,</span> fit_scalar<span class="punctuation">,</span> fit_structural<span class="punctuation">,</span> fit_covariance<span class="punctuation">,</span> fit_variances<span class="punctuation">,</span> fit_means<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">               Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit_baseline   <span class="number">62</span> <span class="number">36683</span> <span class="number">37041</span> <span class="number">359.70</span>                                       </span><br><span class="line">fit_metric     <span class="number">68</span> <span class="number">36675</span> <span class="number">37002</span> <span class="number">364.27</span>     <span class="number">4.5749</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.5994</span></span><br><span class="line">fit_residuals  <span class="number">78</span> <span class="number">36670</span> <span class="number">36944</span> <span class="number">379.52</span>    <span class="number">15.2466</span> <span class="number">0.027089</span>      <span class="number">10</span>     <span class="number">0.1233</span></span><br><span class="line">fit_scalar     <span class="number">84</span> <span class="number">36663</span> <span class="number">36905</span> <span class="number">384.07</span>     <span class="number">4.5511</span> <span class="number">0.000000</span>       <span class="number">6</span>     <span class="number">0.6025</span></span><br><span class="line">fit_structural <span class="number">87</span> <span class="number">36662</span> <span class="number">36889</span> <span class="number">389.60</span>     <span class="number">5.5357</span> <span class="number">0.034382</span>       <span class="number">3</span>     <span class="number">0.1365</span></span><br><span class="line">fit_covariance <span class="number">88</span> <span class="number">36662</span> <span class="number">36883</span> <span class="number">391.08</span>     <span class="number">1.4783</span> <span class="number">0.025865</span>       <span class="number">1</span>     <span class="number">0.2240</span></span><br><span class="line">fit_variances  <span class="number">92</span> <span class="number">36660</span> <span class="number">36860</span> <span class="number">397.44</span>     <span class="number">6.3575</span> <span class="number">0.028710</span>       <span class="number">4</span>     <span class="number">0.1740</span></span><br><span class="line">fit_means      <span class="number">96</span> <span class="number">36656</span> <span class="number">36835</span> <span class="number">401.14</span>     <span class="number">3.6989</span> <span class="number">0.000000</span>       <span class="number">4</span>     <span class="number">0.4483</span></span><br></pre></td></tr></table></figure>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为3.6989，自由度的差值<code>Df diff</code>为4，表明两个模型的卡方差异不显著。可以接受潜变量均值等价模型，即认为不同性别之间满足潜变量均值等价条件。</p>
<h1>中介分析</h1>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>tidySEM<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>blavaan<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/11第十一章 中介分析/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;./11_4 med.dat&quot;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> na.strings <span class="operator">=</span> <span class="string">&quot;NA&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="数据介绍-4">数据介绍</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据名称</span></span><br><span class="line"><span class="comment"># ID -- V1</span></span><br><span class="line"><span class="comment"># nrel1 -- V2</span></span><br><span class="line"><span class="comment"># nrel2 -- V3</span></span><br><span class="line"><span class="comment"># nrel3 -- V4</span></span><br><span class="line"><span class="comment"># prel1 -- V5</span></span><br><span class="line"><span class="comment"># prel2 -- V6</span></span><br><span class="line"><span class="comment"># prel3 -- V7</span></span><br><span class="line"><span class="comment"># pem1 -- V8</span></span><br><span class="line"><span class="comment"># pem2 -- V9</span></span><br><span class="line"><span class="comment"># pem3 -- V10</span></span><br><span class="line"><span class="comment"># nem1 -- V11</span></span><br><span class="line"><span class="comment"># nem2 -- V12</span></span><br><span class="line"><span class="comment"># nem3 -- V13</span></span><br><span class="line"><span class="comment"># sat1 -- V14</span></span><br><span class="line"><span class="comment"># sat2 -- V15</span></span><br><span class="line"><span class="comment"># sat3 -- V16</span></span><br><span class="line"><span class="comment"># nrel_m -- V17</span></span><br><span class="line"><span class="comment"># prel_m -- V18</span></span><br><span class="line"><span class="comment"># pem_m -- V19</span></span><br><span class="line"><span class="comment"># mem_m -- V20</span></span><br><span class="line"><span class="comment"># sat_m -- V21</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 变量重命名</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;ID&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nrel1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nrel2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nrel3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;prel1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;prel2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;prel3&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                 <span class="string">&quot;pem1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;pem2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;pem3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nem1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nem2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nem3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;sat1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;sat2&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                 <span class="string">&quot;sat3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nrel_m&quot;</span><span class="punctuation">,</span> <span class="string">&quot;prel_m&quot;</span><span class="punctuation">,</span> <span class="string">&quot;pem_m&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nem_m&quot;</span><span class="punctuation">,</span> <span class="string">&quot;sat_m&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>中介分析模型</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义中介分析模型</span></span><br><span class="line">med_model <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 直接效应</span></span><br><span class="line"><span class="string">  sat_m ~ a1*pem_m + a2*nem_m + a3*prel_m + a4*nrel_m</span></span><br><span class="line"><span class="string">  pem_m ~ b*prel_m</span></span><br><span class="line"><span class="string">  nem_m ~ c*nrel_m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 计算间接效应（使用正确的参数定义方式）</span></span><br><span class="line"><span class="string">  # 间接效应: sat_m 对 pem_m 通过 prel_m</span></span><br><span class="line"><span class="string">  ind_pem_sat := b * a1</span></span><br><span class="line"><span class="string">  # 间接效应: sat_m 对 nem_m 通过 nrel_m</span></span><br><span class="line"><span class="string">  ind_nem_sat := c * a2</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line">fit <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>med_model<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">layout_matrix <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> <span class="built_in">dimnames</span> <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="literal">NULL</span><span class="punctuation">,</span> <span class="literal">NULL</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;prel_m&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nrel_m&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;pem_m&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;sat_m&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nem_m&quot;</span></span><br><span class="line">graph_sem<span class="punctuation">(</span>fit<span class="punctuation">,</span> layout <span class="operator">=</span> layout_matrix<span class="punctuation">,</span> text_size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240617201003212.png" alt="中介分析模型"></p>
<h2 id="Sobel检验">Sobel检验</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit1 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>med_model<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>模型拟合结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                 <span class="number">2.804</span></span><br><span class="line">  Degrees of freedom                                 <span class="number">3</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.423</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">109.942</span></span><br><span class="line">  Degrees of freedom                                 <span class="number">9</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">1.000</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">1.006</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>              <span class="operator">-</span><span class="number">1249.213</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>      <span class="operator">-</span><span class="number">1247.811</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                                <span class="number">2516.426</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                              <span class="number">2548.472</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>       <span class="number">2519.938</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.102</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.664</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.135</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.025</span></span><br></pre></td></tr></table></figure>
<p>可以看出，卡方值为2.804，自由度为3，CFI值为1.000，TLI值为1.006，RMSEA值为0.000，表明模型拟合较好。</p>
<p>参数估计结果与标准化参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  sat_m <span class="operator">~</span>                                                               </span><br><span class="line">    pem_m     <span class="punctuation">(</span>a1<span class="punctuation">)</span>    <span class="number">0.219</span>    <span class="number">0.060</span>    <span class="number">3.654</span>    <span class="number">0.000</span>    <span class="number">0.219</span>    <span class="number">0.206</span></span><br><span class="line">    nem_m     <span class="punctuation">(</span>a2<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.335</span>    <span class="number">0.061</span>   <span class="operator">-</span><span class="number">5.543</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.335</span>   <span class="operator">-</span><span class="number">0.317</span></span><br><span class="line">    prel_m    <span class="punctuation">(</span>a3<span class="punctuation">)</span>    <span class="number">0.184</span>    <span class="number">0.062</span>    <span class="number">2.972</span>    <span class="number">0.003</span>    <span class="number">0.184</span>    <span class="number">0.168</span></span><br><span class="line">    nrel_m    <span class="punctuation">(</span>a4<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.121</span>    <span class="number">0.062</span>   <span class="operator">-</span><span class="number">1.966</span>    <span class="number">0.049</span>   <span class="operator">-</span><span class="number">0.121</span>   <span class="operator">-</span><span class="number">0.112</span></span><br><span class="line">  pem_m <span class="operator">~</span>                                                               </span><br><span class="line">    prel_m     <span class="punctuation">(</span>b<span class="punctuation">)</span>    <span class="number">0.256</span>    <span class="number">0.062</span>    <span class="number">4.140</span>    <span class="number">0.000</span>    <span class="number">0.256</span>    <span class="number">0.249</span></span><br><span class="line">  nem_m <span class="operator">~</span>                                                               </span><br><span class="line">    nrel_m     <span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">)</span>    <span class="number">0.297</span>    <span class="number">0.061</span>    <span class="number">4.907</span>    <span class="number">0.000</span>    <span class="number">0.297</span>    <span class="number">0.291</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .sat_m             <span class="number">1.385</span>    <span class="number">0.121</span>   <span class="number">11.402</span>    <span class="number">0.000</span>    <span class="number">1.385</span>    <span class="number">0.778</span></span><br><span class="line">   .pem_m             <span class="number">1.484</span>    <span class="number">0.130</span>   <span class="number">11.402</span>    <span class="number">0.000</span>    <span class="number">1.484</span>    <span class="number">0.938</span></span><br><span class="line">   .nem_m             <span class="number">1.455</span>    <span class="number">0.128</span>   <span class="number">11.402</span>    <span class="number">0.000</span>    <span class="number">1.455</span>    <span class="number">0.915</span></span><br><span class="line"></span><br><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    sat_m             <span class="number">0.222</span></span><br><span class="line">    pem_m             <span class="number">0.062</span></span><br><span class="line">    nem_m             <span class="number">0.085</span></span><br></pre></td></tr></table></figure>
<p>中介效应检验结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Defined Parameters<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">    ind_pem_sat       <span class="number">0.056</span>    <span class="number">0.020</span>    <span class="number">2.739</span>    <span class="number">0.006</span>    <span class="number">0.056</span>    <span class="number">0.051</span></span><br><span class="line">    ind_nem_sat      <span class="operator">-</span><span class="number">0.100</span>    <span class="number">0.027</span>   <span class="operator">-</span><span class="number">3.674</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.100</span>   <span class="operator">-</span><span class="number">0.092</span></span><br></pre></td></tr></table></figure>
<p>两个中介效应结果显著。</p>
<h2 id="Bootstrap检验">Bootstrap检验</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Bootstrap检验</span></span><br><span class="line">fit2 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>med_model<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">,</span> se<span class="operator">=</span><span class="string">&quot;bootstrap&quot;</span><span class="punctuation">,</span> bootstrap<span class="operator">=</span><span class="number">1000</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型摘要，包括偏差修正的 bootstrap 置信区间</span></span><br><span class="line">summary<span class="punctuation">(</span>fit2<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看参数估计，包括不同置信水平的偏差修正的 bootstrap 置信区间</span></span><br><span class="line">parameterEstimates<span class="punctuation">(</span>fit2<span class="punctuation">,</span> level<span class="operator">=</span><span class="number">0.90</span><span class="punctuation">,</span> boot.ci.type<span class="operator">=</span><span class="string">&quot;bca&quot;</span><span class="punctuation">)</span></span><br><span class="line">parameterEstimates<span class="punctuation">(</span>fit2<span class="punctuation">,</span> level<span class="operator">=</span><span class="number">0.95</span><span class="punctuation">,</span> boot.ci.type<span class="operator">=</span><span class="string">&quot;bca&quot;</span><span class="punctuation">)</span></span><br><span class="line">parameterEstimates<span class="punctuation">(</span>fit2<span class="punctuation">,</span> level<span class="operator">=</span><span class="number">0.99</span><span class="punctuation">,</span> boot.ci.type<span class="operator">=</span><span class="string">&quot;bca&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>结果呈现了估计值<code>est</code>、90%置信区间、95%置信区间、99%置信区间</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> parameterEstimates<span class="punctuation">(</span>fit2<span class="punctuation">,</span> level<span class="operator">=</span><span class="number">0.90</span><span class="punctuation">,</span> boot.ci.type<span class="operator">=</span><span class="string">&quot;bca&quot;</span><span class="punctuation">)</span></span><br><span class="line">           lhs op    rhs       label    est    se      z pvalue ci.lower ci.upper</span><br><span class="line"><span class="number">13</span> ind_pem_sat <span class="operator">:=</span>   b<span class="operator">*</span>a1 ind_pem_sat  <span class="number">0.056</span> <span class="number">0.020</span>  <span class="number">2.803</span>  <span class="number">0.005</span>    <span class="number">0.029</span>    <span class="number">0.096</span></span><br><span class="line"><span class="number">14</span> ind_nem_sat <span class="operator">:=</span>   <span class="built_in">c</span><span class="operator">*</span>a2 ind_nem_sat <span class="operator">-</span><span class="number">0.100</span> <span class="number">0.027</span> <span class="operator">-</span><span class="number">3.733</span>  <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.148</span>   <span class="operator">-</span><span class="number">0.061</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> parameterEstimates<span class="punctuation">(</span>fit2<span class="punctuation">,</span> level<span class="operator">=</span><span class="number">0.95</span><span class="punctuation">,</span> boot.ci.type<span class="operator">=</span><span class="string">&quot;bca&quot;</span><span class="punctuation">)</span></span><br><span class="line">           lhs op    rhs       label    est    se      z pvalue ci.lower ci.upper</span><br><span class="line"><span class="number">13</span> ind_pem_sat <span class="operator">:=</span>   b<span class="operator">*</span>a1 ind_pem_sat  <span class="number">0.056</span> <span class="number">0.020</span>  <span class="number">2.803</span>  <span class="number">0.005</span>    <span class="number">0.024</span>    <span class="number">0.103</span></span><br><span class="line"><span class="number">14</span> ind_nem_sat <span class="operator">:=</span>   <span class="built_in">c</span><span class="operator">*</span>a2 ind_nem_sat <span class="operator">-</span><span class="number">0.100</span> <span class="number">0.027</span> <span class="operator">-</span><span class="number">3.733</span>  <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.158</span>   <span class="operator">-</span><span class="number">0.054</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> parameterEstimates<span class="punctuation">(</span>fit2<span class="punctuation">,</span> level<span class="operator">=</span><span class="number">0.99</span><span class="punctuation">,</span> boot.ci.type<span class="operator">=</span><span class="string">&quot;bca&quot;</span><span class="punctuation">)</span></span><br><span class="line">           lhs op    rhs       label    est    se      z pvalue ci.lower ci.upper</span><br><span class="line"><span class="number">13</span> ind_pem_sat <span class="operator">:=</span>   b<span class="operator">*</span>a1 ind_pem_sat  <span class="number">0.056</span> <span class="number">0.020</span>  <span class="number">2.803</span>  <span class="number">0.005</span>    <span class="number">0.016</span>    <span class="number">0.118</span></span><br><span class="line"><span class="number">14</span> ind_nem_sat <span class="operator">:=</span>   <span class="built_in">c</span><span class="operator">*</span>a2 ind_nem_sat <span class="operator">-</span><span class="number">0.100</span> <span class="number">0.027</span> <span class="operator">-</span><span class="number">3.733</span>  <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.183</span>   <span class="operator">-</span><span class="number">0.044</span></span><br></pre></td></tr></table></figure>
<p>两个中介效应的置信区间均不包括0，说明两个中介效应均在0.10、0.05、0.01水平上显著</p>
<h2 id="MCMC方法">MCMC方法</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fit3 <span class="operator">&lt;-</span> bsem<span class="punctuation">(</span>med_model<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span></span><br><span class="line">             n.chains <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>         <span class="comment"># 使用4个MCMC链</span></span><br><span class="line">             burnin <span class="operator">=</span> <span class="number">1000</span><span class="punctuation">,</span>         <span class="comment"># 烧入期迭代次数</span></span><br><span class="line">             sample <span class="operator">=</span> <span class="number">30000</span><span class="punctuation">,</span>        <span class="comment"># 采样次数</span></span><br><span class="line">             adapt <span class="operator">=</span> <span class="number">1000</span><span class="punctuation">,</span>         <span class="comment"># 自适应迭代次数</span></span><br><span class="line">             target <span class="operator">=</span> <span class="string">&quot;stan&quot;</span><span class="punctuation">,</span>      <span class="comment"># 使用 Stan 为MCMC后端</span></span><br><span class="line">             seed <span class="operator">=</span> <span class="number">12345</span><span class="punctuation">,</span>         <span class="comment"># 设置随机种子以确保结果的可复现性</span></span><br><span class="line">             save.lvs <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span>     <span class="comment"># 是否保存潜变量分数</span></span><br><span class="line"></span><br><span class="line">summary<span class="punctuation">(</span>fit3<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Post.SD pi.lower pi.upper     Rhat    Prior       </span><br><span class="line">  sat_m <span class="operator">~</span>                                                                      </span><br><span class="line">    pem_m     <span class="punctuation">(</span>a1<span class="punctuation">)</span>    <span class="number">0.219</span>    <span class="number">0.061</span>    <span class="number">0.101</span>    <span class="number">0.337</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">    nem_m     <span class="punctuation">(</span>a2<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.335</span>    <span class="number">0.061</span>   <span class="operator">-</span><span class="number">0.455</span>   <span class="operator">-</span><span class="number">0.215</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">    prel_m    <span class="punctuation">(</span>a3<span class="punctuation">)</span>    <span class="number">0.184</span>    <span class="number">0.063</span>    <span class="number">0.060</span>    <span class="number">0.307</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">    nrel_m    <span class="punctuation">(</span>a4<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.121</span>    <span class="number">0.063</span>   <span class="operator">-</span><span class="number">0.245</span>    <span class="number">0.002</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">  pem_m <span class="operator">~</span>                                                                      </span><br><span class="line">    prel_m     <span class="punctuation">(</span>b<span class="punctuation">)</span>    <span class="number">0.257</span>    <span class="number">0.062</span>    <span class="number">0.135</span>    <span class="number">0.378</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">  nem_m <span class="operator">~</span>                                                                      </span><br><span class="line">    nrel_m     <span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">)</span>    <span class="number">0.297</span>    <span class="number">0.061</span>    <span class="number">0.177</span>    <span class="number">0.415</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Post.SD pi.lower pi.upper     Rhat    Prior       </span><br><span class="line">   .sat_m             <span class="number">1.420</span>    <span class="number">0.126</span>    <span class="number">1.194</span>    <span class="number">1.689</span>    <span class="number">1.000</span> <span class="built_in">gamma</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">.5</span><span class="punctuation">)</span><span class="punctuation">[</span>sd<span class="punctuation">]</span></span><br><span class="line">   .pem_m             <span class="number">1.503</span>    <span class="number">0.134</span>    <span class="number">1.264</span>    <span class="number">1.791</span>    <span class="number">1.000</span> <span class="built_in">gamma</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">.5</span><span class="punctuation">)</span><span class="punctuation">[</span>sd<span class="punctuation">]</span></span><br><span class="line">   .nem_m             <span class="number">1.474</span>    <span class="number">0.132</span>    <span class="number">1.238</span>    <span class="number">1.754</span>    <span class="number">1.000</span> <span class="built_in">gamma</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">.5</span><span class="punctuation">)</span><span class="punctuation">[</span>sd<span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line">Defined Parameters<span class="operator">:</span></span><br><span class="line">                   Estimate  Post.SD pi.lower pi.upper     Rhat    Prior       </span><br><span class="line">    ind_pem_sat       <span class="number">0.056</span>    <span class="number">0.021</span>    <span class="number">0.015</span>    <span class="number">0.097</span>                         </span><br><span class="line">    ind_nem_sat      <span class="operator">-</span><span class="number">0.099</span>    <span class="number">0.028</span>   <span class="operator">-</span><span class="number">0.154</span>   <span class="operator">-</span><span class="number">0.045</span>                         </span><br></pre></td></tr></table></figure>
<p>可以看出<code>ind_pem_sat</code>中介效应的95%置信区间估计为[0.015, 0.097]，<code>ind_nem_sat</code>中介效应的95%置信区间估计为[-0.154, -0.045]</p>
<h2 id="潜变量中介分析">潜变量中介分析</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 潜变量中介模型</span></span><br><span class="line">med_latent_model <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 测量模型</span></span><br><span class="line"><span class="string">  nrel =~ nrel1 + nrel2 + nrel3</span></span><br><span class="line"><span class="string">  prel =~ prel1 + prel2 + prel3</span></span><br><span class="line"><span class="string">  nem =~ nem1 + nem2 + nem3</span></span><br><span class="line"><span class="string">  pem =~ pem1 + pem2 + pem3</span></span><br><span class="line"><span class="string">  sat =~ sat1 + sat2 + sat3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 结构模型</span></span><br><span class="line"><span class="string">  sat ~ a1*pem + a2*nem + a3*prel + a4*nrel</span></span><br><span class="line"><span class="string">  pem ~ b*prel</span></span><br><span class="line"><span class="string">  nem ~ c*nrel</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 间接效应</span></span><br><span class="line"><span class="string">  # sat 对 pem 通过 prel</span></span><br><span class="line"><span class="string">  sat_prel_prel := b * a1</span></span><br><span class="line"><span class="string">  # sat 对 nem 通过 nrel</span></span><br><span class="line"><span class="string">  sat_nrel_nrel := c * a2</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拟合模型</span></span><br><span class="line">fit3 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>med_latent_model<span class="punctuation">,</span> data<span class="operator">=</span>data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit3<span class="punctuation">,</span> fit.measures<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">layout_matrix <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">11</span><span class="punctuation">,</span> <span class="built_in">dimnames</span> <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="literal">NULL</span><span class="punctuation">,</span> <span class="literal">NULL</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;prel1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;prel2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;prel3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;prel&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nrel1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nrel2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">9</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nrel3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nrel&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;pem1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;pem2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;pem3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;pem&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;sat1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;sat2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;sat3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;sat&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">9</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nem1&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nem2&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">11</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nem3&quot;</span></span><br><span class="line">layout_matrix<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;nem&quot;</span></span><br><span class="line">graph_sem<span class="punctuation">(</span>fit3<span class="punctuation">,</span> layout <span class="operator">=</span> layout_matrix<span class="punctuation">,</span> text_size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240617202234196.png" alt="潜变量中介分析"></p>
<p>模型拟合结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                <span class="number">80.049</span></span><br><span class="line">  Degrees of freedom                                <span class="number">83</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.571</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">714.854</span></span><br><span class="line">  Degrees of freedom                               <span class="number">105</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">1.000</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">1.006</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>              <span class="operator">-</span><span class="number">7162.602</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>      <span class="operator">-</span><span class="number">7122.577</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                               <span class="number">14399.204</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                             <span class="number">14530.950</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>      <span class="number">14413.645</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.032</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">1.000</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.043</span></span><br></pre></td></tr></table></figure>
<p>参数估计结果与标准化参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">Latent Variables<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  nrel <span class="operator">=</span><span class="operator">~</span>                                                               </span><br><span class="line">    nrel1             <span class="number">1.000</span>                               <span class="number">1.051</span>    <span class="number">0.633</span></span><br><span class="line">    nrel2             <span class="number">0.782</span>    <span class="number">0.147</span>    <span class="number">5.334</span>    <span class="number">0.000</span>    <span class="number">0.822</span>    <span class="number">0.524</span></span><br><span class="line">    nrel3             <span class="number">0.989</span>    <span class="number">0.179</span>    <span class="number">5.515</span>    <span class="number">0.000</span>    <span class="number">1.039</span>    <span class="number">0.614</span></span><br><span class="line">  prel <span class="operator">=</span><span class="operator">~</span>                                                               </span><br><span class="line">    prel1             <span class="number">1.000</span>                               <span class="number">0.736</span>    <span class="number">0.478</span></span><br><span class="line">    prel2             <span class="number">1.422</span>    <span class="number">0.282</span>    <span class="number">5.047</span>    <span class="number">0.000</span>    <span class="number">1.047</span>    <span class="number">0.616</span></span><br><span class="line">    prel3             <span class="number">1.471</span>    <span class="number">0.293</span>    <span class="number">5.022</span>    <span class="number">0.000</span>    <span class="number">1.083</span>    <span class="number">0.654</span></span><br><span class="line">  nem <span class="operator">=</span><span class="operator">~</span>                                                                </span><br><span class="line">    nem1              <span class="number">1.000</span>                               <span class="number">1.004</span>    <span class="number">0.612</span></span><br><span class="line">    nem2              <span class="number">1.045</span>    <span class="number">0.163</span>    <span class="number">6.422</span>    <span class="number">0.000</span>    <span class="number">1.048</span>    <span class="number">0.628</span></span><br><span class="line">    nem3              <span class="number">1.000</span>    <span class="number">0.156</span>    <span class="number">6.399</span>    <span class="number">0.000</span>    <span class="number">1.003</span>    <span class="number">0.621</span></span><br><span class="line">  pem <span class="operator">=</span><span class="operator">~</span>                                                                </span><br><span class="line">    pem1              <span class="number">1.000</span>                               <span class="number">1.090</span>    <span class="number">0.661</span></span><br><span class="line">    pem2              <span class="number">0.894</span>    <span class="number">0.153</span>    <span class="number">5.852</span>    <span class="number">0.000</span>    <span class="number">0.975</span>    <span class="number">0.591</span></span><br><span class="line">    pem3              <span class="number">0.869</span>    <span class="number">0.150</span>    <span class="number">5.809</span>    <span class="number">0.000</span>    <span class="number">0.948</span>    <span class="number">0.573</span></span><br><span class="line">  sat <span class="operator">=</span><span class="operator">~</span>                                                                </span><br><span class="line">    sat1              <span class="number">1.000</span>                               <span class="number">1.065</span>    <span class="number">0.650</span></span><br><span class="line">    sat2              <span class="number">1.189</span>    <span class="number">0.148</span>    <span class="number">8.059</span>    <span class="number">0.000</span>    <span class="number">1.266</span>    <span class="number">0.750</span></span><br><span class="line">    sat3              <span class="number">0.994</span>    <span class="number">0.132</span>    <span class="number">7.557</span>    <span class="number">0.000</span>    <span class="number">1.058</span>    <span class="number">0.627</span></span><br><span class="line"></span><br><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  sat <span class="operator">~</span>                                                                 </span><br><span class="line">    pem       <span class="punctuation">(</span>a1<span class="punctuation">)</span>    <span class="number">0.278</span>    <span class="number">0.099</span>    <span class="number">2.806</span>    <span class="number">0.005</span>    <span class="number">0.285</span>    <span class="number">0.285</span></span><br><span class="line">    nem       <span class="punctuation">(</span>a2<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.498</span>    <span class="number">0.126</span>   <span class="operator">-</span><span class="number">3.963</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">0.469</span>   <span class="operator">-</span><span class="number">0.469</span></span><br><span class="line">    prel      <span class="punctuation">(</span>a3<span class="punctuation">)</span>    <span class="number">0.310</span>    <span class="number">0.147</span>    <span class="number">2.108</span>    <span class="number">0.035</span>    <span class="number">0.215</span>    <span class="number">0.215</span></span><br><span class="line">    nrel      <span class="punctuation">(</span>a4<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.096</span>    <span class="number">0.105</span>   <span class="operator">-</span><span class="number">0.912</span>    <span class="number">0.362</span>   <span class="operator">-</span><span class="number">0.095</span>   <span class="operator">-</span><span class="number">0.095</span></span><br><span class="line">  pem <span class="operator">~</span>                                                                 </span><br><span class="line">    prel       <span class="punctuation">(</span>b<span class="punctuation">)</span>    <span class="number">0.599</span>    <span class="number">0.174</span>    <span class="number">3.440</span>    <span class="number">0.001</span>    <span class="number">0.404</span>    <span class="number">0.404</span></span><br><span class="line">  nem <span class="operator">~</span>                                                                 </span><br><span class="line">    nrel       <span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">)</span>    <span class="number">0.449</span>    <span class="number">0.112</span>    <span class="number">4.017</span>    <span class="number">0.000</span>    <span class="number">0.470</span>    <span class="number">0.470</span></span><br><span class="line"></span><br><span class="line">Covariances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  nrel <span class="operator">~</span><span class="operator">~</span>                                                               </span><br><span class="line">    prel             <span class="operator">-</span><span class="number">0.034</span>    <span class="number">0.075</span>   <span class="operator">-</span><span class="number">0.457</span>    <span class="number">0.648</span>   <span class="operator">-</span><span class="number">0.044</span>   <span class="operator">-</span><span class="number">0.044</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .nrel1             <span class="number">1.653</span>    <span class="number">0.237</span>    <span class="number">6.965</span>    <span class="number">0.000</span>    <span class="number">1.653</span>    <span class="number">0.599</span></span><br><span class="line">   .nrel2             <span class="number">1.779</span>    <span class="number">0.199</span>    <span class="number">8.939</span>    <span class="number">0.000</span>    <span class="number">1.779</span>    <span class="number">0.725</span></span><br><span class="line">   .nrel3             <span class="number">1.787</span>    <span class="number">0.243</span>    <span class="number">7.366</span>    <span class="number">0.000</span>    <span class="number">1.787</span>    <span class="number">0.623</span></span><br><span class="line">   .prel1             <span class="number">1.828</span>    <span class="number">0.193</span>    <span class="number">9.469</span>    <span class="number">0.000</span>    <span class="number">1.828</span>    <span class="number">0.771</span></span><br><span class="line">   .prel2             <span class="number">1.793</span>    <span class="number">0.251</span>    <span class="number">7.151</span>    <span class="number">0.000</span>    <span class="number">1.793</span>    <span class="number">0.621</span></span><br><span class="line">   .prel3             <span class="number">1.570</span>    <span class="number">0.248</span>    <span class="number">6.326</span>    <span class="number">0.000</span>    <span class="number">1.570</span>    <span class="number">0.572</span></span><br><span class="line">   .nem1              <span class="number">1.686</span>    <span class="number">0.204</span>    <span class="number">8.265</span>    <span class="number">0.000</span>    <span class="number">1.686</span>    <span class="number">0.626</span></span><br><span class="line">   .nem2              <span class="number">1.685</span>    <span class="number">0.211</span>    <span class="number">7.971</span>    <span class="number">0.000</span>    <span class="number">1.685</span>    <span class="number">0.605</span></span><br><span class="line">   .nem3              <span class="number">1.602</span>    <span class="number">0.198</span>    <span class="number">8.099</span>    <span class="number">0.000</span>    <span class="number">1.602</span>    <span class="number">0.614</span></span><br><span class="line">   .pem1              <span class="number">1.532</span>    <span class="number">0.228</span>    <span class="number">6.709</span>    <span class="number">0.000</span>    <span class="number">1.532</span>    <span class="number">0.563</span></span><br><span class="line">   .pem2              <span class="number">1.773</span>    <span class="number">0.218</span>    <span class="number">8.130</span>    <span class="number">0.000</span>    <span class="number">1.773</span>    <span class="number">0.651</span></span><br><span class="line">   .pem3              <span class="number">1.835</span>    <span class="number">0.218</span>    <span class="number">8.434</span>    <span class="number">0.000</span>    <span class="number">1.835</span>    <span class="number">0.671</span></span><br><span class="line">   .sat1              <span class="number">1.549</span>    <span class="number">0.181</span>    <span class="number">8.542</span>    <span class="number">0.000</span>    <span class="number">1.549</span>    <span class="number">0.577</span></span><br><span class="line">   .sat2              <span class="number">1.247</span>    <span class="number">0.193</span>    <span class="number">6.456</span>    <span class="number">0.000</span>    <span class="number">1.247</span>    <span class="number">0.437</span></span><br><span class="line">   .sat3              <span class="number">1.724</span>    <span class="number">0.194</span>    <span class="number">8.888</span>    <span class="number">0.000</span>    <span class="number">1.724</span>    <span class="number">0.606</span></span><br><span class="line">    nrel              <span class="number">1.105</span>    <span class="number">0.270</span>    <span class="number">4.094</span>    <span class="number">0.000</span>    <span class="number">1.000</span>    <span class="number">1.000</span></span><br><span class="line">    prel              <span class="number">0.542</span>    <span class="number">0.171</span>    <span class="number">3.179</span>    <span class="number">0.001</span>    <span class="number">1.000</span>    <span class="number">1.000</span></span><br><span class="line">   .nem               <span class="number">0.784</span>    <span class="number">0.195</span>    <span class="number">4.014</span>    <span class="number">0.000</span>    <span class="number">0.779</span>    <span class="number">0.779</span></span><br><span class="line">   .pem               <span class="number">0.994</span>    <span class="number">0.241</span>    <span class="number">4.124</span>    <span class="number">0.000</span>    <span class="number">0.837</span>    <span class="number">0.837</span></span><br><span class="line">   .sat               <span class="number">0.616</span>    <span class="number">0.149</span>    <span class="number">4.141</span>    <span class="number">0.000</span>    <span class="number">0.543</span>    <span class="number">0.543</span></span><br><span class="line"></span><br><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    nrel1             <span class="number">0.401</span></span><br><span class="line">    nrel2             <span class="number">0.275</span></span><br><span class="line">    nrel3             <span class="number">0.377</span></span><br><span class="line">    prel1             <span class="number">0.229</span></span><br><span class="line">    prel2             <span class="number">0.379</span></span><br><span class="line">    prel3             <span class="number">0.428</span></span><br><span class="line">    nem1              <span class="number">0.374</span></span><br><span class="line">    nem2              <span class="number">0.395</span></span><br><span class="line">    nem3              <span class="number">0.386</span></span><br><span class="line">    pem1              <span class="number">0.437</span></span><br><span class="line">    pem2              <span class="number">0.349</span></span><br><span class="line">    pem3              <span class="number">0.329</span></span><br><span class="line">    sat1              <span class="number">0.423</span></span><br><span class="line">    sat2              <span class="number">0.563</span></span><br><span class="line">    sat3              <span class="number">0.394</span></span><br><span class="line">    nem               <span class="number">0.221</span></span><br><span class="line">    pem               <span class="number">0.163</span></span><br><span class="line">    sat               <span class="number">0.457</span></span><br></pre></td></tr></table></figure>
<p>Sobel检验</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Defined Parameters<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">    sat_prel_sat      <span class="number">0.167</span>    <span class="number">0.071</span>    <span class="number">2.348</span>    <span class="number">0.019</span>    <span class="number">0.115</span>    <span class="number">0.115</span></span><br><span class="line">    sat_nrel_sat     <span class="operator">-</span><span class="number">0.224</span>    <span class="number">0.073</span>   <span class="operator">-</span><span class="number">3.054</span>    <span class="number">0.002</span>   <span class="operator">-</span><span class="number">0.221</span>   <span class="operator">-</span><span class="number">0.221</span></span><br></pre></td></tr></table></figure>
<p>结果显示，两个中介效应均显著</p>
<h1>调节效应</h1>
<h2 id="两个连续变量的调节作用">两个连续变量的调节作用</h2>
<p>自变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>、调节变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>与因变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>均为观测变量</p>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/12第十二章 调节效应/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./12_1 mod_1.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="数据介绍与预处理">数据介绍与预处理</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算相关系数矩阵</span></span><br><span class="line">cor_matrix <span class="operator">&lt;-</span> cor<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span> use<span class="operator">=</span><span class="string">&quot;complete.obs&quot;</span><span class="punctuation">)</span></span><br><span class="line">cor.plot<span class="punctuation">(</span>cor_matrix<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612194542521.png" alt="相关矩阵"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 中心化变量</span></span><br><span class="line">data<span class="operator">$</span>CSC <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SC<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CSS <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SS<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准化变量</span></span><br><span class="line">data<span class="operator">$</span>ZSC <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SC<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>ZSS <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SS<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>ZDEP <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>DEP<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建交互项</span></span><br><span class="line">data<span class="operator">$</span>CSSCSC <span class="operator">&lt;-</span> data<span class="operator">$</span>CSC <span class="operator">*</span> data<span class="operator">$</span>CSS</span><br><span class="line">data<span class="operator">$</span>ZSSZSC <span class="operator">&lt;-</span> data<span class="operator">$</span>ZSC <span class="operator">*</span> data<span class="operator">$</span>ZSS</span><br></pre></td></tr></table></figure>
<h3 id="非标准化解">非标准化解</h3>
<p>将自变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>与调节变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>做中心化处理</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 非标准化</span></span><br><span class="line"><span class="comment"># 第一层回归：包括CSS和CSC</span></span><br><span class="line">fit1 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>DEP <span class="operator">~</span> CSS <span class="operator">+</span> CSC<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit1<span class="punctuation">)</span>  <span class="comment"># 输出模型结果</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二层回归：添加交互项CSSCSC</span></span><br><span class="line">fit2 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>DEP <span class="operator">~</span> CSS <span class="operator">+</span> CSC <span class="operator">+</span> CSSCSC<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit2<span class="punctuation">)</span>  <span class="comment"># 输出模型结果</span></span><br><span class="line"></span><br><span class="line">anova<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>回归系数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit1<span class="punctuation">)</span>  <span class="comment"># 输出模型结果</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">2.55711</span>    <span class="number">0.05698</span>  <span class="number">44.874</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">CSS          <span class="number">0.30851</span>    <span class="number">0.09203</span>   <span class="number">3.352</span> <span class="number">0.000937</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">CSC         <span class="operator">-</span><span class="number">0.23512</span>    <span class="number">0.11750</span>  <span class="operator">-</span><span class="number">2.001</span> <span class="number">0.046571</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.8698</span> on <span class="number">230</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06211</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.05395</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">7.615</span> on <span class="number">2</span> and <span class="number">230</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0006274</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit2<span class="punctuation">)</span>  <span class="comment"># 输出模型结果</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">2.55764</span>    <span class="number">0.05652</span>  <span class="number">45.253</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">CSS          <span class="number">0.30119</span>    <span class="number">0.09134</span>   <span class="number">3.298</span>  <span class="number">0.00113</span> <span class="operator">*</span><span class="operator">*</span> </span><br><span class="line">CSC         <span class="operator">-</span><span class="number">0.23638</span>    <span class="number">0.11654</span>  <span class="operator">-</span><span class="number">2.028</span>  <span class="number">0.04369</span> <span class="operator">*</span>  </span><br><span class="line">CSSCSC      <span class="operator">-</span><span class="number">2.29489</span>    <span class="number">1.04575</span>  <span class="operator">-</span><span class="number">2.194</span>  <span class="number">0.02920</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.8627</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08143</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06939</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">6.767</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0002163</span></span><br></pre></td></tr></table></figure>
<p>模型比较结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">  Res.Df    RSS Df Sum of Sq      <span class="built_in">F</span> Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>  </span><br><span class="line"><span class="number">1</span>    <span class="number">230</span> <span class="number">174.02</span>                             </span><br><span class="line"><span class="number">2</span>    <span class="number">229</span> <span class="number">170.44</span>  <span class="number">1</span>    <span class="number">3.5842</span> <span class="number">4.8158</span> <span class="number">0.0292</span> <span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>可以看出，社会支持与工作压力的交互作用<code>CSSCSC</code>显著</p>
<p>绘制工作压力对抑郁的影像图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制影响图</span></span><br><span class="line">points_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  CSC <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span>sd<span class="punctuation">(</span>data<span class="operator">$</span>CSC<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> sd<span class="punctuation">(</span>data<span class="operator">$</span>CSC<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  CSS <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> times <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span> <span class="operator">*</span> sd<span class="punctuation">(</span>data<span class="operator">$</span>CSS<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  Group <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Low SS&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Mean SS&quot;</span><span class="punctuation">,</span> <span class="string">&quot;High SS&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">points_data<span class="operator">$</span>CSSCSC <span class="operator">&lt;-</span> points_data<span class="operator">$</span>CSS <span class="operator">*</span> points_data<span class="operator">$</span>CSC</span><br><span class="line">points_data<span class="operator">$</span>Predicted_DEP <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit2_1<span class="punctuation">,</span> newdata <span class="operator">=</span> points_data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plot<span class="punctuation">(</span>points_data<span class="operator">$</span>CSS<span class="punctuation">,</span> points_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span></span><br><span class="line">     xlab <span class="operator">=</span> <span class="string">&quot;Social Support (Centered)&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;Predicted Depression&quot;</span><span class="punctuation">,</span></span><br><span class="line">     main <span class="operator">=</span> <span class="string">&quot;Effect of Social Support and Work Pressure on Depression&quot;</span><span class="punctuation">)</span></span><br><span class="line">colors <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;green&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> unique<span class="punctuation">(</span>points_data<span class="operator">$</span>Group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  subset_data <span class="operator">&lt;-</span> points_data<span class="punctuation">[</span>points_data<span class="operator">$</span>Group <span class="operator">==</span> i<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">  points<span class="punctuation">(</span>subset_data<span class="operator">$</span>CSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>which<span class="punctuation">(</span>unique<span class="punctuation">(</span>points_data<span class="operator">$</span>Group<span class="punctuation">)</span> <span class="operator">==</span> i<span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">)</span></span><br><span class="line">  lines<span class="punctuation">(</span>subset_data<span class="operator">$</span>CSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>which<span class="punctuation">(</span>unique<span class="punctuation">(</span>points_data<span class="operator">$</span>Group<span class="punctuation">)</span> <span class="operator">==</span> i<span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;topleft&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;-1 SD&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Mean&quot;</span><span class="punctuation">,</span> <span class="string">&quot;+1 SD&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&quot;CSC Levels&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612195659851.png" alt="在不同的社会支持水平上，工作压力对抑郁倾向的影响)"></p>
<h3 id="效应量">效应量</h3>
<p>表示交互作用对因变量变异方差解释与没有解释的变异的比值</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>f</mi><mn>2</mn></msup><mo>=</mo><mfrac><mrow><msubsup><mi>R</mi><mtext>包含交互</mtext><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>R</mi><mtext>不包含交互</mtext><mn>2</mn></msubsup></mrow><mrow><mn>1</mn><mo>−</mo><msubsup><mi>R</mi><mtext>包含交互</mtext><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">f^2 = \frac{R^2 _{包含交互} - R^2 _{不包含交互}}{1 - R^2 _{包含交互}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0585em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4706em;vertical-align:-0.9795em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4065em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">包含交互</span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4247em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">包含交互</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4247em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">不包含交互</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9795em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mn>2</mn></msup><mo>=</mo><mn>0.02</mn></mrow><annotation encoding="application/x-tex">f^2 = 0.02</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.02</span></span></span></span>表示小的效应，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mn>2</mn></msup><mo>=</mo><mn>0.15</mn></mrow><annotation encoding="application/x-tex">f^2 = 0.15</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.15</span></span></span></span>表示中等的效应，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mn>2</mn></msup><mo>=</mo><mn>0.026</mn></mrow><annotation encoding="application/x-tex">f^2 = 0.026</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.026</span></span></span></span>表示大的效应，</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 效应量</span></span><br><span class="line"><span class="comment"># 假设fit_basic和fit_full已经被拟合</span></span><br><span class="line">R2_excluded <span class="operator">&lt;-</span> summary<span class="punctuation">(</span>fit1<span class="punctuation">)</span><span class="operator">$</span>r.squared  <span class="comment"># 基础模型的R^2</span></span><br><span class="line">R2_included <span class="operator">&lt;-</span> summary<span class="punctuation">(</span>fit2<span class="punctuation">)</span><span class="operator">$</span>r.squared   <span class="comment"># 完整模型的R^2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算f^2系数</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="punctuation">(</span>R2_included <span class="operator">-</span> R2_excluded<span class="punctuation">)</span> <span class="operator">/</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">-</span> R2_included<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.02102979</span></span><br></pre></td></tr></table></figure>
<h3 id="标准化解">标准化解</h3>
<p>自变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>、调节变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>与因变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>做标准化处理</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标准化</span></span><br><span class="line">fit3 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> ZSC<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit3<span class="punctuation">)</span>  <span class="comment"># 输出模型结果</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二层回归：添加交互项CSSCSC</span></span><br><span class="line">fit4 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> ZSC <span class="operator">+</span> ZSSZSC<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit4<span class="punctuation">)</span>  <span class="comment"># 输出模型结果</span></span><br><span class="line"></span><br><span class="line">anova<span class="punctuation">(</span>fit3<span class="punctuation">,</span> fit4<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>回归系数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit3<span class="punctuation">)</span>  <span class="comment"># 输出模型结果</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">              Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">3.933e-16</span>  <span class="number">6.372e-02</span>   <span class="number">0.000</span> <span class="number">1.000000</span>    </span><br><span class="line">ZSS          <span class="number">2.141e-01</span>  <span class="number">6.386e-02</span>   <span class="number">3.352</span> <span class="number">0.000937</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">ZSC         <span class="operator">-</span><span class="number">1.278e-01</span>  <span class="number">6.386e-02</span>  <span class="operator">-</span><span class="number">2.001</span> <span class="number">0.046571</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9726</span> on <span class="number">230</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06211</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.05395</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">7.615</span> on <span class="number">2</span> and <span class="number">230</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0006274</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit4<span class="punctuation">)</span>  <span class="comment"># 输出模型结果</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>   </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">0.000597</span>   <span class="number">0.063199</span>   <span class="number">0.009</span>  <span class="number">0.99247</span>   </span><br><span class="line">ZSS          <span class="number">0.208985</span>   <span class="number">0.063377</span>   <span class="number">3.298</span>  <span class="number">0.00113</span> <span class="operator">*</span><span class="operator">*</span></span><br><span class="line">ZSC         <span class="operator">-</span><span class="number">0.128460</span>   <span class="number">0.063335</span>  <span class="operator">-</span><span class="number">2.028</span>  <span class="number">0.04369</span> <span class="operator">*</span> </span><br><span class="line">ZSSZSC      <span class="operator">-</span><span class="number">0.773876</span>   <span class="number">0.352644</span>  <span class="operator">-</span><span class="number">2.194</span>  <span class="number">0.02920</span> <span class="operator">*</span> </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9647</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08143</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06939</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">6.767</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0002163</span></span><br></pre></td></tr></table></figure>
<p>绘制工作压力对抑郁的影像图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制影响图</span></span><br><span class="line">points_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  ZSC <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  ZSS <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> times <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  Group <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Low SS&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Mean SS&quot;</span><span class="punctuation">,</span> <span class="string">&quot;High SS&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">points_data<span class="operator">$</span>ZSSZSC <span class="operator">&lt;-</span> points_data<span class="operator">$</span>ZSS <span class="operator">*</span> points_data<span class="operator">$</span>ZSC</span><br><span class="line">points_data<span class="operator">$</span>Predicted_DEP <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit4<span class="punctuation">,</span> newdata <span class="operator">=</span> points_data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plot<span class="punctuation">(</span>points_data<span class="operator">$</span>ZSS<span class="punctuation">,</span> points_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span></span><br><span class="line">     xlab <span class="operator">=</span> <span class="string">&quot;Social Support (Centered)&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;Predicted Depression&quot;</span><span class="punctuation">,</span></span><br><span class="line">     main <span class="operator">=</span> <span class="string">&quot;Effect of Social Support and Work Pressure on Depression&quot;</span><span class="punctuation">)</span></span><br><span class="line">colors <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;green&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> unique<span class="punctuation">(</span>points_data<span class="operator">$</span>Group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  subset_data <span class="operator">&lt;-</span> points_data<span class="punctuation">[</span>points_data<span class="operator">$</span>Group <span class="operator">==</span> i<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">  points<span class="punctuation">(</span>subset_data<span class="operator">$</span>ZSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>which<span class="punctuation">(</span>unique<span class="punctuation">(</span>points_data<span class="operator">$</span>Group<span class="punctuation">)</span> <span class="operator">==</span> i<span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">)</span></span><br><span class="line">  lines<span class="punctuation">(</span>subset_data<span class="operator">$</span>ZSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>which<span class="punctuation">(</span>unique<span class="punctuation">(</span>points_data<span class="operator">$</span>Group<span class="punctuation">)</span> <span class="operator">==</span> i<span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;topleft&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;-1 SD&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Mean&quot;</span><span class="punctuation">,</span> <span class="string">&quot;+1 SD&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&quot;CSC Levels&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612200925022.png" alt="在不同的社会支持水平上，工作压力对抑郁倾向的影响"></p>
<h3 id="简单斜率检验">简单斜率检验</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 简单斜率检验</span></span><br><span class="line"><span class="comment"># 创建交互项并为M低于均值一个标准差时的简单斜率添加变量</span></span><br><span class="line">data <span class="operator">&lt;-</span> data <span class="operator">%&gt;%</span></span><br><span class="line">  mutate<span class="punctuation">(</span></span><br><span class="line">    ZSCBELOW <span class="operator">=</span> ZSC <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span>  <span class="comment"># ZSC低于均值一个标准差</span></span><br><span class="line">    ZSS_ZSCBELOW <span class="operator">=</span> ZSS <span class="operator">*</span> ZSCBELOW<span class="punctuation">,</span>  <span class="comment"># 交互项</span></span><br><span class="line">    ZSCABOVE <span class="operator">=</span> ZSC <span class="operator">-</span> <span class="number">1</span><span class="punctuation">,</span>  <span class="comment"># ZSC高于均值一个标准差</span></span><br><span class="line">    ZSS_ZSCABOVE <span class="operator">=</span> ZSS <span class="operator">*</span> ZSCABOVE   <span class="comment"># 交互项</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一步回归：基本效应模型（没有交互项）</span></span><br><span class="line"><span class="comment"># fit3 &lt;- lm(ZDEP ~ ZSS + ZSC, data = data)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit3<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二步回归：测试M低于均值一个标准差时的简单斜率</span></span><br><span class="line">fit_below <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> ZSCBELOW <span class="operator">+</span> ZSS_ZSCBELOW<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_below<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第三步回归：测试M高于均值一个标准差时的简单斜率</span></span><br><span class="line">fit_above <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> ZSCABOVE <span class="operator">+</span> ZSS_ZSCABOVE<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_above<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>M低于均值一个标准差时的回归系数结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>   </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   <span class="number">0.12906</span>    <span class="number">0.08947</span>   <span class="number">1.442</span>  <span class="number">0.15056</span>   </span><br><span class="line">ZSS           <span class="number">0.98286</span>    <span class="number">0.35601</span>   <span class="number">2.761</span>  <span class="number">0.00623</span> <span class="operator">*</span><span class="operator">*</span></span><br><span class="line">ZSCBELOW     <span class="operator">-</span><span class="number">0.12846</span>    <span class="number">0.06334</span>  <span class="operator">-</span><span class="number">2.028</span>  <span class="number">0.04369</span> <span class="operator">*</span> </span><br><span class="line">ZSS_ZSCBELOW <span class="operator">-</span><span class="number">0.77388</span>    <span class="number">0.35264</span>  <span class="operator">-</span><span class="number">2.194</span>  <span class="number">0.02920</span> <span class="operator">*</span> </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9647</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08143</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06939</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">6.767</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0002163</span></span><br></pre></td></tr></table></figure>
<p><code>ZSS</code>的斜率系数<code>Estimate</code>为0.98286，<code>Pr(&gt;|t|)</code>为0.00623，表明当社会支持水平低的时候，工作压力对抑郁倾向有显著的正向影响</p>
<p>M高于均值一个标准差时的回归系数结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>  </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="operator">-</span><span class="number">0.12786</span>    <span class="number">0.08947</span>  <span class="operator">-</span><span class="number">1.429</span>   <span class="number">0.1543</span>  </span><br><span class="line">ZSS          <span class="operator">-</span><span class="number">0.56489</span>    <span class="number">0.36057</span>  <span class="operator">-</span><span class="number">1.567</span>   <span class="number">0.1186</span>  </span><br><span class="line">ZSCABOVE     <span class="operator">-</span><span class="number">0.12846</span>    <span class="number">0.06334</span>  <span class="operator">-</span><span class="number">2.028</span>   <span class="number">0.0437</span> <span class="operator">*</span></span><br><span class="line">ZSS_ZSCABOVE <span class="operator">-</span><span class="number">0.77388</span>    <span class="number">0.35264</span>  <span class="operator">-</span><span class="number">2.194</span>   <span class="number">0.0292</span> <span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9647</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08143</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06939</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">6.767</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0002163</span></span><br></pre></td></tr></table></figure>
<p><code>ZSS</code>的斜率系数<code>Estimate</code>为-0.56489，<code>Pr(&gt;|t|)</code>为0.1186，表明当社会支持水平高的时候，工作压力对抑郁倾向的影响不显著</p>
<h2 id="连续变量与分类变量的调节作用">连续变量与分类变量的调节作用</h2>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/12第十二章 调节效应/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./12_1 mod_1.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="虚拟编码后的调教效应检验">虚拟编码后的调教效应检验</h3>
<h4 id="虚拟编码与数据预处理">虚拟编码与数据预处理</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 男性编码为0，女性编码为1</span></span><br><span class="line"><span class="comment"># 转换性别为因子变量</span></span><br><span class="line">data<span class="operator">$</span>SEX <span class="operator">=</span> data<span class="operator">$</span>SEX <span class="operator">-</span> <span class="number">1</span></span><br><span class="line">table<span class="punctuation">(</span>data<span class="operator">$</span>SEX<span class="punctuation">)</span>  <span class="comment"># 查看性别分布</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 中心化变量</span></span><br><span class="line">data<span class="operator">$</span>CSC <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SC<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CSS <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SS<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准化变量</span></span><br><span class="line">data<span class="operator">$</span>ZSC <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SC<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>ZSS <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SS<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>ZDEP <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>DEP<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建交互项</span></span><br><span class="line">data<span class="operator">$</span>GENDERCSS <span class="operator">&lt;-</span> data<span class="operator">$</span>SEX <span class="operator">*</span> data<span class="operator">$</span>CSS</span><br><span class="line">data<span class="operator">$</span>GENDERZSS <span class="operator">&lt;-</span> data<span class="operator">$</span>SEX <span class="operator">*</span> data<span class="operator">$</span>ZSS</span><br></pre></td></tr></table></figure>
<h4 id="非标准化回归系数">非标准化回归系数</h4>
<p>对自变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>进行中心化处理</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 非标准化</span></span><br><span class="line"><span class="comment"># 层次回归分析</span></span><br><span class="line">fit5 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>DEP <span class="operator">~</span> CSS <span class="operator">+</span> SEX<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit5<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">fit6 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>DEP <span class="operator">~</span> CSS <span class="operator">+</span> SEX <span class="operator">+</span> GENDERCSS<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit6<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>回归系数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit5<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">2.67996</span>    <span class="number">0.08079</span>  <span class="number">33.172</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">CSS          <span class="number">0.33877</span>    <span class="number">0.09301</span>   <span class="number">3.642</span> <span class="number">0.000334</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">SEX         <span class="operator">-</span><span class="number">0.24675</span>    <span class="number">0.11518</span>  <span class="operator">-</span><span class="number">2.142</span> <span class="number">0.033211</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.8687</span> on <span class="number">230</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06445</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.05632</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">7.923</span> on <span class="number">2</span> and <span class="number">230</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0004706</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit6<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">2.69864</span>    <span class="number">0.08056</span>  <span class="number">33.498</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">CSS          <span class="number">0.53737</span>    <span class="number">0.12876</span>   <span class="number">4.173</span> <span class="number">4.26e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">SEX         <span class="operator">-</span><span class="number">0.24558</span>    <span class="number">0.11422</span>  <span class="operator">-</span><span class="number">2.150</span>   <span class="number">0.0326</span> <span class="operator">*</span>  </span><br><span class="line">GENDERCSS   <span class="operator">-</span><span class="number">0.40787</span>    <span class="number">0.18452</span>  <span class="operator">-</span><span class="number">2.210</span>   <span class="number">0.0281</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.8615</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08399</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.07199</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>     <span class="number">7</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0001592</span></span><br></pre></td></tr></table></figure>
<p>绘制影响图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制影响图</span></span><br><span class="line">points_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  CSS <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> times <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">*</span> sd<span class="punctuation">(</span>data<span class="operator">$</span>CSS<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  SEX <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">points_data<span class="operator">$</span>GENDERCSS <span class="operator">&lt;-</span> points_data<span class="operator">$</span>CSS <span class="operator">*</span> points_data<span class="operator">$</span>SEX</span><br><span class="line">points_data<span class="operator">$</span>Predicted_DEP <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit6<span class="punctuation">,</span> newdata <span class="operator">=</span> points_data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plot<span class="punctuation">(</span>points_data<span class="operator">$</span>CSS<span class="punctuation">,</span> points_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span></span><br><span class="line">     xlab <span class="operator">=</span> <span class="string">&quot;Social Support (Centered)&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;Predicted Depression&quot;</span><span class="punctuation">,</span></span><br><span class="line">     main <span class="operator">=</span> <span class="string">&quot;Effect of Gender and Social Support on Depression&quot;</span><span class="punctuation">)</span></span><br><span class="line">colors <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>sex <span class="keyword">in</span> unique<span class="punctuation">(</span>points_data<span class="operator">$</span>SEX<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  subset_data <span class="operator">&lt;-</span> points_data<span class="punctuation">[</span>points_data<span class="operator">$</span>SEX <span class="operator">==</span> sex<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">  points<span class="punctuation">(</span>subset_data<span class="operator">$</span>CSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>sex <span class="operator">+</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">)</span></span><br><span class="line">  lines<span class="punctuation">(</span>subset_data<span class="operator">$</span>CSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>sex <span class="operator">+</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;topleft&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Female&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Male&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&quot;Gender&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612203324306.png" alt="不同性别的工作压力对抑郁倾向的影响"></p>
<p><strong>效应量</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设fit_basic和fit_full已经被拟合</span></span><br><span class="line">R2_excluded <span class="operator">&lt;-</span> summary<span class="punctuation">(</span>fit5<span class="punctuation">)</span><span class="operator">$</span>r.squared  <span class="comment"># 基础模型的R^2</span></span><br><span class="line">R2_included <span class="operator">&lt;-</span> summary<span class="punctuation">(</span>fit6<span class="punctuation">)</span><span class="operator">$</span>r.squared   <span class="comment"># 完整模型的R^2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算f^2系数</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="punctuation">(</span>R2_included <span class="operator">-</span> R2_excluded<span class="punctuation">)</span> <span class="operator">/</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">-</span> R2_included<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.02133518</span></span><br></pre></td></tr></table></figure>
<h4 id="标准化回归系数">标准化回归系数</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标准化</span></span><br><span class="line"><span class="comment"># 层次回归分析</span></span><br><span class="line">fit7 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> SEX<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit7<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">fit8 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> SEX <span class="operator">+</span> GENDERZSS<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit8<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>回归系数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit7<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">0.13737</span>    <span class="number">0.09034</span>   <span class="number">1.521</span> <span class="number">0.129742</span>    </span><br><span class="line">ZSS          <span class="number">0.23506</span>    <span class="number">0.06453</span>   <span class="number">3.642</span> <span class="number">0.000334</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">SEX         <span class="operator">-</span><span class="number">0.27592</span>    <span class="number">0.12879</span>  <span class="operator">-</span><span class="number">2.142</span> <span class="number">0.033211</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9714</span> on <span class="number">230</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06445</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.05632</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">7.923</span> on <span class="number">2</span> and <span class="number">230</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0004706</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit8<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">0.15826</span>    <span class="number">0.09008</span>   <span class="number">1.757</span>   <span class="number">0.0803</span> .  </span><br><span class="line">ZSS          <span class="number">0.37286</span>    <span class="number">0.08934</span>   <span class="number">4.173</span> <span class="number">4.26e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">SEX         <span class="operator">-</span><span class="number">0.27461</span>    <span class="number">0.12772</span>  <span class="operator">-</span><span class="number">2.150</span>   <span class="number">0.0326</span> <span class="operator">*</span>  </span><br><span class="line">GENDERZSS   <span class="operator">-</span><span class="number">0.28300</span>    <span class="number">0.12803</span>  <span class="operator">-</span><span class="number">2.210</span>   <span class="number">0.0281</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9633</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08399</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.07199</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>     <span class="number">7</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0001592</span></span><br></pre></td></tr></table></figure>
<p>绘制影响图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制影响图</span></span><br><span class="line">points_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  ZSS <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> times <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  SEX <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">points_data<span class="operator">$</span>GENDERZSS <span class="operator">&lt;-</span> points_data<span class="operator">$</span>ZSS <span class="operator">*</span> points_data<span class="operator">$</span>SEX</span><br><span class="line">points_data<span class="operator">$</span>Predicted_DEP <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit8<span class="punctuation">,</span> newdata <span class="operator">=</span> points_data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plot<span class="punctuation">(</span>points_data<span class="operator">$</span>ZSS<span class="punctuation">,</span> points_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span></span><br><span class="line">     xlab <span class="operator">=</span> <span class="string">&quot;Social Support (Centered)&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;Predicted Depression&quot;</span><span class="punctuation">,</span></span><br><span class="line">     main <span class="operator">=</span> <span class="string">&quot;Effect of Gender and Social Support on Depression&quot;</span><span class="punctuation">)</span></span><br><span class="line">colors <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>sex <span class="keyword">in</span> unique<span class="punctuation">(</span>points_data<span class="operator">$</span>SEX<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  subset_data <span class="operator">&lt;-</span> points_data<span class="punctuation">[</span>points_data<span class="operator">$</span>SEX <span class="operator">==</span> sex<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">  points<span class="punctuation">(</span>subset_data<span class="operator">$</span>ZSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>sex <span class="operator">+</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">)</span></span><br><span class="line">  lines<span class="punctuation">(</span>subset_data<span class="operator">$</span>ZSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>sex <span class="operator">+</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;topleft&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Female&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Male&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&quot;Gender&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612203849436.png" alt="不同性别的工作压力对抑郁倾向的影响"></p>
<p><strong>简单斜率检验</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 简单斜率检验</span></span><br><span class="line"><span class="comment"># 将性别编码颠倒：原来男性为0，女性为1，现在女性为0，男性为1</span></span><br><span class="line">data<span class="operator">$</span>SEX_N <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>data<span class="operator">$</span>SEX <span class="operator">==</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建交互项并为性别低于均值一个标准差时的简单斜率添加变量</span></span><br><span class="line">data<span class="operator">$</span>GENDER_NZSS <span class="operator">&lt;-</span> data<span class="operator">$</span>SEX_N <span class="operator">*</span> data<span class="operator">$</span>ZSS</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一步回归：基本效应模型（没有交互项）</span></span><br><span class="line"><span class="comment"># fit7 &lt;- lm(ZDEP ~ ZSS + SEX, data = data)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit7<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试性别为男性时的简单斜率</span></span><br><span class="line">fit_N <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> SEX_N <span class="operator">+</span> GENDER_NZSS<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_N<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>  </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">0.11635</span>    <span class="number">0.09054</span>  <span class="operator">-</span><span class="number">1.285</span>   <span class="number">0.2000</span>  </span><br><span class="line">ZSS          <span class="number">0.08986</span>    <span class="number">0.09171</span>   <span class="number">0.980</span>   <span class="number">0.3282</span>  </span><br><span class="line">SEX_N        <span class="number">0.27461</span>    <span class="number">0.12772</span>   <span class="number">2.150</span>   <span class="number">0.0326</span> <span class="operator">*</span></span><br><span class="line">GENDER_NZSS  <span class="number">0.28300</span>    <span class="number">0.12803</span>   <span class="number">2.210</span>   <span class="number">0.0281</span> <span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9633</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08399</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.07199</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>     <span class="number">7</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0001592</span></span><br></pre></td></tr></table></figure>
<p><code>ZSS</code>的斜率系数<code>Estimate</code>为0.08986，<code>Pr(&gt;|t|)</code>为0.3282，表明对于男性，工作压力对抑郁倾向的影响不显著</p>
<h3 id="非加权效应编码后的调节效应检验">非加权效应编码后的调节效应检验</h3>
<p>非加权效应编码是将分类变量重新编码为-1与+1</p>
<h4 id="非加权效应编码与数据预处理">非加权效应编码与数据预处理</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 女性编码为-1，男性编码为1</span></span><br><span class="line">data<span class="operator">$</span>SEX_G <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>data<span class="operator">$</span>SEX <span class="operator">==</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">table<span class="punctuation">(</span>data<span class="operator">$</span>SEX_G<span class="punctuation">)</span>  <span class="comment"># 查看性别分布</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 中心化变量</span></span><br><span class="line">data<span class="operator">$</span>CSC <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SC<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CSS <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SS<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准化变量</span></span><br><span class="line">data<span class="operator">$</span>ZSC <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SC<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>ZSS <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>SS<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>ZDEP <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>DEP<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建交互项</span></span><br><span class="line">data<span class="operator">$</span>GENDERCSS <span class="operator">&lt;-</span> data<span class="operator">$</span>SEX_G <span class="operator">*</span> data<span class="operator">$</span>CSS</span><br><span class="line">data<span class="operator">$</span>GENDERZSS <span class="operator">&lt;-</span> data<span class="operator">$</span>SEX_G <span class="operator">*</span> data<span class="operator">$</span>ZSS</span><br></pre></td></tr></table></figure>
<h4 id="非标准化回归系数-2">非标准化回归系数</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 非标准化</span></span><br><span class="line"><span class="comment"># 层次回归分析</span></span><br><span class="line">fit9 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>DEP <span class="operator">~</span> CSS <span class="operator">+</span> SEX_G<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit9<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">fit10 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>DEP <span class="operator">~</span> CSS <span class="operator">+</span> SEX_G <span class="operator">+</span> GENDERCSS<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit10<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>回归系数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit9<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">2.55658</span>    <span class="number">0.05691</span>  <span class="number">44.920</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">CSS          <span class="number">0.33877</span>    <span class="number">0.09301</span>   <span class="number">3.642</span> <span class="number">0.000334</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">SEX_G       <span class="operator">-</span><span class="number">0.12338</span>    <span class="number">0.05759</span>  <span class="operator">-</span><span class="number">2.142</span> <span class="number">0.033211</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.8687</span> on <span class="number">230</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06445</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.05632</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">7.923</span> on <span class="number">2</span> and <span class="number">230</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0004706</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit10<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">2.57585</span>    <span class="number">0.05711</span>  <span class="number">45.105</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">CSS          <span class="number">0.33343</span>    <span class="number">0.09226</span>   <span class="number">3.614</span> <span class="number">0.000371</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">SEX_G       <span class="operator">-</span><span class="number">0.12279</span>    <span class="number">0.05711</span>  <span class="operator">-</span><span class="number">2.150</span> <span class="number">0.032593</span> <span class="operator">*</span>  </span><br><span class="line">GENDERCSS   <span class="operator">-</span><span class="number">0.20393</span>    <span class="number">0.09226</span>  <span class="operator">-</span><span class="number">2.210</span> <span class="number">0.028069</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.8615</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08399</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.07199</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>     <span class="number">7</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0001592</span></span><br></pre></td></tr></table></figure>
<p>绘制影响图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制影响图</span></span><br><span class="line">points_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  CSS <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> times <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">*</span> sd<span class="punctuation">(</span>data<span class="operator">$</span>CSS<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  SEX_G <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">points_data<span class="operator">$</span>GENDERCSS <span class="operator">&lt;-</span> points_data<span class="operator">$</span>CSS <span class="operator">*</span> points_data<span class="operator">$</span>SEX_G</span><br><span class="line">points_data<span class="operator">$</span>Predicted_DEP <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit10<span class="punctuation">,</span> newdata <span class="operator">=</span> points_data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plot<span class="punctuation">(</span>points_data<span class="operator">$</span>CSS<span class="punctuation">,</span> points_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span></span><br><span class="line">     xlab <span class="operator">=</span> <span class="string">&quot;Social Support (Centered)&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;Predicted Depression&quot;</span><span class="punctuation">,</span></span><br><span class="line">     main <span class="operator">=</span> <span class="string">&quot;Effect of Gender and Social Support on Depression&quot;</span><span class="punctuation">)</span></span><br><span class="line">colors <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>sex <span class="keyword">in</span> unique<span class="punctuation">(</span>points_data<span class="operator">$</span>SEX_G<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  subset_data <span class="operator">&lt;-</span> points_data<span class="punctuation">[</span>points_data<span class="operator">$</span>SEX_G <span class="operator">==</span> sex<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">  color_index <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>sex <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">  points<span class="punctuation">(</span>subset_data<span class="operator">$</span>CSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>color_index<span class="punctuation">]</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">)</span></span><br><span class="line">  lines<span class="punctuation">(</span>subset_data<span class="operator">$</span>CSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>color_index<span class="punctuation">]</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;topleft&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Female&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Male&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&quot;Gender&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612210542469.png" alt="不同性别的工作压力对抑郁倾向的影响"></p>
<p><strong>效应量</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 效应量</span></span><br><span class="line"><span class="comment"># 假设fit_basic和fit_full已经被拟合</span></span><br><span class="line">R2_excluded <span class="operator">&lt;-</span> summary<span class="punctuation">(</span>fit9<span class="punctuation">)</span><span class="operator">$</span>r.squared  <span class="comment"># 基础模型的R^2</span></span><br><span class="line">R2_included <span class="operator">&lt;-</span> summary<span class="punctuation">(</span>fit10<span class="punctuation">)</span><span class="operator">$</span>r.squared   <span class="comment"># 完整模型的R^2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算f^2系数</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="punctuation">(</span>R2_included <span class="operator">-</span> R2_excluded<span class="punctuation">)</span> <span class="operator">/</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">-</span> R2_included<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.02133518</span></span><br></pre></td></tr></table></figure>
<h4 id="标准化回归系数-2">标准化回归系数</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标准化</span></span><br><span class="line"><span class="comment"># 层次回归分析</span></span><br><span class="line">fit11 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> SEX_G<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit11<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">fit12 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> SEX_G <span class="operator">+</span> GENDERZSS<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit12<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>回归系数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit11<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">              Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">0.0005921</span>  <span class="number">0.0636413</span>  <span class="operator">-</span><span class="number">0.009</span> <span class="number">0.992585</span>    </span><br><span class="line">ZSS          <span class="number">0.2350608</span>  <span class="number">0.0645333</span>   <span class="number">3.642</span> <span class="number">0.000334</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">SEX_G       <span class="operator">-</span><span class="number">0.1379606</span>  <span class="number">0.0643952</span>  <span class="operator">-</span><span class="number">2.142</span> <span class="number">0.033211</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9714</span> on <span class="number">230</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.06445</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.05632</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">7.923</span> on <span class="number">2</span> and <span class="number">230</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0004706</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit12<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">0.02095</span>    <span class="number">0.06386</span>   <span class="number">0.328</span> <span class="number">0.743123</span>    </span><br><span class="line">ZSS          <span class="number">0.23136</span>    <span class="number">0.06402</span>   <span class="number">3.614</span> <span class="number">0.000371</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">SEX_G       <span class="operator">-</span><span class="number">0.13730</span>    <span class="number">0.06386</span>  <span class="operator">-</span><span class="number">2.150</span> <span class="number">0.032593</span> <span class="operator">*</span>  </span><br><span class="line">GENDERZSS   <span class="operator">-</span><span class="number">0.14150</span>    <span class="number">0.06402</span>  <span class="operator">-</span><span class="number">2.210</span> <span class="number">0.028069</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9633</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08399</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.07199</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>     <span class="number">7</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0001592</span></span><br></pre></td></tr></table></figure>
<p>绘制影响图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制影响图</span></span><br><span class="line">points_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  ZSS <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> times <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  SEX_G <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">points_data<span class="operator">$</span>GENDERZSS <span class="operator">&lt;-</span> points_data<span class="operator">$</span>ZSS <span class="operator">*</span> points_data<span class="operator">$</span>SEX</span><br><span class="line">points_data<span class="operator">$</span>Predicted_DEP <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit12<span class="punctuation">,</span> newdata <span class="operator">=</span> points_data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plot<span class="punctuation">(</span>points_data<span class="operator">$</span>ZSS<span class="punctuation">,</span> points_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span></span><br><span class="line">     xlab <span class="operator">=</span> <span class="string">&quot;Social Support (Centered)&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;Predicted Depression&quot;</span><span class="punctuation">,</span></span><br><span class="line">     main <span class="operator">=</span> <span class="string">&quot;Effect of Gender and Social Support on Depression&quot;</span><span class="punctuation">)</span></span><br><span class="line">colors <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>sex <span class="keyword">in</span> unique<span class="punctuation">(</span>points_data<span class="operator">$</span>SEX_G<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  subset_data <span class="operator">&lt;-</span> points_data<span class="punctuation">[</span>points_data<span class="operator">$</span>SEX_G <span class="operator">==</span> sex<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">  color_index <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>sex <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">  points<span class="punctuation">(</span>subset_data<span class="operator">$</span>ZSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>color_index<span class="punctuation">]</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">)</span></span><br><span class="line">  lines<span class="punctuation">(</span>subset_data<span class="operator">$</span>ZSS<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_DEP<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>color_index<span class="punctuation">]</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;topleft&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Female&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Male&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&quot;Gender&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612210856483.png" alt="不同性别的工作压力对抑郁倾向的影响"></p>
<p><strong>简单斜率检验</strong></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 简单斜率检验</span></span><br><span class="line"><span class="comment"># 将性别编码颠倒：原来男性为1，女性为-1，现在女性为-1，男性为1</span></span><br><span class="line">data<span class="operator">$</span>SEX_GN <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>data<span class="operator">$</span>SEX_G <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建交互项并为性别低于均值一个标准差时的简单斜率添加变量</span></span><br><span class="line">data<span class="operator">$</span>GENDER_NZSS <span class="operator">&lt;-</span> data<span class="operator">$</span>SEX_GN <span class="operator">*</span> data<span class="operator">$</span>ZSS</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一步回归：基本效应模型（没有交互项）</span></span><br><span class="line"><span class="comment"># fit11 &lt;- lm(ZDEP ~ ZSS + SEX_G, data = data)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit11<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试性别为男性时的简单斜率</span></span><br><span class="line">fit_N <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>ZDEP <span class="operator">~</span> ZSS <span class="operator">+</span> SEX_GN <span class="operator">+</span> GENDER_NZSS<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_N<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">0.02095</span>    <span class="number">0.06386</span>   <span class="number">0.328</span> <span class="number">0.743123</span>    </span><br><span class="line">ZSS          <span class="number">0.23136</span>    <span class="number">0.06402</span>   <span class="number">3.614</span> <span class="number">0.000371</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">SEX_GN       <span class="number">0.13730</span>    <span class="number">0.06386</span>   <span class="number">2.150</span> <span class="number">0.032593</span> <span class="operator">*</span>  </span><br><span class="line">GENDER_NZSS  <span class="number">0.14150</span>    <span class="number">0.06402</span>   <span class="number">2.210</span> <span class="number">0.028069</span> <span class="operator">*</span>  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.9633</span> on <span class="number">229</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.08399</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.07199</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>     <span class="number">7</span> on <span class="number">3</span> and <span class="number">229</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">0.0001592</span></span><br></pre></td></tr></table></figure>
<p><code>ZSS</code>的斜率系数<code>Estimate</code>为0.23136，<code>Pr(&gt;|t|)</code>为0.000371，表明对于男性，工作压力对抑郁倾向的影响显著</p>
<h2 id="潜变量的调节效应">潜变量的调节效应</h2>
<h3 id="潜变量与分类变量的调节效应分析">潜变量与分类变量的调节效应分析</h3>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/12第十二章 调节效应/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./12_2 mod_2.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>数据分组与介绍</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data<span class="operator">$</span>sex <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>data<span class="operator">$</span>sex<span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;female&quot;</span><span class="punctuation">,</span> <span class="string">&quot;male&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>结构方程模型</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">model <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 测量模型</span></span><br><span class="line"><span class="string">  DEP =~ Y1 + Y2 + Y3</span></span><br><span class="line"><span class="string">  STRESS =~ X1 + X2 + X3</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 结构模型</span></span><br><span class="line"><span class="string">  DEP ~ STRESS</span></span><br><span class="line"><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="结构等价性">结构等价性</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结构等价性</span></span><br><span class="line">fit1 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span> group <span class="operator">=</span> <span class="string">&quot;sex&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit1<span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>模型拟合结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                <span class="number">21.888</span></span><br><span class="line">  Degrees of freedom                                <span class="number">16</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.147</span></span><br><span class="line">  Test statistic <span class="keyword">for</span> each group<span class="operator">:</span></span><br><span class="line">    male                                        <span class="number">16.217</span></span><br><span class="line">    female                                       <span class="number">5.671</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.985</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.971</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.045</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.087</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.533</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.093</span></span><br></pre></td></tr></table></figure>
<p>可以看出<code>RMSEA</code>值为0.045，<code>CFI</code>的值为0.985，<code>TLI</code>的值为0.971，表明模型拟合较好，男女两组满足因子结构等价性。</p>
<h4 id="弱等价性">弱等价性</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 弱等价性</span></span><br><span class="line">fit2 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span> group <span class="operator">=</span> <span class="string">&quot;sex&quot;</span><span class="punctuation">,</span> group.equal <span class="operator">=</span> <span class="string">&quot;loadings&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit2<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">     Df    AIC    BIC  Chisq Chisq diff RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span></span><br><span class="line">fit1 <span class="number">16</span> <span class="number">5916.4</span> <span class="number">6064.8</span> <span class="number">21.888</span>                                    </span><br><span class="line">fit2 <span class="number">20</span> <span class="number">5910.7</span> <span class="number">6043.5</span> <span class="number">24.225</span>     <span class="number">2.3363</span>     <span class="number">0</span>       <span class="number">4</span>     <span class="number">0.6742</span></span><br></pre></td></tr></table></figure>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为2.3363，自由度的差值<code>Df diff</code>为4，表明两个模型的卡方差异不显著。可以接受弱等价模型，即认为男女两组满足因素载荷等价条件。</p>
<h4 id="结构方程系数等价性">结构方程系数等价性</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 回归系数等价性</span></span><br><span class="line">fit3 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span> group <span class="operator">=</span> <span class="string">&quot;sex&quot;</span><span class="punctuation">,</span> group.equal <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;regressions&quot;</span><span class="punctuation">,</span> <span class="string">&quot;loadings&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit3<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anova<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit2<span class="punctuation">,</span> fit3<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit2<span class="punctuation">,</span> fit3<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Chi<span class="operator">-</span>Squared Difference Test</span><br><span class="line"></span><br><span class="line">     Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr<span class="punctuation">(</span><span class="operator">&gt;</span>Chisq<span class="punctuation">)</span>  </span><br><span class="line">fit1 <span class="number">16</span> <span class="number">5916.4</span> <span class="number">6064.8</span> <span class="number">21.888</span>                                        </span><br><span class="line">fit2 <span class="number">20</span> <span class="number">5910.7</span> <span class="number">6043.5</span> <span class="number">24.225</span>     <span class="number">2.3363</span> <span class="number">0.00000</span>       <span class="number">4</span>    <span class="number">0.67416</span>  </span><br><span class="line">fit3 <span class="number">21</span> <span class="number">5911.8</span> <span class="number">6040.7</span> <span class="number">27.317</span>     <span class="number">3.0923</span> <span class="number">0.10678</span>       <span class="number">1</span>    <span class="number">0.07866</span> .</span><br></pre></td></tr></table></figure>
<p>可以看出两个模型的卡方值的差值<code>Chisq diff</code>为3.0923，自由度的差值<code>Df diff</code>为1，表明两个模型的卡方差异不显著。可以接受潜变量路径系数等价模型，即认为男女两组满足路径系数等价条件。即性别在压力对抑郁的影响中的调节作用不显著。</p>
<h3 id="潜变量与潜变量的调节效应分析">潜变量与潜变量的调节效应分析</h3>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/12第十二章 调节效应/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./12_6 mod_3.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>数据介绍与数据预处理</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 中心化变量</span></span><br><span class="line">data<span class="operator">$</span>CCON1 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>CON1<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CCON2 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>CON2<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CCON3 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>CON3<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CCON4 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>CON4<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CDEP1 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>DEP1<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CDEP2 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>DEP2<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CDEP3 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>DEP3<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>CDEP4 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>DEP4<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 乘积指标</span></span><br><span class="line">data<span class="operator">$</span>CCON1CDEP1 <span class="operator">&lt;-</span> data<span class="operator">$</span>CCON1 <span class="operator">*</span> data<span class="operator">$</span>CDEP1</span><br><span class="line">data<span class="operator">$</span>CCON2CDEP2 <span class="operator">&lt;-</span> data<span class="operator">$</span>CCON2 <span class="operator">*</span> data<span class="operator">$</span>CDEP2</span><br><span class="line">data<span class="operator">$</span>CCON3CDEP3 <span class="operator">&lt;-</span> data<span class="operator">$</span>CCON3 <span class="operator">*</span> data<span class="operator">$</span>CDEP3</span><br><span class="line">data<span class="operator">$</span>CCON4CDEP4 <span class="operator">&lt;-</span> data<span class="operator">$</span>CCON4 <span class="operator">*</span> data<span class="operator">$</span>CDEP4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 乘积指标二次中心化</span></span><br><span class="line">data<span class="operator">$</span>C_CCON1CDEP1 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>CCON1CDEP1<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>C_CCON2CDEP2 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>CCON2CDEP2<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>C_CCON3CDEP3 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>CCON3CDEP3<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>C_CCON4CDEP4 <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="operator">$</span>CCON4CDEP4<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h4 id="乘积指标法">乘积指标法</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">model <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 测量模型</span></span><br><span class="line"><span class="string">  CON =~ CCON1 + CCON2 + CCON3 + CCON4</span></span><br><span class="line"><span class="string">  DEP =~ CDEP1 + CDEP2 + CDEP3 + CDEP4</span></span><br><span class="line"><span class="string">  CONDEP =~ C_CCON1CDEP1 + C_CCON2CDEP2 + C_CCON3CDEP3 + C_CCON4CDEP4</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 结构模型</span></span><br><span class="line"><span class="string">  ALC ~ CON + DEP + CONDEP</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 显示截距</span></span><br><span class="line"><span class="string">  ALC ~ 1</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line">fit <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span> estimator <span class="operator">=</span> <span class="string">&quot;ML&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit<span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>绘制影响图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制影响图</span></span><br><span class="line">points_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  CON <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">sqrt</span><span class="punctuation">(</span>coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">[</span><span class="string">&quot;CON~~CON&quot;</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  DEP <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">2</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> times <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">sqrt</span><span class="punctuation">(</span>coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">[</span><span class="string">&quot;DEP~~DEP&quot;</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">points_data<span class="operator">$</span>CONDEP <span class="operator">&lt;-</span> points_data<span class="operator">$</span>CON <span class="operator">*</span> points_data<span class="operator">$</span>DEP</span><br><span class="line">calculate_ALC <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>df<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  ALC <span class="operator">=</span> coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">[</span><span class="string">&quot;ALC~1&quot;</span><span class="punctuation">]</span> <span class="operator">+</span> coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">[</span><span class="string">&quot;ALC~CON&quot;</span><span class="punctuation">]</span> <span class="operator">*</span> df<span class="operator">$</span>CON <span class="operator">+</span> coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">[</span><span class="string">&quot;ALC~DEP&quot;</span><span class="punctuation">]</span> <span class="operator">*</span> df<span class="operator">$</span>DEP <span class="operator">+</span> coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">[</span><span class="string">&quot;ALC~CONDEP&quot;</span><span class="punctuation">]</span> <span class="operator">*</span> df<span class="operator">$</span>CONDEP</span><br><span class="line">  <span class="built_in">return</span><span class="punctuation">(</span>ALC<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">points_data<span class="operator">$</span>Predicted_ALC <span class="operator">&lt;-</span> calculate_ALC<span class="punctuation">(</span>points_data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plot<span class="punctuation">(</span>points_data<span class="operator">$</span>CON<span class="punctuation">,</span> points_data<span class="operator">$</span>Predicted_ALC<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span></span><br><span class="line">     xlab <span class="operator">=</span> <span class="string">&quot;CON&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;pre_ALC&quot;</span><span class="punctuation">,</span></span><br><span class="line">     main <span class="operator">=</span> <span class="string">&quot;Effect of DEP and CON on ALC&quot;</span><span class="punctuation">)</span></span><br><span class="line">colors <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;green&quot;</span><span class="punctuation">,</span> <span class="string">&quot;yellow&quot;</span><span class="punctuation">,</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span></span><br><span class="line">points_data<span class="operator">$</span>DEP_index <span class="operator">&lt;-</span> points_data<span class="operator">$</span>DEP<span class="operator">/</span><span class="built_in">sqrt</span><span class="punctuation">(</span>coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">[</span><span class="string">&quot;DEP~~DEP&quot;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">*</span><span class="built_in">abs</span><span class="punctuation">(</span>points_data<span class="operator">$</span>CON<span class="punctuation">)</span><span class="operator">/</span><span class="built_in">sqrt</span><span class="punctuation">(</span>coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">[</span><span class="string">&quot;CON~~CON&quot;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="number">3</span></span><br><span class="line"><span class="comment"># 使用新的变量来索引颜色</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>index <span class="keyword">in</span> unique<span class="punctuation">(</span>points_data<span class="operator">$</span>DEP_index<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  subset_data <span class="operator">&lt;-</span> points_data<span class="punctuation">[</span>points_data<span class="operator">$</span>DEP_index <span class="operator">==</span> index<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">  points<span class="punctuation">(</span>subset_data<span class="operator">$</span>CON<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_ALC<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>index<span class="punctuation">]</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">)</span></span><br><span class="line">  lines<span class="punctuation">(</span>subset_data<span class="operator">$</span>CON<span class="punctuation">,</span> subset_data<span class="operator">$</span>Predicted_ALC<span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">[</span>index<span class="punctuation">]</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;topleft&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">2</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colors<span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&quot;DEP&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/image-20240612213817328.png" alt="在不同的抑郁症状水平上，问题行为对饮酒行为对影响"></p>
<h4 id="潜调节结构方程">潜调节结构方程</h4>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/12第十二章 调节效应/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./12_6 mod_3.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>描述数据与数据预处理</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准化数据</span></span><br><span class="line">data<span class="punctuation">[</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;CCON1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CCON2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CCON3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CCON4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CDEP1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CDEP2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CDEP3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CDEP4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CALC&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;CON1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CON2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CON3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CON4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;DEP1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;DEP2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;DEP3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;DEP4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ALC&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>基准模型0</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模型0</span></span><br><span class="line">model0 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 测量模型</span></span><br><span class="line"><span class="string">  CCON =~ CCON1 + CCON2 + CCON3 + CCON4</span></span><br><span class="line"><span class="string">  CDEP =~ CDEP1 + CDEP2 + CDEP3 + CDEP4</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 关联</span></span><br><span class="line"><span class="string">  CCON ~~ CDEP</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 结构模型</span></span><br><span class="line"><span class="string">  CALC ~ CCON + CDEP</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行模型</span></span><br><span class="line">fit0 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model0<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span> estimator <span class="operator">=</span> <span class="string">&quot;ML&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit0<span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>modsem</code>方法</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模型1</span></span><br><span class="line">library<span class="punctuation">(</span>modsem<span class="punctuation">)</span></span><br><span class="line">model1 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 测量模型</span></span><br><span class="line"><span class="string">  CON =~ CON1 + CON2 + CON3 + CON4</span></span><br><span class="line"><span class="string">  DEP =~ DEP1 + DEP2 + DEP3 + DEP4</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 关联</span></span><br><span class="line"><span class="string">  #CON ~~ DEP</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # 结构模型</span></span><br><span class="line"><span class="string">  ALC ~ a*CON + b*DEP + c*CON:DEP</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line">fit1 <span class="operator">&lt;-</span> modsem<span class="punctuation">(</span>model1<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&quot;lms&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit1<span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>nlsem</code>方法</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建模型方法1</span></span><br><span class="line">lav_model <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 测量模型</span></span><br><span class="line"><span class="string">  xi1 =~ x1 + x2 + x3 + x4</span></span><br><span class="line"><span class="string">  xi2 =~ x5 + x6 + x7 + x8</span></span><br><span class="line"><span class="string">  eta =~ y1</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  eta ~ xi1 + xi2 + xi1:xi2</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line">model1 <span class="operator">&lt;-</span> lav2nlsem<span class="punctuation">(</span>lav_model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建模型方法2</span></span><br><span class="line">model1 <span class="operator">&lt;-</span> specify_sem<span class="punctuation">(</span></span><br><span class="line">  num.x <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span>              <span class="comment"># 指标变量数量，用于xi（这里认为是CCON的指标）</span></span><br><span class="line">  num.y <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>              <span class="comment"># 指标变量数量，用于eta（这里认为是CDEP的指标）</span></span><br><span class="line">  num.xi <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>             <span class="comment"># 潜在外生变量的数量（CCON）</span></span><br><span class="line">  num.eta <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>            <span class="comment"># 潜在内生变量的数量（CDEP）</span></span><br><span class="line">  xi <span class="operator">=</span> <span class="string">&quot;x1-x4, x5-x8&quot;</span><span class="punctuation">,</span>           <span class="comment"># 指标变量 x1 至 x4 是 CCON 的指标</span></span><br><span class="line">  eta <span class="operator">=</span> <span class="string">&quot;y1&quot;</span><span class="punctuation">,</span>          <span class="comment"># 指标变量 y1 至 y4 是 CDEP 的指标</span></span><br><span class="line">  interaction <span class="operator">=</span> <span class="string">&quot;xi1:xi2&quot;</span><span class="punctuation">,</span> <span class="comment"># 交互项 CDEP (eta) 和 CCON (xi)</span></span><br><span class="line">  rel.lat <span class="operator">=</span> <span class="string">&quot;default&quot;</span>    <span class="comment"># 定义潜变量之间的关系</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 随机生成起始值</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">666</span><span class="punctuation">)</span></span><br><span class="line">start <span class="operator">&lt;-</span> runif<span class="punctuation">(</span>count_free_parameters<span class="punctuation">(</span>model1<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拟合模型</span></span><br><span class="line">fit1 <span class="operator">&lt;-</span> em<span class="punctuation">(</span>model1<span class="punctuation">,</span> as.matrix<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">10</span><span class="operator">:</span><span class="number">18</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> start<span class="punctuation">,</span> convergence <span class="operator">=</span> <span class="number">0.01</span><span class="punctuation">,</span> max.iter <span class="operator">=</span> <span class="number">200</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查结果</span></span><br><span class="line">summary<span class="punctuation">(</span>fit1<span class="punctuation">)</span></span><br><span class="line">plot<span class="punctuation">(</span>fit1<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="有调节的中介">有调节的中介</h2>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lavaan<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>blavaan<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/12第十二章 调节效应/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./12_12 mod_med.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="简单调节模型">简单调节模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 简单调节模型</span></span><br><span class="line">model1 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 回归方程</span></span><br><span class="line"><span class="string">  SAT ~ CPREL + SIZE + CPRELSIZE</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拟合模型</span></span><br><span class="line">fit1 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model1<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型摘要</span></span><br><span class="line">summary<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>参数估计结果与标准化参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  SAT <span class="operator">~</span>                                                                 </span><br><span class="line">    CPREL             <span class="number">0.244</span>    <span class="number">0.096</span>    <span class="number">2.550</span>    <span class="number">0.011</span>    <span class="number">0.244</span>    <span class="number">0.222</span></span><br><span class="line">    SIZE             <span class="operator">-</span><span class="number">0.229</span>    <span class="number">0.162</span>   <span class="operator">-</span><span class="number">1.419</span>    <span class="number">0.156</span>   <span class="operator">-</span><span class="number">0.229</span>   <span class="operator">-</span><span class="number">0.085</span></span><br><span class="line">    CPRELSIZE         <span class="number">0.038</span>    <span class="number">0.132</span>    <span class="number">0.290</span>    <span class="number">0.772</span>    <span class="number">0.038</span>    <span class="number">0.025</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .SAT               <span class="number">1.685</span>    <span class="number">0.148</span>   <span class="number">11.402</span>    <span class="number">0.000</span>    <span class="number">1.685</span>    <span class="number">0.938</span></span><br><span class="line"></span><br><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    SAT               <span class="number">0.062</span></span><br></pre></td></tr></table></figure>
<p>可以看出积极的劳资关系压力<code>PREL</code>对工作满意度<code>SAT</code>的效应显著，<code>P(&gt;|z|)</code>为0.011。但是积极的劳资关系压力与企业规模的交互项<code>CPRELSIZE</code>对工作满意度<code>SAT</code>的效应不显著，<code>P(&gt;|z|)</code>为0.772。因此，积极的劳资关系压力<code>PREL</code>对工作满意度<code>SAT</code>的直接效应不受调节。</p>
<h3 id="有调节的中介效应检验">有调节的中介效应检验</h3>
<h4 id="系数依次检验">系数依次检验</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 有调节的中介</span></span><br><span class="line">model2 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 回归方程</span></span><br><span class="line"><span class="string">  SAT ~ PEM + CPREL</span></span><br><span class="line"><span class="string">  PEM ~ CPREL + CPRELSIZE + SIZE</span></span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拟合模型</span></span><br><span class="line">fit2 <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model2<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型摘要</span></span><br><span class="line">summary<span class="punctuation">(</span>fit2<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>模型拟合结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Model Test User Model<span class="operator">:</span></span><br><span class="line">                                                      </span><br><span class="line">  Test statistic                                 <span class="number">2.598</span></span><br><span class="line">  Degrees of freedom                                 <span class="number">2</span></span><br><span class="line">  P<span class="operator">-</span>value <span class="punctuation">(</span>Chi<span class="operator">-</span>square<span class="punctuation">)</span>                           <span class="number">0.273</span></span><br><span class="line"></span><br><span class="line">Model Test Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Test statistic                               <span class="number">225.874</span></span><br><span class="line">  Degrees of freedom                                 <span class="number">7</span></span><br><span class="line">  P<span class="operator">-</span>value                                        <span class="number">0.000</span></span><br><span class="line"></span><br><span class="line">User Model versus Baseline Model<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Comparative Fit Index <span class="punctuation">(</span>CFI<span class="punctuation">)</span>                    <span class="number">0.997</span></span><br><span class="line">  Tucker<span class="operator">-</span>Lewis Index <span class="punctuation">(</span>TLI<span class="punctuation">)</span>                       <span class="number">0.990</span></span><br><span class="line"></span><br><span class="line">Loglikelihood and Information Criteria<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  Loglikelihood user model <span class="punctuation">(</span>H0<span class="punctuation">)</span>               <span class="operator">-</span><span class="number">761.932</span></span><br><span class="line">  Loglikelihood unrestricted model <span class="punctuation">(</span>H1<span class="punctuation">)</span>             <span class="literal">NA</span></span><br><span class="line">                                                      </span><br><span class="line">  Akaike <span class="punctuation">(</span>AIC<span class="punctuation">)</span>                                <span class="number">1537.865</span></span><br><span class="line">  Bayesian <span class="punctuation">(</span>BIC<span class="punctuation">)</span>                              <span class="number">1562.790</span></span><br><span class="line">  Sample<span class="operator">-</span>size adjusted Bayesian <span class="punctuation">(</span>SABIC<span class="punctuation">)</span>       <span class="number">1540.597</span></span><br><span class="line"></span><br><span class="line">Root Mean Square Error of Approximation<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  RMSEA                                          <span class="number">0.034</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> lower         <span class="number">0.000</span></span><br><span class="line">  <span class="number">90</span> Percent confidence interval <span class="operator">-</span> upper         <span class="number">0.133</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&lt;=</span> <span class="number">0.050</span>                    <span class="number">0.477</span></span><br><span class="line">  P<span class="operator">-</span>value H_0<span class="operator">:</span> RMSEA <span class="operator">&gt;=</span> <span class="number">0.080</span>                    <span class="number">0.299</span></span><br><span class="line"></span><br><span class="line">Standardized Root Mean Square Residual<span class="operator">:</span></span><br><span class="line"></span><br><span class="line">  SRMR                                           <span class="number">0.016</span></span><br></pre></td></tr></table></figure>
<p>可以看出，卡方值为2.598，自由度为2，CFI值为0.997，TLI值为0.990，RMSEA值为0.034，表明模型拟合较好。</p>
<p>参数估计结果与标准化参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">  SAT <span class="operator">~</span>                                                                 </span><br><span class="line">    PEM               <span class="number">0.225</span>    <span class="number">0.065</span>    <span class="number">3.473</span>    <span class="number">0.001</span>    <span class="number">0.225</span>    <span class="number">0.211</span></span><br><span class="line">    CPREL             <span class="number">0.199</span>    <span class="number">0.067</span>    <span class="number">2.970</span>    <span class="number">0.003</span>    <span class="number">0.199</span>    <span class="number">0.181</span></span><br><span class="line">  PEM <span class="operator">~</span>                                                                 </span><br><span class="line">    CPREL             <span class="number">0.428</span>    <span class="number">0.063</span>    <span class="number">6.757</span>    <span class="number">0.000</span>    <span class="number">0.428</span>    <span class="number">0.416</span></span><br><span class="line">    CPRELSIZE        <span class="operator">-</span><span class="number">0.227</span>    <span class="number">0.088</span>   <span class="operator">-</span><span class="number">2.578</span>    <span class="number">0.010</span>   <span class="operator">-</span><span class="number">0.227</span>   <span class="operator">-</span><span class="number">0.158</span></span><br><span class="line">    SIZE             <span class="operator">-</span><span class="number">1.710</span>    <span class="number">0.107</span>  <span class="operator">-</span><span class="number">15.942</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">1.710</span>   <span class="operator">-</span><span class="number">0.679</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span>   Std.lv  Std.all</span><br><span class="line">   .SAT               <span class="number">1.623</span>    <span class="number">0.142</span>   <span class="number">11.402</span>    <span class="number">0.000</span>    <span class="number">1.623</span>    <span class="number">0.904</span></span><br><span class="line">   .PEM               <span class="number">0.741</span>    <span class="number">0.065</span>   <span class="number">11.402</span>    <span class="number">0.000</span>    <span class="number">0.741</span>    <span class="number">0.469</span></span><br><span class="line"></span><br><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    SAT               <span class="number">0.096</span></span><br><span class="line">    PEM               <span class="number">0.531</span></span><br></pre></td></tr></table></figure>
<p>可以看出所有的路径都显著，<code>PEM ~ CPREL</code>的路径系数为0.428，<code>PEM ~ CPRELSIZE</code>的路径系数为-0.227，<code>SAT ~ PEM</code>的路径系数为0.225，依次检验的结果显著，足以证明中介效应是收到调节的。</p>
<h4 id="乘积系数的区间检验">乘积系数的区间检验</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义模型</span></span><br><span class="line">model3 <span class="operator">&lt;-</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  # 回归方程</span></span><br><span class="line"><span class="string">  PEM ~ a1*CPREL + a2*SIZE + a3*CPRELSIZE </span></span><br><span class="line"><span class="string">  SAT ~ c*PEM + b*CPREL</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  # 中介效应</span></span><br><span class="line"><span class="string">  h1 := a3*b  # z=0 和 z=1 时中介效应的差值</span></span><br><span class="line"><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="偏差校正的Bootstrap方法">偏差校正的Bootstrap方法</h5>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 bootstrap 进行拟合</span></span><br><span class="line">fit_bootstrap <span class="operator">&lt;-</span> sem<span class="punctuation">(</span>model3<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span> se <span class="operator">=</span> <span class="string">&quot;bootstrap&quot;</span><span class="punctuation">,</span> bootstrap <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型摘要，包括偏差修正的 bootstrap 置信区间</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_bootstrap<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> ci <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看参数估计，包括不同置信水平的偏差修正的 bootstrap 置信区间</span></span><br><span class="line">parameterEstimates<span class="punctuation">(</span>fit_bootstrap<span class="punctuation">,</span> level <span class="operator">=</span> <span class="number">0.90</span><span class="punctuation">,</span> boot.ci.type <span class="operator">=</span> <span class="string">&quot;bca.simple&quot;</span><span class="punctuation">)</span></span><br><span class="line">parameterEstimates<span class="punctuation">(</span>fit_bootstrap<span class="punctuation">,</span> level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">,</span> boot.ci.type <span class="operator">=</span> <span class="string">&quot;bca.simple&quot;</span><span class="punctuation">)</span></span><br><span class="line">parameterEstimates<span class="punctuation">(</span>fit_bootstrap<span class="punctuation">,</span> level <span class="operator">=</span> <span class="number">0.99</span><span class="punctuation">,</span> boot.ci.type <span class="operator">=</span> <span class="string">&quot;bca.simple&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>参数估计结果与标准化参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span> ci.lower ci.upper   Std.lv  Std.all</span><br><span class="line">  PEM <span class="operator">~</span>                                                                                   </span><br><span class="line">    CPREL     <span class="punctuation">(</span>a1<span class="punctuation">)</span>    <span class="number">0.428</span>    <span class="number">0.065</span>    <span class="number">6.633</span>    <span class="number">0.000</span>    <span class="number">0.294</span>    <span class="number">0.553</span>    <span class="number">0.428</span>    <span class="number">0.416</span></span><br><span class="line">    SIZE      <span class="punctuation">(</span>a2<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">1.710</span>    <span class="number">0.103</span>  <span class="operator">-</span><span class="number">16.522</span>    <span class="number">0.000</span>   <span class="operator">-</span><span class="number">1.911</span>   <span class="operator">-</span><span class="number">1.505</span>   <span class="operator">-</span><span class="number">1.710</span>   <span class="operator">-</span><span class="number">0.679</span></span><br><span class="line">    CPRELSIZE <span class="punctuation">(</span>a3<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.227</span>    <span class="number">0.086</span>   <span class="operator">-</span><span class="number">2.622</span>    <span class="number">0.009</span>   <span class="operator">-</span><span class="number">0.389</span>   <span class="operator">-</span><span class="number">0.051</span>   <span class="operator">-</span><span class="number">0.227</span>   <span class="operator">-</span><span class="number">0.158</span></span><br><span class="line">  SAT <span class="operator">~</span>                                                                                   </span><br><span class="line">    PEM        <span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">)</span>    <span class="number">0.225</span>    <span class="number">0.067</span>    <span class="number">3.338</span>    <span class="number">0.001</span>    <span class="number">0.089</span>    <span class="number">0.357</span>    <span class="number">0.225</span>    <span class="number">0.211</span></span><br><span class="line">    CPREL      <span class="punctuation">(</span>b<span class="punctuation">)</span>    <span class="number">0.199</span>    <span class="number">0.073</span>    <span class="number">2.717</span>    <span class="number">0.007</span>    <span class="number">0.051</span>    <span class="number">0.345</span>    <span class="number">0.199</span>    <span class="number">0.181</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span> ci.lower ci.upper   Std.lv  Std.all</span><br><span class="line">   .PEM               <span class="number">0.741</span>    <span class="number">0.054</span>   <span class="number">13.708</span>    <span class="number">0.000</span>    <span class="number">0.627</span>    <span class="number">0.839</span>    <span class="number">0.741</span>    <span class="number">0.469</span></span><br><span class="line">   .SAT               <span class="number">1.623</span>    <span class="number">0.114</span>   <span class="number">14.260</span>    <span class="number">0.000</span>    <span class="number">1.388</span>    <span class="number">1.833</span>    <span class="number">1.623</span>    <span class="number">0.904</span></span><br><span class="line"></span><br><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    PEM               <span class="number">0.531</span></span><br><span class="line">    SAT               <span class="number">0.096</span></span><br><span class="line"></span><br><span class="line">Defined Parameters<span class="operator">:</span></span><br><span class="line">                   Estimate  Std.Err  z<span class="operator">-</span>value  P<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>z<span class="operator">|</span><span class="punctuation">)</span> ci.lower ci.upper   Std.lv  Std.all</span><br><span class="line">    h1               <span class="operator">-</span><span class="number">0.045</span>    <span class="number">0.025</span>   <span class="operator">-</span><span class="number">1.825</span>    <span class="number">0.068</span>   <span class="operator">-</span><span class="number">0.100</span>   <span class="operator">-</span><span class="number">0.005</span>   <span class="operator">-</span><span class="number">0.045</span>   <span class="operator">-</span><span class="number">0.029</span></span><br></pre></td></tr></table></figure>
<p>90%置信区间、95%置信区间、99%置信区间</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> parameterEstimates<span class="punctuation">(</span>fit_bootstrap<span class="punctuation">,</span> level <span class="operator">=</span> <span class="number">0.90</span><span class="punctuation">,</span> boot.ci.type <span class="operator">=</span> <span class="string">&quot;bca.simple&quot;</span><span class="punctuation">)</span></span><br><span class="line">         lhs op       rhs label    est    se       z pvalue ci.lower ci.upper</span><br><span class="line"><span class="number">1</span>        PEM  <span class="operator">~</span>     CPREL    a1  <span class="number">0.428</span> <span class="number">0.065</span>   <span class="number">6.633</span>  <span class="number">0.000</span>    <span class="number">0.317</span>    <span class="number">0.529</span></span><br><span class="line"><span class="number">2</span>        PEM  <span class="operator">~</span>      SIZE    a2 <span class="operator">-</span><span class="number">1.710</span> <span class="number">0.103</span> <span class="operator">-</span><span class="number">16.522</span>  <span class="number">0.000</span>   <span class="operator">-</span><span class="number">1.883</span>   <span class="operator">-</span><span class="number">1.541</span></span><br><span class="line"><span class="number">3</span>        PEM  <span class="operator">~</span> CPRELSIZE    a3 <span class="operator">-</span><span class="number">0.227</span> <span class="number">0.086</span>  <span class="operator">-</span><span class="number">2.622</span>  <span class="number">0.009</span>   <span class="operator">-</span><span class="number">0.362</span>   <span class="operator">-</span><span class="number">0.078</span></span><br><span class="line"><span class="number">4</span>        SAT  <span class="operator">~</span>       PEM     <span class="built_in">c</span>  <span class="number">0.225</span> <span class="number">0.067</span>   <span class="number">3.338</span>  <span class="number">0.001</span>    <span class="number">0.114</span>    <span class="number">0.338</span></span><br><span class="line"><span class="number">5</span>        SAT  <span class="operator">~</span>     CPREL     b  <span class="number">0.199</span> <span class="number">0.073</span>   <span class="number">2.717</span>  <span class="number">0.007</span>    <span class="number">0.078</span>    <span class="number">0.319</span></span><br><span class="line"><span class="number">14</span>        h1 <span class="operator">:=</span>      a3<span class="operator">*</span>b    h1 <span class="operator">-</span><span class="number">0.045</span> <span class="number">0.025</span>  <span class="operator">-</span><span class="number">1.825</span>  <span class="number">0.068</span>   <span class="operator">-</span><span class="number">0.096</span>   <span class="operator">-</span><span class="number">0.013</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> parameterEstimates<span class="punctuation">(</span>fit_bootstrap<span class="punctuation">,</span> level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">,</span> boot.ci.type <span class="operator">=</span> <span class="string">&quot;bca.simple&quot;</span><span class="punctuation">)</span></span><br><span class="line">         lhs op       rhs label    est    se       z pvalue ci.lower ci.upper</span><br><span class="line"><span class="number">1</span>        PEM  <span class="operator">~</span>     CPREL    a1  <span class="number">0.428</span> <span class="number">0.065</span>   <span class="number">6.633</span>  <span class="number">0.000</span>    <span class="number">0.293</span>    <span class="number">0.551</span></span><br><span class="line"><span class="number">2</span>        PEM  <span class="operator">~</span>      SIZE    a2 <span class="operator">-</span><span class="number">1.710</span> <span class="number">0.103</span> <span class="operator">-</span><span class="number">16.522</span>  <span class="number">0.000</span>   <span class="operator">-</span><span class="number">1.913</span>   <span class="operator">-</span><span class="number">1.508</span></span><br><span class="line"><span class="number">3</span>        PEM  <span class="operator">~</span> CPRELSIZE    a3 <span class="operator">-</span><span class="number">0.227</span> <span class="number">0.086</span>  <span class="operator">-</span><span class="number">2.622</span>  <span class="number">0.009</span>   <span class="operator">-</span><span class="number">0.389</span>   <span class="operator">-</span><span class="number">0.050</span></span><br><span class="line"><span class="number">4</span>        SAT  <span class="operator">~</span>       PEM     <span class="built_in">c</span>  <span class="number">0.225</span> <span class="number">0.067</span>   <span class="number">3.338</span>  <span class="number">0.001</span>    <span class="number">0.093</span>    <span class="number">0.360</span></span><br><span class="line"><span class="number">5</span>        SAT  <span class="operator">~</span>     CPREL     b  <span class="number">0.199</span> <span class="number">0.073</span>   <span class="number">2.717</span>  <span class="number">0.007</span>    <span class="number">0.050</span>    <span class="number">0.344</span></span><br><span class="line"><span class="number">14</span>        h1 <span class="operator">:=</span>      a3<span class="operator">*</span>b    h1 <span class="operator">-</span><span class="number">0.045</span> <span class="number">0.025</span>  <span class="operator">-</span><span class="number">1.825</span>  <span class="number">0.068</span>   <span class="operator">-</span><span class="number">0.107</span>   <span class="operator">-</span><span class="number">0.008</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> parameterEstimates<span class="punctuation">(</span>fit_bootstrap<span class="punctuation">,</span> level <span class="operator">=</span> <span class="number">0.99</span><span class="punctuation">,</span> boot.ci.type <span class="operator">=</span> <span class="string">&quot;bca.simple&quot;</span><span class="punctuation">)</span></span><br><span class="line">         lhs op       rhs label    est    se       z pvalue ci.lower ci.upper</span><br><span class="line"><span class="number">1</span>        PEM  <span class="operator">~</span>     CPREL    a1  <span class="number">0.428</span> <span class="number">0.065</span>   <span class="number">6.633</span>  <span class="number">0.000</span>    <span class="number">0.249</span>    <span class="number">0.583</span></span><br><span class="line"><span class="number">2</span>        PEM  <span class="operator">~</span>      SIZE    a2 <span class="operator">-</span><span class="number">1.710</span> <span class="number">0.103</span> <span class="operator">-</span><span class="number">16.522</span>  <span class="number">0.000</span>   <span class="operator">-</span><span class="number">1.979</span>   <span class="operator">-</span><span class="number">1.455</span></span><br><span class="line"><span class="number">3</span>        PEM  <span class="operator">~</span> CPRELSIZE    a3 <span class="operator">-</span><span class="number">0.227</span> <span class="number">0.086</span>  <span class="operator">-</span><span class="number">2.622</span>  <span class="number">0.009</span>   <span class="operator">-</span><span class="number">0.453</span>   <span class="operator">-</span><span class="number">0.002</span></span><br><span class="line"><span class="number">4</span>        SAT  <span class="operator">~</span>       PEM     <span class="built_in">c</span>  <span class="number">0.225</span> <span class="number">0.067</span>   <span class="number">3.338</span>  <span class="number">0.001</span>    <span class="number">0.054</span>    <span class="number">0.407</span></span><br><span class="line"><span class="number">5</span>        SAT  <span class="operator">~</span>     CPREL     b  <span class="number">0.199</span> <span class="number">0.073</span>   <span class="number">2.717</span>  <span class="number">0.007</span>    <span class="number">0.010</span>    <span class="number">0.386</span></span><br><span class="line"><span class="number">14</span>        h1 <span class="operator">:=</span>      a3<span class="operator">*</span>b    h1 <span class="operator">-</span><span class="number">0.045</span> <span class="number">0.025</span>  <span class="operator">-</span><span class="number">1.825</span>  <span class="number">0.068</span>   <span class="operator">-</span><span class="number">0.137</span>    <span class="number">0.000</span></span><br></pre></td></tr></table></figure>
<p>可以看出乘积系数<code>h1 = a3*b</code>的95%置信区间为[-0.100 ,-0.005]，不包含0，表明积极的劳资关系压力<code>PREL</code>通过积极情绪<code>PEM</code>对工作满意度<code>SAT</code>的中介效应的前半路径收到企业规模<code>SIZE</code>的调节作用。</p>
<h5 id="MCMC方法-2">MCMC方法</h5>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用贝叶斯估计进行拟合</span></span><br><span class="line">fit_bayes <span class="operator">&lt;-</span> bsem<span class="punctuation">(</span>model<span class="punctuation">,</span> data <span class="operator">=</span> data<span class="punctuation">,</span> n.chains <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> burnin <span class="operator">=</span> <span class="number">10000</span><span class="punctuation">,</span> sample <span class="operator">=</span> <span class="number">30000</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型摘要</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_bayes<span class="punctuation">,</span> fit.measures <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> standardized <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> rsquare <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Regressions<span class="operator">:</span></span><br><span class="line">                   Estimate  Post.SD pi.lower pi.upper   Std.lv  Std.all     Rhat    Prior       </span><br><span class="line">  PEM <span class="operator">~</span>                                                                                          </span><br><span class="line">    CPREL     <span class="punctuation">(</span>a1<span class="punctuation">)</span>    <span class="number">0.429</span>    <span class="number">0.064</span>    <span class="number">0.304</span>    <span class="number">0.556</span>    <span class="number">0.429</span>    <span class="number">0.414</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">    SIZE      <span class="punctuation">(</span>a2<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">1.709</span>    <span class="number">0.109</span>   <span class="operator">-</span><span class="number">1.921</span>   <span class="operator">-</span><span class="number">1.497</span>   <span class="operator">-</span><span class="number">1.709</span>   <span class="operator">-</span><span class="number">0.675</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">    CPRELSIZE <span class="punctuation">(</span>a3<span class="punctuation">)</span>   <span class="operator">-</span><span class="number">0.228</span>    <span class="number">0.089</span>   <span class="operator">-</span><span class="number">0.403</span>   <span class="operator">-</span><span class="number">0.053</span>   <span class="operator">-</span><span class="number">0.228</span>   <span class="operator">-</span><span class="number">0.158</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">  SAT <span class="operator">~</span>                                                                                          </span><br><span class="line">    PEM        <span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">)</span>    <span class="number">0.225</span>    <span class="number">0.065</span>    <span class="number">0.097</span>    <span class="number">0.354</span>    <span class="number">0.225</span>    <span class="number">0.211</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">    CPREL      <span class="punctuation">(</span>b<span class="punctuation">)</span>    <span class="number">0.199</span>    <span class="number">0.068</span>    <span class="number">0.066</span>    <span class="number">0.332</span>    <span class="number">0.199</span>    <span class="number">0.179</span>    <span class="number">1.000</span>    normal<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Variances<span class="operator">:</span></span><br><span class="line">                   Estimate  Post.SD pi.lower pi.upper   Std.lv  Std.all     Rhat    Prior       </span><br><span class="line">   .PEM               <span class="number">0.758</span>    <span class="number">0.067</span>    <span class="number">0.638</span>    <span class="number">0.901</span>    <span class="number">0.758</span>    <span class="number">0.474</span>    <span class="number">1.000</span> <span class="built_in">gamma</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">.5</span><span class="punctuation">)</span><span class="punctuation">[</span>sd<span class="punctuation">]</span></span><br><span class="line">   .SAT               <span class="number">1.651</span>    <span class="number">0.147</span>    <span class="number">1.387</span>    <span class="number">1.965</span>    <span class="number">1.651</span>    <span class="number">0.905</span>    <span class="number">1.000</span> <span class="built_in">gamma</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">.5</span><span class="punctuation">)</span><span class="punctuation">[</span>sd<span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line">R<span class="operator">-</span>Square<span class="operator">:</span></span><br><span class="line">                   Estimate</span><br><span class="line">    PEM               <span class="number">0.526</span></span><br><span class="line">    SAT               <span class="number">0.095</span></span><br><span class="line"></span><br><span class="line">Defined Parameters<span class="operator">:</span></span><br><span class="line">                   Estimate  Post.SD pi.lower pi.upper   Std.lv  Std.all     Rhat    Prior       </span><br><span class="line">    h1               <span class="operator">-</span><span class="number">0.045</span>    <span class="number">0.024</span>   <span class="operator">-</span><span class="number">0.093</span>    <span class="number">0.002</span>   <span class="operator">-</span><span class="number">0.045</span>   <span class="operator">-</span><span class="number">0.028</span>                         </span><br></pre></td></tr></table></figure>
<p>可以看出乘积系数<code>h1 = a3*b</code>的95%置信区间为[-0.093 ,0.002]，包含0，表明积极的劳资关系压力<code>PREL</code>通过积极情绪<code>PEM</code>对工作满意度<code>SAT</code>的中介效应的前半路径收到企业规模<code>SIZE</code>的调节作用不显著。</p>
<h1>多层线性模型</h1>
<h2 id="多水平分析简化模型类型">多水平分析简化模型类型</h2>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lme4<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>performance<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lmerTest<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>parameters<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/13第十三章 多层线性模型简介/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data1 <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./13-1.SAV&quot;</span><span class="punctuation">)</span></span><br><span class="line">data2 <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./13-2.SAV&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="数据介绍及数据合并">数据介绍及数据合并</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">describe<span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line">describe<span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">table<span class="punctuation">(</span>data1<span class="operator">$</span>id<span class="punctuation">)</span></span><br><span class="line">table<span class="punctuation">(</span>data2<span class="operator">$</span>id<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">table<span class="punctuation">(</span>unique<span class="punctuation">(</span>data1<span class="operator">$</span>id<span class="punctuation">)</span> <span class="operator">==</span> data2<span class="operator">$</span>id<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并数据</span></span><br><span class="line">merged_data <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>data1<span class="punctuation">,</span> data2<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;id&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>merged_data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>merged_data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="零模型">零模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拟合零模型</span></span><br><span class="line">model1 <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>mathach <span class="operator">~</span> <span class="number">1</span> <span class="operator">+</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">|</span> id<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model1<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算组间变异占总变异的比例（解释率）</span></span><br><span class="line">icc<span class="punctuation">(</span>model1<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error       df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">12.6370</span>     <span class="number">0.2444</span> <span class="number">156.6473</span>   <span class="number">51.71</span>   <span class="operator">&lt;</span><span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>从固定部分参数可以看出，学校之间的数学成绩是存在显著差异的，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mn>00</mn></msub></mrow><annotation encoding="application/x-tex">\gamma _{00}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">00</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为12.6370，Pr(&gt;|t|) &lt;2e-16。</p>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance Std.Dev.</span><br><span class="line"> id       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">8.614</span>   <span class="number">2.935</span>   </span><br><span class="line"> Residual             <span class="number">39.148</span>   <span class="number">6.257</span>   </span><br><span class="line">Number of obs<span class="operator">:</span> <span class="number">7185</span><span class="punctuation">,</span> groups<span class="operator">:</span>  id<span class="punctuation">,</span> <span class="number">160</span></span><br></pre></td></tr></table></figure>
<p>从随机部分的参数可以看出，学校之间数学成绩存在显著的变异，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mn>00</mn></msub></mrow><annotation encoding="application/x-tex">\tau _{00}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">00</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为8.614</p>
<p>组间变异占总变异的比例</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> icc<span class="punctuation">(</span>model1<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Intraclass Correlation Coefficient</span></span><br><span class="line"></span><br><span class="line">    Adjusted ICC<span class="operator">:</span> <span class="number">0.180</span></span><br><span class="line">  Unadjusted ICC<span class="operator">:</span> <span class="number">0.180</span></span><br></pre></td></tr></table></figure>
<p>表明学校间的变异解释了总体变异的18.0%</p>
<h3 id="随机效应单因素协方差分析模型">随机效应单因素协方差分析模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 随机效应单因素协方差分析模型</span></span><br><span class="line">model1_2 <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>mathach <span class="operator">~</span> <span class="number">1</span> <span class="operator">+</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">|</span> id<span class="punctuation">)</span> <span class="operator">+</span> ses<span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model1_2<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error        df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   <span class="number">12.6575</span>     <span class="number">0.1880</span>  <span class="number">148.3022</span>   <span class="number">67.33</span>   <span class="operator">&lt;</span><span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">ses            <span class="number">2.3902</span>     <span class="number">0.1057</span> <span class="number">6838.0776</span>   <span class="number">22.61</span>   <span class="operator">&lt;</span><span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance Std.Dev.</span><br><span class="line"> id       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">4.768</span>   <span class="number">2.184</span>   </span><br><span class="line"> Residual             <span class="number">37.034</span>   <span class="number">6.086</span>   </span><br><span class="line">Number of obs<span class="operator">:</span> <span class="number">7185</span><span class="punctuation">,</span> groups<span class="operator">:</span>  id<span class="punctuation">,</span> <span class="number">160</span></span><br></pre></td></tr></table></figure>
<h3 id="随机系数回归模型">随机系数回归模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一水平加入ses的随机系数回归模型</span></span><br><span class="line">model2 <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>mathach <span class="operator">~</span> ses <span class="operator">+</span> <span class="punctuation">(</span>ses <span class="operator">|</span> id<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model2<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error       df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">12.6650</span>     <span class="number">0.1898</span> <span class="number">145.5479</span>   <span class="number">66.71</span>   <span class="operator">&lt;</span><span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">ses           <span class="number">2.3938</span>     <span class="number">0.1181</span> <span class="number">157.5299</span>   <span class="number">20.27</span>   <span class="operator">&lt;</span><span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>从固定部分参数可以看出，社会经济地位<code>ses</code>对数学成绩<code>mathach</code>有显著影响，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">\gamma _{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为2.3938，Pr(&gt;|t|) &lt;2e-16。</p>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance Std.Dev. Corr </span><br><span class="line"> id       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">4.8287</span>  <span class="number">2.1974</span>        </span><br><span class="line">          ses          <span class="number">0.4129</span>  <span class="number">0.6426</span>   <span class="operator">-</span><span class="number">0.11</span></span><br><span class="line"> Residual             <span class="number">36.8301</span>  <span class="number">6.0688</span>        </span><br><span class="line">Number of obs<span class="operator">:</span> <span class="number">7185</span><span class="punctuation">,</span> groups<span class="operator">:</span>  id<span class="punctuation">,</span> <span class="number">160</span></span><br></pre></td></tr></table></figure>
<p>从随机部分的参数可以看出，第一水平的截距(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mn>00</mn></msub></mrow><annotation encoding="application/x-tex">\tau _{00}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">00</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为4.8287)和斜率(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mn>11</mn></msub></mrow><annotation encoding="application/x-tex">\tau _{11}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为0.4129)</p>
<h3 id="第二水平仅截距项含有预测变量的随机系数回归模型">第二水平仅截距项含有预测变量的随机系数回归模型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第二水平仅截距项含有预测变量disclim的随机系数回归模型</span></span><br><span class="line">model3 <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>mathach <span class="operator">~</span> ses <span class="operator">+</span> disclim <span class="operator">+</span> <span class="punctuation">(</span>ses <span class="operator">|</span> id<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model3<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error       df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">12.5783</span>     <span class="number">0.1718</span> <span class="number">141.8784</span>  <span class="number">73.202</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">ses           <span class="number">2.3877</span>     <span class="number">0.1185</span> <span class="number">157.7795</span>  <span class="number">20.151</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">disclim      <span class="operator">-</span><span class="number">1.2492</span>     <span class="number">0.1765</span> <span class="number">156.4273</span>  <span class="operator">-</span><span class="number">7.076</span> <span class="number">4.69e-11</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>从固定部分参数可以看出，学校纪律环境<code>disclim</code>对数学成绩<code>mathach</code>有显著影响，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mn>01</mn></msub></mrow><annotation encoding="application/x-tex">\gamma _{01}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">01</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为-1.2492，Pr(&gt;|t|) &lt;4.69e-11。</p>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance Std.Dev. Corr</span><br><span class="line"> id       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">3.7840</span>  <span class="number">1.9452</span>       </span><br><span class="line">          ses          <span class="number">0.4497</span>  <span class="number">0.6706</span>   <span class="number">0.36</span></span><br><span class="line"> Residual             <span class="number">36.7954</span>  <span class="number">6.0659</span>   </span><br></pre></td></tr></table></figure>
<h3 id="第二水平仅截距项含有预测变量的随机系数回归模型-全模型">第二水平仅截距项含有预测变量的随机系数回归模型(全模型)</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第二水平含有预测变量disclim的随机系数回归模型（全模型）</span></span><br><span class="line">model4 <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>mathach <span class="operator">~</span> ses <span class="operator">+</span> disclim <span class="operator">+</span> ses <span class="operator">*</span> disclim <span class="operator">+</span> <span class="punctuation">(</span>ses <span class="operator">|</span> id<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model4<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">calculate_explained_variance<span class="punctuation">(</span>model3<span class="punctuation">,</span> model4<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error        df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   <span class="number">12.6653</span>     <span class="number">0.1703</span>  <span class="number">147.7224</span>  <span class="number">74.353</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">ses            <span class="number">2.4074</span>     <span class="number">0.1060</span> <span class="number">2979.5968</span>  <span class="number">22.721</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">disclim       <span class="operator">-</span><span class="number">1.1262</span>     <span class="number">0.1762</span>  <span class="number">151.2579</span>  <span class="operator">-</span><span class="number">6.391</span> <span class="number">1.93e-09</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">ses<span class="operator">:</span>disclim    <span class="number">0.5735</span>     <span class="number">0.1135</span> <span class="number">2497.9943</span>   <span class="number">5.054</span> <span class="number">4.65e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>从固定部分参数可以看出，学校纪律环境<code>disclim</code>对社会经济地位<code>ses</code>和数学成绩<code>mathach</code>之间对关系具有显著的调节作用，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mn>11</mn></msub></mrow><annotation encoding="application/x-tex">\gamma _{11}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为0.5735，Pr(&gt;|t|) &lt;4.65e-07。</p>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance Std.Dev. Corr</span><br><span class="line"> id       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">3.71623</span> <span class="number">1.9278</span>       </span><br><span class="line">          ses          <span class="number">0.02828</span> <span class="number">0.1682</span>   <span class="number">1.00</span></span><br><span class="line"> Residual             <span class="number">36.86953</span> <span class="number">6.0720</span>       </span><br><span class="line">Number of obs<span class="operator">:</span> <span class="number">7185</span><span class="punctuation">,</span> groups<span class="operator">:</span>  id<span class="punctuation">,</span> <span class="number">160</span></span><br></pre></td></tr></table></figure>
<h2 id="多层线性模型分析追踪数据">多层线性模型分析追踪数据</h2>
<h3 id="个体特征随时间变化的趋势">个体特征随时间变化的趋势</h3>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lme4<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/14第十四章 多层线性模型在追踪研究中的应用/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data1 <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./14-1.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line">data2 <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./14-2.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="数据介绍与数据合并">数据介绍与数据合并</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">describe<span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line">describe<span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">table<span class="punctuation">(</span>unique<span class="punctuation">(</span>data1<span class="operator">$</span>ID<span class="punctuation">)</span> <span class="operator">==</span> data2<span class="operator">$</span>ID<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并数据</span></span><br><span class="line">merged_data <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>data1<span class="punctuation">,</span> data2<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;ID&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>merged_data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>merged_data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="线性增长模型">线性增长模型</h4>
<h5 id="无条件均值模型">无条件均值模型</h5>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 无条件均值模型零模型</span></span><br><span class="line">model1 <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>SELF <span class="operator">~</span> <span class="number">1</span> <span class="operator">+</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">|</span> ID<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model1<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算组间变异占总变异的比例（解释率）</span></span><br><span class="line">icc<span class="punctuation">(</span>model1<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error        df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   <span class="number">2.69007</span>    <span class="number">0.02226</span> <span class="number">263.00000</span>   <span class="number">120.8</span>   <span class="operator">&lt;</span><span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance Std.Dev.</span><br><span class="line"> ID       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">0.09694</span>  <span class="number">0.3114</span>  </span><br><span class="line"> Residual             <span class="number">0.13568</span>  <span class="number">0.3683</span>  </span><br><span class="line">Number of obs<span class="operator">:</span> <span class="number">1056</span><span class="punctuation">,</span> groups<span class="operator">:</span>  ID<span class="punctuation">,</span> <span class="number">264</span></span><br></pre></td></tr></table></figure>
<p>个体间变异占总变异的比例</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> icc<span class="punctuation">(</span>model1<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Intraclass Correlation Coefficient</span></span><br><span class="line"></span><br><span class="line">    Adjusted ICC<span class="operator">:</span> <span class="number">0.417</span></span><br><span class="line">  Unadjusted ICC<span class="operator">:</span> <span class="number">0.417</span></span><br></pre></td></tr></table></figure>
<h5 id="无条件增长模型">无条件增长模型</h5>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 无条件增长模型</span></span><br><span class="line">model2 <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>SELF <span class="operator">~</span> TIME <span class="operator">+</span> <span class="punctuation">(</span>TIME <span class="operator">|</span> ID<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model2<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error        df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   <span class="number">2.81608</span>    <span class="number">0.02137</span> <span class="number">262.99975</span> <span class="number">131.804</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">TIME         <span class="operator">-</span><span class="number">0.08401</span>    <span class="number">0.01162</span> <span class="number">262.99948</span>  <span class="operator">-</span><span class="number">7.228</span> <span class="number">5.31e-12</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance Std.Dev. Corr</span><br><span class="line"> ID       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">0.05258</span>  <span class="number">0.2293</span>       </span><br><span class="line">          TIME        <span class="number">0.01625</span>  <span class="number">0.1275</span>   <span class="number">0.20</span></span><br><span class="line"> Residual             <span class="number">0.09705</span>  <span class="number">0.3115</span>       </span><br><span class="line">Number of obs<span class="operator">:</span> <span class="number">1056</span><span class="punctuation">,</span> groups<span class="operator">:</span>  ID<span class="punctuation">,</span> <span class="number">264</span></span><br></pre></td></tr></table></figure>
<h5 id="全模型">全模型</h5>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全模型</span></span><br><span class="line">model3 <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>SELF <span class="operator">~</span> TIME <span class="operator">+</span> TIME<span class="operator">*</span>GENDER <span class="operator">+</span> TIME<span class="operator">*</span>WITHDRAW <span class="operator">+</span> <span class="punctuation">(</span>TIME <span class="operator">|</span> ID<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model3<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">                Estimate Std. Error         df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>     <span class="number">2.813817</span>   <span class="number">0.031052</span> <span class="number">260.998678</span>  <span class="number">90.617</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">TIME           <span class="operator">-</span><span class="number">0.116611</span>   <span class="number">0.017290</span> <span class="number">260.999768</span>  <span class="operator">-</span><span class="number">6.744</span> <span class="number">9.85e-11</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">GENDER          <span class="number">0.004017</span>   <span class="number">0.041401</span> <span class="number">260.998678</span>   <span class="number">0.097</span>  <span class="number">0.92278</span>    </span><br><span class="line">WITHDRAW       <span class="operator">-</span><span class="number">0.104416</span>   <span class="number">0.020567</span> <span class="number">260.998677</span>  <span class="operator">-</span><span class="number">5.077</span> <span class="number">7.30e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">TIME<span class="operator">:</span>GENDER     <span class="number">0.057760</span>   <span class="number">0.023052</span> <span class="number">260.999768</span>   <span class="number">2.506</span>  <span class="number">0.01283</span> <span class="operator">*</span>  </span><br><span class="line">TIME<span class="operator">:</span>WITHDRAW   <span class="number">0.032042</span>   <span class="number">0.011452</span> <span class="number">260.999769</span>   <span class="number">2.798</span>  <span class="number">0.00553</span> <span class="operator">*</span><span class="operator">*</span> </span><br></pre></td></tr></table></figure>
<p>从固定部分参数可以看出，对于第一水平的截距，在控制性别和初始退缩行为后，初始自我概念的均值<code>(Intercept)</code>为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>00</mn></msub></mrow><annotation encoding="application/x-tex">\beta _{00}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">00</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为2.813817，初始状态男女生自我概念的均值<code>GENDER</code>不存在显著差异(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>01</mn></msub></mrow><annotation encoding="application/x-tex">\beta _{01}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">01</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为0.004017，Pr(&gt;|t|) 为0.92278)，初始退缩行为<code>WITHDRAW</code>对初始的自我概念<code>SELF</code>有负向的预测作用(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>02</mn></msub></mrow><annotation encoding="application/x-tex">\beta _{02}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">02</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为-0.104416，Pr(&gt;|t|)为7.30e-07)；对于第一水平斜率，在控制了性别与初始退缩行为影响后，从时间<code>TIME</code>上依然有明显的下降趋势(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">\beta _{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为-0.116611，Pr(&gt;|t|)为9.85e-11)，男生的自我概念要比女生的自我概念下降的速度<code>TIME:GENDER</code>慢(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>11</mn></msub></mrow><annotation encoding="application/x-tex">\beta _{11}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为0.057760，Pr(&gt;|t|)为0.01283)，退缩行为严重的儿童自我概念下降也较为缓慢(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">\beta _{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为0.032042，Pr(&gt;|t|)为0.00553)</p>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance Std.Dev. Corr</span><br><span class="line"> ID       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">0.04247</span>  <span class="number">0.2061</span>       </span><br><span class="line">          TIME        <span class="number">0.01482</span>  <span class="number">0.1217</span>   <span class="number">0.35</span></span><br><span class="line"> Residual             <span class="number">0.09705</span>  <span class="number">0.3115</span>       </span><br><span class="line">Number of obs<span class="operator">:</span> <span class="number">1056</span><span class="punctuation">,</span> groups<span class="operator">:</span>  ID<span class="punctuation">,</span> <span class="number">264</span></span><br></pre></td></tr></table></figure>
<h4 id="非线性增长模型">非线性增长模型</h4>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 非线性增长模型</span></span><br><span class="line">model4 <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>SELF <span class="operator">~</span> TIME <span class="operator">+</span> TIME2 <span class="operator">+</span> <span class="punctuation">(</span>TIME <span class="operator">|</span> ID<span class="punctuation">)</span> <span class="operator">+</span> <span class="punctuation">(</span>TIME2 <span class="operator">|</span> ID<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model4<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">              Estimate Std. Error         df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   <span class="number">2.852225</span>   <span class="number">0.022981</span> <span class="number">359.215039</span> <span class="number">124.114</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">TIME         <span class="operator">-</span><span class="number">0.192433</span>   <span class="number">0.030473</span> <span class="number">642.042214</span>  <span class="operator">-</span><span class="number">6.315</span> <span class="number">5.05e-10</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">TIME2         <span class="number">0.036140</span>   <span class="number">0.009452</span> <span class="number">539.663802</span>   <span class="number">3.823</span> <span class="number">0.000147</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>从固定部分参数可以看出，从时间上自我概念有显著的二次型变化趋势<code>TIME2</code>(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>20</mn></msub></mrow><annotation encoding="application/x-tex">\beta _{20}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">20</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为0.036140，Pr(&gt;|t|)为0.000147)</p>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance  Std.Dev. Corr </span><br><span class="line"> ID       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">0.0099524</span> <span class="number">0.09976</span>       </span><br><span class="line">          TIME        <span class="number">0.0156733</span> <span class="number">0.12519</span>  <span class="number">1.00</span> </span><br><span class="line"> ID.1     <span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">0.0404869</span> <span class="number">0.20121</span>       </span><br><span class="line">          TIME2       <span class="number">0.0001715</span> <span class="number">0.01310</span>  <span class="operator">-</span><span class="number">1.00</span></span><br><span class="line"> Residual             <span class="number">0.0936648</span> <span class="number">0.30605</span>       </span><br></pre></td></tr></table></figure>
<h3 id="随时间变化的预测变量对发展趋势的影响">随时间变化的预测变量对发展趋势的影响</h3>
<p>导入包与数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入包</span></span><br><span class="line">library<span class="punctuation">(</span>haven<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>lme4<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;/Users/nanxu/研究生课程作业/心理统计/课件数据/14第十四章 多层线性模型在追踪研究中的应用/&quot;</span><span class="punctuation">)</span></span><br><span class="line">data1 <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./14-9.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line">data2 <span class="operator">&lt;-</span> read_sav<span class="punctuation">(</span><span class="string">&quot;./14-10.sav&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>数据介绍与数据合并</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 描述数据</span></span><br><span class="line">describe<span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line">describe<span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">table<span class="punctuation">(</span>unique<span class="punctuation">(</span>data1<span class="operator">$</span>id<span class="punctuation">)</span> <span class="operator">==</span> data2<span class="operator">$</span>id<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并数据</span></span><br><span class="line">merged_data <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>data1<span class="punctuation">,</span> data2<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;id&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>merged_data<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>merged_data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不考虑第二水平预测变量的解释作用，对于第一水平随时间变化的预测变量假设为固定参数</span></span><br><span class="line">model <span class="operator">&lt;-</span> lmer<span class="punctuation">(</span>marhap <span class="operator">~</span> marpro1 <span class="operator">+</span> ager_25 <span class="operator">+</span> <span class="punctuation">(</span>marpro1 <span class="operator">|</span> id<span class="punctuation">)</span> <span class="operator">+</span> <span class="punctuation">(</span>ager_25 <span class="operator">|</span> id<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> merged_data<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>model<span class="punctuation">,</span> standardized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>固定部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Fixed effects<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error        df t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">31.25034</span>    <span class="number">0.27993</span> <span class="number">170.73475</span> <span class="number">111.636</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">marpro1      <span class="operator">-</span><span class="number">2.26712</span>    <span class="number">0.28439</span> <span class="number">408.28264</span>  <span class="operator">-</span><span class="number">7.972</span> <span class="number">1.58e-14</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">ager_25      <span class="operator">-</span><span class="number">0.13618</span>    <span class="number">0.02197</span> <span class="number">225.26668</span>  <span class="operator">-</span><span class="number">6.199</span> <span class="number">2.69e-09</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br></pre></td></tr></table></figure>
<p>从固定部分参数可以看出，婚姻幸福感<code>marhap</code>随着年龄<code>ager_25</code>增加有显著的下降趋势(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>20</mn></msub></mrow><annotation encoding="application/x-tex">\beta _{20}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">20</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为-0.13618，Pr(&gt;|t|)为2.69e-09),近期家庭中是否存在问题<code>marpro1</code>对婚姻幸福感<code>marhap</code>有显著的影响，有问题的个体比没有问题的个体平均低2.26712</p>
<p>随机部分参数估计结果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Random effects<span class="operator">:</span></span><br><span class="line"> Groups   Name        Variance Std.Dev. Corr</span><br><span class="line"> id       <span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">0.00000</span>  <span class="number">0.0000</span>       </span><br><span class="line">          marpro1     <span class="number">3.77998</span>  <span class="number">1.9442</span>    <span class="literal">NaN</span></span><br><span class="line"> id.1     <span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">0.96071</span>  <span class="number">0.9802</span>       </span><br><span class="line">          ager_25     <span class="number">0.02832</span>  <span class="number">0.1683</span>   <span class="number">0.24</span></span><br><span class="line"> Residual             <span class="number">5.95213</span>  <span class="number">2.4397</span>       </span><br><span class="line">Number of obs<span class="operator">:</span> <span class="number">910</span><span class="punctuation">,</span> groups<span class="operator">:</span>  id<span class="punctuation">,</span> <span class="number">231</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">花瓶</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/">http://example.com/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">花瓶里的芝士不收费</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/R/">R</a><a class="post-meta__tags" href="/tags/%E5%BF%83%E7%90%86%E5%AD%A6/">心理学</a><a class="post-meta__tags" href="/tags/%E5%A4%9A%E5%85%83%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90/">多元统计分析</a></div><div class="post_share"><div class="social-share" data-image="/img/Starry_Night.jpg" data-sites="qq,wechat,weibo"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/03/07/%E5%9B%BE%E8%AE%BA/" title="图论"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/img/Figure_in_a_Room.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">图论</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/10/08/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/" title="R语言学习"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/img/Claude_Monet.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-08</div><div class="title">R语言学习</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/img/John_King.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">花瓶</div><div class="author-info__description">简简单单的小花瓶~</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/robust-vase"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/robust-vase" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:robustvase@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.zhihu.com/people/yu-xia-si-can-hong" target="_blank" title="zhihu"><i class="fab fa-zhihu"></i></a><a class="social-icon" href="https://space.bilibili.com/197525661" target="_blank" title="bilibili"><i class="fab fa-bilibili"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><center style="color: var(--theme-color)">
  <b><span style="font-size: 20px">花瓶简介</span><br>
  从<span style="font-size: 16px">计算数学</span>转到<span style="font-size: 16px">心理学</span>的花瓶～<br>
  时不时发布算法👨🏻‍💻相关笔记<br>
  或许是单细胞测序🧬内容<br>
  👋关注花瓶的都是现实中的朋友啦～<br>
  🚀<span style="font-size: 16px">花瓶持续更新～</span>🚀<br>
  </b>
</center>
</div><div id="welcome-info"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">多元回归分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%A4%9A%E5%85%83%E5%9B%9E%E5%BD%92"><span class="toc-number">2.1.</span> <span class="toc-text">标准多元回归</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E5%85%B1%E7%BA%BF%E6%80%A7"><span class="toc-number">2.1.1.</span> <span class="toc-text">多重共线性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AE%8B%E5%B7%AE%E5%88%86%E6%9E%90"><span class="toc-number">2.1.2.</span> <span class="toc-text">残差分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E5%8F%98%E9%87%8F%E5%AF%B9%E6%95%B0%E8%BD%AC%E6%8D%A2%E7%9A%84%E5%A4%9A%E5%85%83%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90"><span class="toc-number">2.2.</span> <span class="toc-text">因变量对数转换的多元回归分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0"><span class="toc-number">2.2.1.</span> <span class="toc-text">相关系数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%9B%9E%E5%BD%92"><span class="toc-number">2.3.</span> <span class="toc-text">序列回归</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">EFA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">3.1.</span> <span class="toc-text">数据预处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E5%9B%A0%E5%AD%90%E6%95%B0%E7%9B%AE"><span class="toc-number">3.2.</span> <span class="toc-text">确定因子数目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0%E6%95%B0%E5%9B%BA%E5%AE%9A%E4%B8%BA7%E7%9A%84%E6%8E%A2%E7%B4%A2%E6%80%A7%E5%9B%A0%E7%B4%A0%E5%88%86%E6%9E%90"><span class="toc-number">3.3.</span> <span class="toc-text">因素数固定为7的探索性因素分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0%E6%95%B0%E5%9B%BA%E5%AE%9A%E4%B8%BA5%E7%9A%84%E6%8E%A2%E7%B4%A2%E6%80%A7%E5%9B%A0%E7%B4%A0%E5%88%86%E6%9E%90"><span class="toc-number">3.4.</span> <span class="toc-text">因素数固定为5的探索性因素分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0%E6%95%B0%E5%9B%BA%E5%AE%9A%E4%B8%BA4%E7%9A%84%E6%8E%A2%E7%B4%A2%E6%80%A7%E5%9B%A0%E7%B4%A0%E5%88%86%E6%9E%90"><span class="toc-number">3.5.</span> <span class="toc-text">因素数固定为4的探索性因素分析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">CFA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.1.</span> <span class="toc-text">数据介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A2%E7%B4%A2%E6%80%A7%E5%9B%A0%E7%B4%A0%E5%88%86%E6%9E%90"><span class="toc-number">4.2.</span> <span class="toc-text">探索性因素分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1CFA"><span class="toc-number">4.2.1.</span> <span class="toc-text">第一次CFA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%AD%A3%E5%90%8E%E7%9A%84%E7%AC%AC%E4%BA%8C%E6%AC%A1CFA"><span class="toc-number">4.2.2.</span> <span class="toc-text">修正后的第二次CFA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%AD%A3%E5%90%8E%E7%9A%84%E7%AC%AC%E4%B8%89%E6%AC%A1CFA"><span class="toc-number">4.2.3.</span> <span class="toc-text">修正后的第三次CFA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%89%E4%BB%B7%E6%80%A7%E6%A3%80%E9%AA%8C"><span class="toc-number">4.3.</span> <span class="toc-text">等价性检验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E6%80%A7%E5%88%AB%E5%88%86%E5%88%AB%E6%8B%9F%E5%90%88%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.3.1.</span> <span class="toc-text">不同性别分别拟合模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0%E6%A8%A1%E5%BC%8F%E7%9B%B8%E5%90%8C%E6%A8%A1%E5%9E%8B-%E5%9F%BA%E7%BA%BF%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.3.2.</span> <span class="toc-text">因素模式相同模型(基线模型)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0%E8%BD%BD%E8%8D%B7%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B-%E5%BC%B1%E7%AD%89%E4%BB%B7%E6%80%A7"><span class="toc-number">4.3.3.</span> <span class="toc-text">因素载荷等价模型(弱等价性)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%AA%E8%B7%9D%E7%AD%89%E4%BB%B7%E6%80%A7%E6%A8%A1%E5%9E%8B-%E5%BC%BA%E7%AD%89%E4%BB%B7%E6%80%A7"><span class="toc-number">4.3.4.</span> <span class="toc-text">截距等价性模型(强等价性)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AF%E5%B7%AE%E6%96%B9%E5%B7%AE%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.3.5.</span> <span class="toc-text">误差方差等价模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BD%9C%E5%8F%98%E9%87%8F%E6%96%B9%E5%B7%AE%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.3.6.</span> <span class="toc-text">潜变量方差等价模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BD%9C%E5%8F%98%E9%87%8F%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.3.7.</span> <span class="toc-text">潜变量协方差矩阵等价模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BD%9C%E5%8F%98%E9%87%8F%E7%9A%84%E5%9D%87%E5%80%BC%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.3.8.</span> <span class="toc-text">潜变量的均值等价模型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">路径分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D-2"><span class="toc-number">5.1.</span> <span class="toc-text">数据介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A5%B1%E5%92%8C%E7%9A%84%E9%80%92%E5%BD%92%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.2.</span> <span class="toc-text">饱和的递归模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E9%A5%B1%E5%92%8C%E7%9A%84%E9%80%92%E5%BD%92%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.3.</span> <span class="toc-text">非饱和的递归模型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">结构方程模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D-3"><span class="toc-number">6.1.</span> <span class="toc-text">数据介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%96%B9%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.2.</span> <span class="toc-text">结构方程模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%96%B9%E7%A8%8B%E6%A8%A1%E5%9E%8B%E5%A4%9A%E7%BB%84%E6%AF%94%E8%BE%83"><span class="toc-number">6.3.</span> <span class="toc-text">结构方程模型多组比较</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E6%80%A7%E5%88%AB%E5%88%86%E5%88%AB%E6%8B%9F%E5%90%88%E6%A8%A1%E5%9E%8B-2"><span class="toc-number">6.3.1.</span> <span class="toc-text">不同性别分别拟合模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%A8%A1%E5%BC%8F%E7%9B%B8%E5%90%8C%E6%A8%A1%E5%9E%8B-%E5%9F%BA%E7%BA%BF%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.3.2.</span> <span class="toc-text">结构模式相同模型(基线模型)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E9%87%8F%E6%A8%A1%E5%9E%8B%EF%BC%9A%E5%9B%A0%E7%B4%A0%E8%BD%BD%E8%8D%B7%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B-%E5%BC%B1%E7%AD%89%E4%BB%B7%E6%80%A7"><span class="toc-number">6.3.3.</span> <span class="toc-text">测量模型：因素载荷等价模型(弱等价性)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E9%87%8F%E6%A8%A1%E5%9E%8B%EF%BC%9A%E8%AF%AF%E5%B7%AE%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.3.4.</span> <span class="toc-text">测量模型：误差协方差矩阵等价模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E9%87%8F%E6%A8%A1%E5%9E%8B%EF%BC%9A%E6%88%AA%E8%B7%9D%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.3.5.</span> <span class="toc-text">测量模型：截距等价模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%A8%A1%E5%9E%8B%EF%BC%9A%E6%BD%9C%E5%8F%98%E9%87%8F%E8%B7%AF%E5%BE%84%E7%B3%BB%E6%95%B0%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.3.6.</span> <span class="toc-text">结构模型：潜变量路径系数等价模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%A8%A1%E5%9E%8B%EF%BC%9A%E6%BD%9C%E5%8F%98%E9%87%8F%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.3.7.</span> <span class="toc-text">结构模型：潜变量协方差矩阵等价模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%A8%A1%E5%9E%8B%EF%BC%9A%E6%BD%9C%E5%8F%98%E9%87%8F%E6%96%B9%E5%B7%AE%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.3.8.</span> <span class="toc-text">结构模型：潜变量方差等价模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%A8%A1%E5%9E%8B%EF%BC%9A%E6%BD%9C%E5%9C%A8%E5%9B%A0%E7%B4%A0%E5%9D%87%E5%80%BC%E7%AD%89%E4%BB%B7%E6%A8%A1%E5%9E%8B"><span class="toc-number">6.3.9.</span> <span class="toc-text">结构模型：潜在因素均值等价模型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">中介分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D-4"><span class="toc-number">7.1.</span> <span class="toc-text">数据介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sobel%E6%A3%80%E9%AA%8C"><span class="toc-number">7.2.</span> <span class="toc-text">Sobel检验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bootstrap%E6%A3%80%E9%AA%8C"><span class="toc-number">7.3.</span> <span class="toc-text">Bootstrap检验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MCMC%E6%96%B9%E6%B3%95"><span class="toc-number">7.4.</span> <span class="toc-text">MCMC方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BD%9C%E5%8F%98%E9%87%8F%E4%B8%AD%E4%BB%8B%E5%88%86%E6%9E%90"><span class="toc-number">7.5.</span> <span class="toc-text">潜变量中介分析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">8.</span> <span class="toc-text">调节效应</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E8%BF%9E%E7%BB%AD%E5%8F%98%E9%87%8F%E7%9A%84%E8%B0%83%E8%8A%82%E4%BD%9C%E7%94%A8"><span class="toc-number">8.1.</span> <span class="toc-text">两个连续变量的调节作用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D%E4%B8%8E%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">8.1.1.</span> <span class="toc-text">数据介绍与预处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E6%A0%87%E5%87%86%E5%8C%96%E8%A7%A3"><span class="toc-number">8.1.2.</span> <span class="toc-text">非标准化解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E5%BA%94%E9%87%8F"><span class="toc-number">8.1.3.</span> <span class="toc-text">效应量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%8C%96%E8%A7%A3"><span class="toc-number">8.1.4.</span> <span class="toc-text">标准化解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%96%9C%E7%8E%87%E6%A3%80%E9%AA%8C"><span class="toc-number">8.1.5.</span> <span class="toc-text">简单斜率检验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E7%BB%AD%E5%8F%98%E9%87%8F%E4%B8%8E%E5%88%86%E7%B1%BB%E5%8F%98%E9%87%8F%E7%9A%84%E8%B0%83%E8%8A%82%E4%BD%9C%E7%94%A8"><span class="toc-number">8.2.</span> <span class="toc-text">连续变量与分类变量的调节作用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E7%BC%96%E7%A0%81%E5%90%8E%E7%9A%84%E8%B0%83%E6%95%99%E6%95%88%E5%BA%94%E6%A3%80%E9%AA%8C"><span class="toc-number">8.2.1.</span> <span class="toc-text">虚拟编码后的调教效应检验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E7%BC%96%E7%A0%81%E4%B8%8E%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">8.2.1.1.</span> <span class="toc-text">虚拟编码与数据预处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E6%A0%87%E5%87%86%E5%8C%96%E5%9B%9E%E5%BD%92%E7%B3%BB%E6%95%B0"><span class="toc-number">8.2.1.2.</span> <span class="toc-text">非标准化回归系数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%8C%96%E5%9B%9E%E5%BD%92%E7%B3%BB%E6%95%B0"><span class="toc-number">8.2.1.3.</span> <span class="toc-text">标准化回归系数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E5%8A%A0%E6%9D%83%E6%95%88%E5%BA%94%E7%BC%96%E7%A0%81%E5%90%8E%E7%9A%84%E8%B0%83%E8%8A%82%E6%95%88%E5%BA%94%E6%A3%80%E9%AA%8C"><span class="toc-number">8.2.2.</span> <span class="toc-text">非加权效应编码后的调节效应检验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E5%8A%A0%E6%9D%83%E6%95%88%E5%BA%94%E7%BC%96%E7%A0%81%E4%B8%8E%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">8.2.2.1.</span> <span class="toc-text">非加权效应编码与数据预处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E6%A0%87%E5%87%86%E5%8C%96%E5%9B%9E%E5%BD%92%E7%B3%BB%E6%95%B0-2"><span class="toc-number">8.2.2.2.</span> <span class="toc-text">非标准化回归系数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%8C%96%E5%9B%9E%E5%BD%92%E7%B3%BB%E6%95%B0-2"><span class="toc-number">8.2.2.3.</span> <span class="toc-text">标准化回归系数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BD%9C%E5%8F%98%E9%87%8F%E7%9A%84%E8%B0%83%E8%8A%82%E6%95%88%E5%BA%94"><span class="toc-number">8.3.</span> <span class="toc-text">潜变量的调节效应</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BD%9C%E5%8F%98%E9%87%8F%E4%B8%8E%E5%88%86%E7%B1%BB%E5%8F%98%E9%87%8F%E7%9A%84%E8%B0%83%E8%8A%82%E6%95%88%E5%BA%94%E5%88%86%E6%9E%90"><span class="toc-number">8.3.1.</span> <span class="toc-text">潜变量与分类变量的调节效应分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E7%AD%89%E4%BB%B7%E6%80%A7"><span class="toc-number">8.3.1.1.</span> <span class="toc-text">结构等价性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%B1%E7%AD%89%E4%BB%B7%E6%80%A7"><span class="toc-number">8.3.1.2.</span> <span class="toc-text">弱等价性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%96%B9%E7%A8%8B%E7%B3%BB%E6%95%B0%E7%AD%89%E4%BB%B7%E6%80%A7"><span class="toc-number">8.3.1.3.</span> <span class="toc-text">结构方程系数等价性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BD%9C%E5%8F%98%E9%87%8F%E4%B8%8E%E6%BD%9C%E5%8F%98%E9%87%8F%E7%9A%84%E8%B0%83%E8%8A%82%E6%95%88%E5%BA%94%E5%88%86%E6%9E%90"><span class="toc-number">8.3.2.</span> <span class="toc-text">潜变量与潜变量的调节效应分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%98%E7%A7%AF%E6%8C%87%E6%A0%87%E6%B3%95"><span class="toc-number">8.3.2.1.</span> <span class="toc-text">乘积指标法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BD%9C%E8%B0%83%E8%8A%82%E7%BB%93%E6%9E%84%E6%96%B9%E7%A8%8B"><span class="toc-number">8.3.2.2.</span> <span class="toc-text">潜调节结构方程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E8%B0%83%E8%8A%82%E7%9A%84%E4%B8%AD%E4%BB%8B"><span class="toc-number">8.4.</span> <span class="toc-text">有调节的中介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E8%B0%83%E8%8A%82%E6%A8%A1%E5%9E%8B"><span class="toc-number">8.4.1.</span> <span class="toc-text">简单调节模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E8%B0%83%E8%8A%82%E7%9A%84%E4%B8%AD%E4%BB%8B%E6%95%88%E5%BA%94%E6%A3%80%E9%AA%8C"><span class="toc-number">8.4.2.</span> <span class="toc-text">有调节的中介效应检验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E6%95%B0%E4%BE%9D%E6%AC%A1%E6%A3%80%E9%AA%8C"><span class="toc-number">8.4.2.1.</span> <span class="toc-text">系数依次检验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%98%E7%A7%AF%E7%B3%BB%E6%95%B0%E7%9A%84%E5%8C%BA%E9%97%B4%E6%A3%80%E9%AA%8C"><span class="toc-number">8.4.2.2.</span> <span class="toc-text">乘积系数的区间检验</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%81%8F%E5%B7%AE%E6%A0%A1%E6%AD%A3%E7%9A%84Bootstrap%E6%96%B9%E6%B3%95"><span class="toc-number">8.4.2.2.1.</span> <span class="toc-text">偏差校正的Bootstrap方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MCMC%E6%96%B9%E6%B3%95-2"><span class="toc-number">8.4.2.2.2.</span> <span class="toc-text">MCMC方法</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">9.</span> <span class="toc-text">多层线性模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E6%B0%B4%E5%B9%B3%E5%88%86%E6%9E%90%E7%AE%80%E5%8C%96%E6%A8%A1%E5%9E%8B%E7%B1%BB%E5%9E%8B"><span class="toc-number">9.1.</span> <span class="toc-text">多水平分析简化模型类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%95%B0%E6%8D%AE%E5%90%88%E5%B9%B6"><span class="toc-number">9.1.1.</span> <span class="toc-text">数据介绍及数据合并</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%B6%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.1.2.</span> <span class="toc-text">零模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%88%E5%BA%94%E5%8D%95%E5%9B%A0%E7%B4%A0%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.1.3.</span> <span class="toc-text">随机效应单因素协方差分析模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E7%B3%BB%E6%95%B0%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.1.4.</span> <span class="toc-text">随机系数回归模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%B0%B4%E5%B9%B3%E4%BB%85%E6%88%AA%E8%B7%9D%E9%A1%B9%E5%90%AB%E6%9C%89%E9%A2%84%E6%B5%8B%E5%8F%98%E9%87%8F%E7%9A%84%E9%9A%8F%E6%9C%BA%E7%B3%BB%E6%95%B0%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.1.5.</span> <span class="toc-text">第二水平仅截距项含有预测变量的随机系数回归模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%B0%B4%E5%B9%B3%E4%BB%85%E6%88%AA%E8%B7%9D%E9%A1%B9%E5%90%AB%E6%9C%89%E9%A2%84%E6%B5%8B%E5%8F%98%E9%87%8F%E7%9A%84%E9%9A%8F%E6%9C%BA%E7%B3%BB%E6%95%B0%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B-%E5%85%A8%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.1.6.</span> <span class="toc-text">第二水平仅截距项含有预测变量的随机系数回归模型(全模型)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%B1%82%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B%E5%88%86%E6%9E%90%E8%BF%BD%E8%B8%AA%E6%95%B0%E6%8D%AE"><span class="toc-number">9.2.</span> <span class="toc-text">多层线性模型分析追踪数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AA%E4%BD%93%E7%89%B9%E5%BE%81%E9%9A%8F%E6%97%B6%E9%97%B4%E5%8F%98%E5%8C%96%E7%9A%84%E8%B6%8B%E5%8A%BF"><span class="toc-number">9.2.1.</span> <span class="toc-text">个体特征随时间变化的趋势</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%90%88%E5%B9%B6"><span class="toc-number">9.2.1.1.</span> <span class="toc-text">数据介绍与数据合并</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%A2%9E%E9%95%BF%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.2.1.2.</span> <span class="toc-text">线性增长模型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%A0%E6%9D%A1%E4%BB%B6%E5%9D%87%E5%80%BC%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.2.1.2.1.</span> <span class="toc-text">无条件均值模型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%A0%E6%9D%A1%E4%BB%B6%E5%A2%9E%E9%95%BF%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.2.1.2.2.</span> <span class="toc-text">无条件增长模型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A8%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.2.1.2.3.</span> <span class="toc-text">全模型</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E5%A2%9E%E9%95%BF%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.2.1.3.</span> <span class="toc-text">非线性增长模型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%97%B6%E9%97%B4%E5%8F%98%E5%8C%96%E7%9A%84%E9%A2%84%E6%B5%8B%E5%8F%98%E9%87%8F%E5%AF%B9%E5%8F%91%E5%B1%95%E8%B6%8B%E5%8A%BF%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-number">9.2.2.</span> <span class="toc-text">随时间变化的预测变量对发展趋势的影响</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/" title="心理统计"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/img/Starry_Night.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="心理统计"/></a><div class="content"><a class="title" href="/2024/06/18/%E5%BF%83%E7%90%86%E7%BB%9F%E8%AE%A1/" title="心理统计">心理统计</a><time datetime="2024-06-18T01:05:58.000Z" title="发表于 2024-06-18 09:05:58">2024-06-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/07/%E5%9B%BE%E8%AE%BA/" title="图论"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/img/Figure_in_a_Room.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="图论"/></a><div class="content"><a class="title" href="/2024/03/07/%E5%9B%BE%E8%AE%BA/" title="图论">图论</a><time datetime="2024-03-07T10:12:27.000Z" title="发表于 2024-03-07 18:12:27">2024-03-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/31/%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/" title="高级数据结构"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/img/The_Nightwatch.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="高级数据结构"/></a><div class="content"><a class="title" href="/2023/07/31/%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/" title="高级数据结构">高级数据结构</a><time datetime="2023-07-31T02:53:35.000Z" title="发表于 2023-07-31 10:53:35">2023-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/29/%E6%8E%92%E5%BA%8F%E9%80%89%E6%8B%A9%E7%AE%97%E6%B3%95/" title="排序选择算法"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/img/Figure_in_a_Room.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="排序选择算法"/></a><div class="content"><a class="title" href="/2023/01/29/%E6%8E%92%E5%BA%8F%E9%80%89%E6%8B%A9%E7%AE%97%E6%B3%95/" title="排序选择算法">排序选择算法</a><time datetime="2023-01-29T09:59:49.000Z" title="发表于 2023-01-29 17:59:49">2023-01-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/10/19/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="数据结构"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/lazyload.gif" data-original="/img/Starry_Night.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构"/></a><div class="content"><a class="title" href="/2022/10/19/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="数据结构">数据结构</a><time datetime="2022-10-19T04:20:06.000Z" title="发表于 2022-10-19 12:20:06">2022-10-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By 花瓶</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'e19706903ff8a3f54196',
      clientSecret: '6854f9b2fb4f13d47055fbbf869e0e815516840f',
      repo: 'robust-vase.github.io',
      owner: 'robust-vase',
      admin: ['robust-vase'],
      id: 'd5af256711b6380f38e1ec3a4702aa18',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.textContent= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async src="/js/title.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,文明,平等,公正,法制,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/footer.js"></script><!-- hexo injector body_end end --><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>